if(!jive.Selection){jive.Selection=$Class.extend({init:function(b,a,c){this._selection=jive.Selection.getSelection();if(b!=null){if(!jQuery.browser.msie){if(this._selection.rangeCount==0){this._selection.addRange(jive.Selection.createRangeAtNode(b))}}this._range=this.getRangeAt(0);this.moveToNodeAndCollapse(b,a,c)}else{this._range=this.getRangeAt(0)}},getSelection:function(){return this._selection},getRangeAt:function(a){return jive.Selection.getRangeAt(this._selection,a)},makeRangeTheSelection:function(){if(jQuery.browser.msie){this._selection.empty();this._range.select()}else{if(this._selection.rangeCount>0){this._selection.removeAllRanges()}this._selection.addRange(this._range)}},rangeInsertNode:function(d){if(jQuery.browser.msie){var a=this.getRangeStartContainer();var c=this.getRangeStartOffset();var b=a.parentNode;if(a.nodeType==3){var g=new String(a.nodeValue);var f=document.createTextNode(g.substring(0,c));var e=document.createTextNode(g.substring(c));b.insertBefore(f,a);b.insertBefore(d,a.nextSibling);b.insertBefore(e,d.nextSibling);b.removeChild(a);this.moveToNodeAndCollapse(d,true)}else{b.insertBefore(d,a.nextSibling)}}else{this._range.insertNode(d)}},setRangeStart:function(b,a){if(jQuery.browser.msie){this._setRangeStartEndHelper(b,a,false)}else{this._range.setStart(b,a)}},setRangeEnd:function(a,b){if(jQuery.browser.msie){this._setRangeStartEndHelper(a,b,true)}else{this._range.setEnd(a,b)}},getRangeStartContainer:function(){if(jQuery.browser.msie){return this._getIERangeContainerHelper(true).container}else{return this._range.startContainer}},getRangeEndContainer:function(){if(jQuery.browser.msie){return this._getIERangeContainerHelper(false).container}else{return this._range.endContainer}},getRangeStartOffset:function(){if(jQuery.browser.msie){return this._getIERangeContainerHelper(true).offset}else{return this._range.startOffset}},getRangeEndOffset:function(){if(jQuery.browser.msie){return this._getIERangeContainerHelper(false).offset}else{return this._range.endOffset}},getWordAtRange:function(){return this._wordAtRangeCommon()},replaceWordAtRange:function(c,b,a){this._wordAtRangeCommon(c,b,a)},_wordAtRangeCommon:function(e,a,b){var q=this.getRangeStartContainer();var k=jive.Selection.replaceNbspWithWhitespace(q.nodeValue);if(this.alignRangeWithNearestTextNode(q)){q=this.getRangeStartContainer();k=q.nodeValue}if(e==null){if(this._normalizeTextNode(q,this.getRangeStartOffset())){k=q.nodeValue;this._range.collapse(true);this.makeRangeTheSelection()}}var i=this.getRangeStartOffset();var o=new String(k).substring(0,i);var g=new String(k).substring(i);var f=/\S+$/,p=/^\S+/;if(e!=null&&e.length>0){a=a||"";b=b||{tag:"txt"};var l=a+e;o=o.replace(f,"");g=g.replace(p,"");if((g==null||g.length==0)&&b.tag!="txt"){g=" "}var c;if(b.tag=="txt"){c=document.createTextNode(l)}else{c=document.createElement(b.tag);for(var n in b.attrs){c.setAttribute(n,b.attrs[n])}c.innerHTML=l}var h=q.parentNode;if(o!=null&&o.length>0){h.insertBefore(document.createTextNode(o),q)}h.insertBefore(c,q);var j=null;if(g!=null&&g.length>0){j=document.createTextNode(g);h.insertBefore(j,q)}h.removeChild(q);var d=j==null?c:j;this.moveToNodeAndCollapse(d)}else{o=o.match(f);g=g.match(p);var m=(o==null?"":o)+(g==null?"":g);return m}},_normalizeTextNode:function(d,h){h=h||0;if(d==null||!d.nodeValue||jive.Selection.replaceNbspWithWhitespace(d.nodeValue).search(/\S+/)==-1){return false}var c="";var a=d.parentNode;function g(k){var j=k?d.previousSibling:d.nextSibling;while(j!=null&&j.nodeType==3&&jive.Selection.replaceNbspWithWhitespace(j.nodeValue).search(/\S+/)>-1){if(k){c=j.nodeValue+c}else{c+=j.nodeValue}var i=k?j.previousSibling:j.nextSibling;a.removeChild(j);j=i}}g(true);var f=c.length+h;c+=d.nodeValue;g(false);if(c!=d.nodeValue){if(jQuery.browser.msie){var e=this._range.duplicate();var b=document.createTextNode(c);a.replaceChild(b,d);this._range=e.duplicate();this._range.moveStart("character",f)}else{d.nodeValue=c;this.setRangeStart(d,f)}this._range.collapse(true);this.makeRangeTheSelection();return true}return false},insertNodeAtRange:function(b,c){var a=typeof b=="string"?document.createTextNode(b):b;if(!$j.browser.msie){this._range.collapse(true)}this.rangeInsertNode(a);if(a.nodeType==3){if(!this._normalizeTextNode(a,c)){if(jQuery.browser.msie){this._range.moveStart("character",c);this._range.collapse(true)}else{this.setRangeStart(b,c)}this.makeRangeTheSelection()}}},selectNodeContents:function(a){if(jQuery.browser.msie){var d=this.getRangeStartOffset()*-1;var c=this._range.duplicate();c.moveToElementText(c.parentElement());c.setEndPoint("StartToEnd",this._range);var b=c.text.length;this._range.moveStart("character",d);this._range.moveEnd("character",b);this._range.select()}else{this.getSelection().selectAllChildren(a)}},moveToNodeAndCollapse:function(b,a,c){if(a){this.setRangeStart(b,c)}else{this.setRangeEnd(b,c)}this._range.collapse(a);this.makeRangeTheSelection()},alignRangeWithNearestTextNode:function(a){a=a||this.getRangeStartContainer();if(a.nodeType!=3){var f=$j(a).contents();if(f.length>0){var c=this.getRangeStartOffset();var e=f.get(c);if(e.nodeType==3){this.init(d,false);return true}else{return this.alignRangeWithNearestTextNode(e)}}else{f=$j(a).parent().contents();var g=f.index(a);var b=false;var d=f.filter(function(h){return h<g&&this.nodeType==3}).last();if(d.length==0){d=f.filter(function(h){return h>g&&this.nodeType==3}).first();b=true}if(d.length>0){this.init(d[0],b,b?0:d[0].length);return true}else{throw ("alignRangeWithNearestTextNode Failed to find a text node to align with.")}}}return false},_getIERangeContainerHelper:function(c){var g=c?this._getIERangeStartOffsetHelper():this._getIERangeEndOffsetHelper();var a=this._range.parentElement();var e=0;var f=a.childNodes;if(f.length==0){return a}for(var d=0;d<f.length;d++){var h=f[d];var b=$j(h).text().length;if(g<=e+b){return{container:h,offset:g-e}}else{e+=b}}throw ("Error jive.selection._getIERangeContainerHelper could not find range container")},_getIERangeStartOffsetHelper:function(){var a=this._range.duplicate();a.moveToElementText(a.parentElement());a.setEndPoint("EndToStart",this._range);return a.text.length},_getIERangeEndOffsetHelper:function(){return this._range.text.length+this._getIERangeStartOffsetHelper()},_setRangeStartEndHelper:function(h,k,g){var n=h.nodeType==3;var l=n?h.parentNode:h;var i=this._range.duplicate();i.moveToElementText(l);k=k||0;var c=$j(h).parent().contents();var p=c.index(h);var a;if(n){a=c.slice(0,p).text().length+k}else{a=c.slice(0,p+k).text().length}i.moveStart("character",a);var f;var e;if(n){f=p+1;e=jive.Selection.replaceNbspWithWhitespace($j(h).text()).substring(k)}else{f=p+k+1;e=jive.Selection.replaceNbspWithWhitespace(c.slice(p+k))}var o=new RegExp("(.*)"+e);function j(){return new String(i.text).replace(new RegExp(c.slice(f).text()+"$"),"")}var b=j();var d=0;while(b!=e){b=j();var m=b.match(o);if(m!=null&&m.length==2){i.moveStart("character",m[1].length)}else{throw ("jive.Selection _setRangeStartEndHelper failed to setRange Start or End")}d++;if(d==10){throw ("jive.Selection _setRangeStartEndHelper failed to setRange Start or End")}}if(g){this._range.setEndPoint("EndToStart",i)}else{this._range.setEndPoint("StartToStart",i)}}});jive.Selection.getSelection=function(){if(window.getSelection){return window.getSelection()}else{if(document.all){return document.selection}else{if(document.getSelection){return document.getSelection()}}}throw ("jive.Selection.getSelector Error: unable to obtain seleciton object")};jive.Selection.getRangeAt=function(b,a){if(b.getRangeAt){return b.getRangeAt(a)}else{if(document.selection){return b.createRange()}}throw ("jive.Selection.getRangeAt Error: unable to obtain seleciton object")};jive.Selection.moveCursorAfter=function(b){var c=document.createElement("span");c.setAttribute("data-jive-statusinputadd","true");c.innerHTML="&nbsp;";b.parentNode.insertBefore(c,b);b.parentNode.insertBefore(b,c);var a=new jive.Selection(c,true);b.parentNode.removeChild(c)};jive.Selection.createRangeAtNode=function(b){if(document.createRange){var a=document.createRange();a.selectNodeContents(b);return a}else{if(b.createRange){return b.createRange()}}throw ("jive.Selection.createRange Error: unable to obtain range object")};jive.Selection.replaceNbspWithWhitespace=function(a){return String(a).replace(/\xA0/g," ")}};
;
jive.ext.y._sliders_on=true;jive.ext.y._sliders=new jive.ext.y.HashTable();jive.ext.y.ySlider=function(b,f,a){var d=new Array();var c=this;this.hash=0;this.name=a;this.moving=false;if(!$obj(f)||f==null){f=new Object()}if(!$def(f.timeout)||f.timeout==null){f.timeout=false}this.go=function(){try{while(c.hash==0||$obj(jive.ext.y._sliders.get(c.hash))){c.hash=Math.round(Math.random()*10000)+1}jive.ext.y._sliders.put(c.hash,this);if(!f.timeout){f.timeout=40}for(var g=0;g<d.length;g++){d[g].init()}f.slideTime=b;f.stop=false;f.B=Math.PI/(2*f.slideTime);var h=new Date();f.C=h.getTime();if(!jive.ext.y._sliders_on){f.slideTime=0}if(!c.moving){this._slide()}}catch(e){alert("error initializing slider:"+f.message)}};this._slide=function(){try{var e,k,j,l;e=new Date();j=e.getTime()-f.C;if(f.stop){c.moving=false}else{if(j<f.slideTime){setTimeout("jive.ext.y._sliders.get('"+c.hash+"')._slide();",f.timeout);var k=Math.sin(f.B*j);for(var h=0;h<d.length;h++){d[h].tick(k)}c.moving=true}else{for(var h=0;h<d.length;h++){d[h].stop()}c.moving=false}}}catch(g){alert("error sliding slider:"+f)}};this.addTicker=function(e){d.push(e)}};jive.ext.y.EndOfSlideTicker=function(a){this.init=function(){};this.tick=function(b){};this.stop=function(){a()}};jive.ext.y.SlideToTicker=function(b,a,c){this.init=function(){if(!(b=jive.ext.x.xGetElementById(b))){return}b.xTarget=a;b.yTarget=c;b.yA=b.yTarget-jive.ext.x.xTop(b);b.xA=b.xTarget-jive.ext.x.xLeft(b);b.yD=jive.ext.x.xTop(b);b.xD=jive.ext.x.xLeft(b)};this.tick=function(d){if(!(b=jive.ext.x.xGetElementById(b))){return}var f=Math.round(b.xA*d+b.xD);var e=Math.round(b.yA*d+b.yD);jive.ext.x.xMoveTo(b,f,e)};this.stop=function(){if(!(b=jive.ext.x.xGetElementById(b))){return}jive.ext.x.xMoveTo(b,b.xTarget,b.yTarget)}};jive.ext.y.SlideHeightToTicker=function(b,a){this.init=function(){if(!(b=jive.ext.x.xGetElementById(b))){return}b.xTargetH=a;b.xAH=b.xTargetH-jive.ext.x.xHeight(b);b.xDH=jive.ext.x.xHeight(b)};this.tick=function(d){if(!(b=jive.ext.x.xGetElementById(b))){return}var c=Math.round(b.xAH*d+b.xDH);jive.ext.x.xHeight(b,c)};this.stop=function(){if(!(b=jive.ext.x.xGetElementById(b))){return}jive.ext.x.xHeight(b,b.xTargetH)}};jive.ext.y.SlideWidthToTicker=function(b,a){this.init=function(){if(!(b=jive.ext.x.xGetElementById(b))){return}b.xTargetW=a;b.xAW=b.xTargetW-jive.ext.x.xWidth(b);b.xDW=jive.ext.x.xWidth(b)};this.tick=function(c){if(!(b=jive.ext.x.xGetElementById(b))){return}var d=Math.round(b.xAW*c+b.xDW);jive.ext.x.xWidth(b,d)};this.stop=function(){if(!(b=jive.ext.x.xGetElementById(b))){return}jive.ext.x.xWidth(b,b.xTargetW)}};jive.ext.y.SlideTopToTicker=function(b,a){this.init=function(){if(!(b=jive.ext.x.xGetElementById(b))){return}b.xTargetT=a;b.xAT=b.xTargetT-jive.ext.x.xTop(b);b.xDT=jive.ext.x.xTop(b)};this.tick=function(d){if(!(b=jive.ext.x.xGetElementById(b))){return}var c=Math.round(b.xAT*d+b.xDT);jive.ext.x.xTop(b,c)};this.stop=function(){if(!(b=jive.ext.x.xGetElementById(b))){return}jive.ext.x.xTop(b,b.xTargetT)}};jive.ext.y.SlideBottomToTicker=function(b,a){this.init=function(){if(!(b=jive.ext.x.xGetElementById(b))){return}b.xTargetT=a;b.xAT=b.xTargetT-jive.ext.y.yBottom(b);b.xDT=jive.ext.y.yBottom(b)};this.tick=function(d){if(!(b=jive.ext.x.xGetElementById(b))){return}var c=Math.round(b.xAT*d+b.xDT);jive.ext.y.yBottom(b,c)};this.stop=function(){if(!(b=jive.ext.x.xGetElementById(b))){return}jive.ext.y.yBottom(b,b.xTargetT)}};jive.ext.y.SlideOpacityToTicker=function(a,b){this.init=function(){if(!(a=jive.ext.x.xGetElementById(a))){return}a.xTargetO=b;a.xAO=a.xTargetO-jive.ext.y.yOpacity(a);a.xDO=jive.ext.y.yOpacity(a)};this.tick=function(c){if(!(a=jive.ext.x.xGetElementById(a))){return}var d=Math.round(a.xAO*c+a.xDO);jive.ext.y.yOpacity(a,d)};this.stop=function(){if(!(a=jive.ext.x.xGetElementById(a))){return}jive.ext.y.yOpacity(a,a.xTargetO)}};
;
(function(e){var b=/^\s+|\s+$/g,c=String.prototype.trim,f;var d={majorVersion:"3",minorVersion:"3.8",releaseDate:"2010-06-30",_init:function(){var u=this,r=document,q=navigator,h=q.userAgent,o,g,m,l,k,s;u.isOpera=e.opera&&opera.buildNumber;u.isWebKit=/WebKit/.test(h);u.isIE=!u.isWebKit&&!u.isOpera&&(/MSIE/gi).test(h)&&(/Explorer/gi).test(q.appName);u.isIE6=u.isIE&&/MSIE [56]/.test(h);u.isGecko=!u.isWebKit&&/Gecko/.test(h);u.isMac=h.indexOf("Mac")!=-1;u.isAir=/adobeair/i.test(h);u.isIDevice=/(iPad|iPhone)/.test(h);if(e.tinyMCEPreInit){u.suffix=tinyMCEPreInit.suffix;u.baseURL=tinyMCEPreInit.base;u.query=tinyMCEPreInit.query;return}u.suffix="";g=r.getElementsByTagName("base");for(o=0;o<g.length;o++){if(s=g[o].href){if(/^https?:\/\/[^\/]+$/.test(s)){s+="/"}l=s?s.match(/.*\//)[0]:""}}function j(i){if(i.src&&/tiny_mce(|_gzip|_jquery|_prototype)(_dev|_src)?.js/.test(i.src)){if(/_(src|dev)\.js/g.test(i.src)){u.suffix="_src"}if((k=i.src.indexOf("?"))!=-1){u.query=i.src.substring(k+1)}u.baseURL=i.src.substring(0,i.src.lastIndexOf("/"));if(l&&u.baseURL.indexOf("://")==-1&&u.baseURL.indexOf("/")!==0){u.baseURL=l+u.baseURL}return u.baseURL}return null}g=r.getElementsByTagName("script");for(o=0;o<g.length;o++){if(j(g[o])){return}}m=r.getElementsByTagName("head")[0];if(m){g=m.getElementsByTagName("script");for(o=0;o<g.length;o++){if(j(g[o])){return}}}return},is:function(h,g){if(!g){return h!==f}if(g=="array"&&(h.hasOwnProperty&&h instanceof Array)){return true}return typeof(h)==g},each:function(j,g,i){var k,h;if(!j){return 0}i=i||j;if(j.length!==f){for(k=0,h=j.length;k<h;k++){if(g.call(i,j[k],k,j)===false){return 0}}}else{for(k in j){if(Object.prototype.hasOwnProperty.call(j,k)){if(g.call(i,j[k],k,j)===false){return 0}}}}return 1},map:function(g,h){var i=[];d.each(g,function(j){i.push(h(j))});return i},grep:function(g,h){var i=[];d.each(g,function(j){if(!h||h(j)){i.push(j)}});return i},inArray:function(h,j){var k,g;if(h){for(k=0,g=h.length;k<g;k++){if(h[k]===j){return k}}}return -1},extend:function(m,k){var j,h,g=arguments;for(j=1,h=g.length;j<h;j++){k=g[j];d.each(k,function(i,l){if(i!==f){m[l]=i}})}return m},trim:c?function a(g){return g?c.call(g+""):""}:function a(g){return(g?""+g:"").replace(b,"")},create:function(o,g){var n=this,h,j,k,l,i,m=0;o=/^((static) )?([\w.]+)(:([\w.]+))?/.exec(o);k=o[3].match(/(^|\.)(\w+)$/i)[2];j=n.createNS(o[3].replace(/\.\w+$/,""));if(j[k]){return}if(o[2]=="static"){j[k]=g;if(this.onCreate){this.onCreate(o[2],o[3],j[k])}return}if(!g[k]){g[k]=function(){};m=1}j[k]=g[k];n.extend(j[k].prototype,g);if(o[5]){h=n.resolve(o[5]).prototype;l=o[5].match(/\.(\w+)$/i)[1];i=j[k];if(m){j[k]=function(){return h[l].apply(this,arguments)}}else{j[k]=function(){this.parent=h[l];return i.apply(this,arguments)}}j[k].prototype[k]=j[k];n.each(h,function(p,q){j[k].prototype[q]=h[q]});n.each(g,function(p,q){if(h[q]){j[k].prototype[q]=function(){this.parent=h[q];return p.apply(this,arguments)}}else{if(q!=k){j[k].prototype[q]=p}}})}n.each(g["static"],function(p,q){j[k][q]=p});if(this.onCreate){this.onCreate(o[2],o[3],j[k].prototype)}},walk:function(i,h,j,g){g=g||this;if(i){if(j){i=i[j]}d.each(i,function(l,k){if(h.call(g,l,k,j)===false){return false}d.walk(l,h,j,g)})}},createNS:function(k,j){var h,g;j=j||e;k=k.split(".");for(h=0;h<k.length;h++){g=k[h];if(!j[g]){j[g]={}}j=j[g]}return j},resolve:function(k,j){var h,g;j=j||e;k=k.split(".");for(h=0,g=k.length;h<g;h++){j=j[k[h]];if(!j){break}}return j},addUnload:function(j,i){var h=this;j={func:j,scope:i||this};if(!h.unloads){function g(){var l=h.unloads,m,p;if(l){for(p in l){m=l[p];if(m&&m.func){m.func.call(m.scope,1)}}if(e.detachEvent){e.detachEvent("onbeforeunload",k);e.detachEvent("onunload",g)}else{if(e.removeEventListener){e.removeEventListener("unload",g,false)}}h.unloads=m=l=w=g=0;if(e.CollectGarbage){CollectGarbage()}}}function k(){var m=document;if(m.readyState=="interactive"){function l(){m.detachEvent("onstop",l);if(g){g()}m=0}if(m){m.attachEvent("onstop",l)}e.setTimeout(function(){if(m){m.detachEvent("onstop",l)}},0)}}if(e.attachEvent){e.attachEvent("onunload",g);e.attachEvent("onbeforeunload",k)}else{if(e.addEventListener){e.addEventListener("unload",g,false)}}h.unloads=[j]}else{h.unloads.push(j)}return j},removeUnload:function(i){var g=this.unloads,h=null;d.each(g,function(k,j){if(k&&k.func==i){g.splice(j,1);h=i;return false}});return h},explode:function(g,h){return g?d.map(g.split(h||","),d.trim):g},_addVer:function(h){var g;if(!this.query){return h}g=(h.indexOf("?")==-1?"?":"&")+this.query;if(h.indexOf("#")==-1){return h+g}return h.replace("#",g+"#")}};d._init();e.tinymce=e.tinyMCE=d})(window);tinymce.create("tinymce.util.Dispatcher",{scope:null,listeners:null,Dispatcher:function(a){this.scope=a||this;this.listeners=[]},add:function(a,b){this.listeners.push({cb:a,scope:b||this.scope});return a},addToTop:function(a,b){this.listeners.unshift({cb:a,scope:b||this.scope});return a},remove:function(a){var b=this.listeners,c=null;tinymce.each(b,function(e,d){if(a==e.cb){c=a;b.splice(d,1);return false}});return c},dispatch:function(){var g,d=arguments,f,b=this.listeners,j;for(f=0;f<b.length;f++){try{j=b[f];g=j.cb.apply(j.scope,d)}catch(h){if(console.log){console.log(h)}}if(g===false){break}}return g}});(function(){var a=tinymce.each;tinymce.create("tinymce.util.URI",{URI:function(e,g){var f=this,h,d,c;e=tinymce.trim(e);g=f.settings=g||{};if(/^(mailto|tel|news|javascript|about|data):/i.test(e)||/^\s*#/.test(e)){f.source=e;return}if(e.indexOf("/")===0&&e.indexOf("//")!==0){e=(g.base_uri?g.base_uri.protocol||"http":"http")+"://mce_host"+e}if(!/^\w*:?\/\//.test(e)){e=(g.base_uri.protocol||"http")+"://mce_host"+f.toAbsPath(g.base_uri.path,e)}e=e.replace(/@@/g,"(mce_at)");e=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(e);a(["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],function(b,j){var k=e[j];if(k){k=k.replace(/\(mce_at\)/g,"@@")}f[b]=k});if(c=g.base_uri){if(!f.protocol){f.protocol=c.protocol}if(!f.userInfo){f.userInfo=c.userInfo}if(!f.port&&f.host=="mce_host"){f.port=c.port}if(!f.host||f.host=="mce_host"){f.host=c.host}f.source=""}},setPath:function(c){var b=this;c=/^(.*?)\/?(\w+)?$/.exec(c);b.path=c[0];b.directory=c[1];b.file=c[2];b.source="";b.getURI()},toRelative:function(b){var c=this,d;if(b==="./"){return b}b=new tinymce.util.URI(b,{base_uri:c});if((b.host!="mce_host"&&c.host!=b.host&&b.host)||c.port!=b.port||c.protocol!=b.protocol){return b.getURI()}d=c.toRelPath(c.path,b.path);if(b.query){d+="?"+b.query}if(b.anchor){d+="#"+b.anchor}return d},toAbsolute:function(b,c){var b=new tinymce.util.URI(b,{base_uri:this});return b.getURI(this.host==b.host&&this.protocol==b.protocol?c:0)},toRelPath:function(g,h){var c,f=0,d="",e,b;g=g.substring(0,g.lastIndexOf("/"));g=g.split("/");c=h.split("/");if(g.length>=c.length){for(e=0,b=g.length;e<b;e++){if(e>=c.length||g[e]!=c[e]){f=e+1;break}}}if(g.length<c.length){for(e=0,b=c.length;e<b;e++){if(e>=g.length||g[e]!=c[e]){f=e+1;break}}}if(f==1){return h}for(e=0,b=g.length-(f-1);e<b;e++){d+="../"}for(e=f-1,b=c.length;e<b;e++){if(e!=f-1){d+="/"+c[e]}else{d+=c[e]}}return d},toAbsPath:function(e,f){var c,b=0,h=[],d,g;d=/\/$/.test(f)?"/":"";e=e.split("/");f=f.split("/");a(e,function(i){if(i){h.push(i)}});e=h;for(c=f.length-1,h=[];c>=0;c--){if(f[c].length==0||f[c]=="."){continue}if(f[c]==".."){b++;continue}if(b>0){b--;continue}h.push(f[c])}c=e.length-b;if(c<=0){g=h.reverse().join("/")}else{g=e.slice(0,c).join("/")+"/"+h.reverse().join("/")}if(g.indexOf("/")!==0){g="/"+g}if(d&&g.lastIndexOf("/")!==g.length-1){g+=d}return g},getURI:function(d){var c,b=this;if(!b.source||d){c="";if(!d){if(b.protocol){c+=b.protocol+"://"}if(b.userInfo){c+=b.userInfo+"@"}if(b.host){c+=b.host}if(b.port){c+=":"+b.port}}if(b.path){c+=b.path}if(b.query){c+="?"+b.query}if(b.anchor){c+="#"+b.anchor}b.source=c}return b.source}})})();(function(){var a=tinymce.each;tinymce.create("static tinymce.util.Cookie",{getHash:function(d){var b=this.get(d),c;if(b){a(b.split("&"),function(e){e=e.split("=");c=c||{};c[unescape(e[0])]=unescape(e[1])})}return c},setHash:function(j,b,g,f,i,c){var h="";a(b,function(e,d){h+=(!h?"":"&")+escape(d)+"="+escape(e)});this.set(j,h,g,f,i,c)},get:function(i){var h=document.cookie,g,f=i+"=",d;if(!h){return}d=h.indexOf("; "+f);if(d==-1){d=h.indexOf(f);if(d!=0){return null}}else{d+=2}g=h.indexOf(";",d);if(g==-1){g=h.length}return unescape(h.substring(d+f.length,g))},set:function(i,b,g,f,h,c){document.cookie=i+"="+escape(b)+((g)?"; expires="+g.toGMTString():"")+((f)?"; path="+escape(f):"")+((h)?"; domain="+h:"")+((c)?"; secure":"")},remove:function(e,b){var c=new Date();c.setTime(c.getTime()-1000);this.set(e,"",c,b,c)}})})();tinymce.create("static tinymce.util.JSON",{serialize:function(e){var c,a,d=tinymce.util.JSON.serialize,b;if(e==null){return"null"}b=typeof e;if(b=="string"){a="\bb\tt\nn\ff\rr\"\"''\\\\";return'"'+e.replace(/([\u0080-\uFFFF\x00-\x1f\"])/g,function(g,f){c=a.indexOf(f);if(c+1){return"\\"+a.charAt(c+1)}g=f.charCodeAt().toString(16);return"\\u"+"0000".substring(g.length)+g})+'"'}if(b=="object"){if(e.hasOwnProperty&&e instanceof Array){for(c=0,a="[";c<e.length;c++){a+=(c>0?",":"")+d(e[c])}return a+"]"}a="{";for(c in e){a+=typeof e[c]!="function"?(a.length>1?',"':'"')+c+'":'+d(e[c]):""}return a+"}"}return""+e},parse:function(s){try{return eval("("+s+")")}catch(ex){}}});tinymce.create("static tinymce.util.XHR",{send:function(g){var a,e,b=window,h=0;g.scope=g.scope||this;g.success_scope=g.success_scope||g.scope;g.error_scope=g.error_scope||g.scope;g.async=g.async===false?false:true;g.data=g.data||"";function d(i){a=0;try{a=new ActiveXObject(i)}catch(c){}return a}a=b.XMLHttpRequest?new XMLHttpRequest():d("Microsoft.XMLHTTP")||d("Msxml2.XMLHTTP");if(a){if(a.overrideMimeType){a.overrideMimeType(g.content_type)}a.open(g.type||(g.data?"POST":"GET"),g.url,g.async);if(g.content_type){a.setRequestHeader("Content-Type",g.content_type)}a.setRequestHeader("X-Requested-With","XMLHttpRequest");a.send(g.data);function f(){if(!g.async||a.readyState==4||h++>10000){if(g.success&&h<10000&&a.status==200){g.success.call(g.success_scope,""+a.responseText,a,g)}else{if(g.error){g.error.call(g.error_scope,h>10000?"TIMED_OUT":"GENERAL",a,g)}}a=null}else{b.setTimeout(f,10)}}if(!g.async){return f()}e=b.setTimeout(f,10)}}});(function(){var c=tinymce.extend,b=tinymce.util.JSON,a=tinymce.util.XHR;tinymce.create("tinymce.util.JSONRequest",{JSONRequest:function(d){this.settings=c({},d);this.count=0},send:function(f){var e=f.error,d=f.success;f=c(this.settings,f);f.success=function(h,g){h=b.parse(h);if(typeof(h)=="undefined"){h={error:"JSON Parse error."}}if(h.error){e.call(f.error_scope||f.scope,h.error,g)}else{d.call(f.success_scope||f.scope,h.result)}};f.error=function(h,g){e.call(f.error_scope||f.scope,h,g)};f.data=b.serialize({id:f.id||"c"+(this.count++),method:f.method,params:f.params});f.content_type="application/json";a.send(f)},"static":{sendRPC:function(d){return new tinymce.util.JSONRequest().send(d)}}})}());(function(o){var m=o.each,k=o.is,j=o.isWebKit,d=o.isIE,a=/^(H[1-6R]|P|DIV|ADDRESS|PRE|FORM|T(ABLE|BODY|HEAD|FOOT|H|R|D)|LI|OL|UL|CAPTION|BLOCKQUOTE|CENTER|DL|DT|DD|DIR|FIELDSET|NOSCRIPT|MENU|ISINDEX|SAMP)$/,e=g("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"),f=g("src,href,style,coords,shape"),c={"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;"},p=/[<>&\"]/g,b=/^([a-z0-9],?)+$/i,i=/<(\w+)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)(\s*\/?)>/g,n=/(\w+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g;var h=/base|basefont|frame|link|meta|area|br|col|hr|img|input|param/i;function g(s){var r={},q;s=s.split(",");for(q=s.length;q>=0;q--){r[s[q]]=1}return r}var l=null;o.create("tinymce.dom.DOMUtils",{doc:null,root:null,files:null,pixelStyles:/^(top|left|bottom|right|width|height|borderWidth)$/,props:{"for":"htmlFor","class":"className",className:"className",checked:"checked",disabled:"disabled",maxlength:"maxLength",readonly:"readOnly",selected:"selected",value:"value",id:"id",name:"name",type:"type"},DOMUtils:function(x,u){var r=this,q;r.doc=x;r.win=window;r.files={};r.cssFlicker=false;r.counter=0;r.boxModel=!o.isIE||x.compatMode=="CSS1Compat";r.stdMode=x.documentMode===8;r.settings=u=o.extend({keep_values:false,hex_colors:1,process_html:1},u);if(o.isIE6){try{x.execCommand("BackgroundImageCache",false,true)}catch(v){r.cssFlicker=true}}if(u.valid_styles){r._styles={};m(u.valid_styles,function(t,s){r._styles[s]=o.explode(t)})}o.addUnload(r.destroy,r)},getRoot:function(){var q=this,r=q.settings;return(r&&q.get(r.root_element))||q.doc.body},getViewPort:function(r){var s,q;r=!r?this.win:r;s=r.document;if(s==null){return{x:0,y:0,w:1,h:1}}q=this.boxModel?s.documentElement:s.body;return{x:r.pageXOffset||q.scrollLeft,y:r.pageYOffset||q.scrollTop,w:r.innerWidth||q.clientWidth,h:r.innerHeight||q.clientHeight}},getRect:function(u){var s,q=this,r;u=q.get(u);s=q.getPos(u);r=q.getSize(u);return{x:s.x,y:s.y,w:r.w,h:r.h}},getSize:function(u){var r=this,q,s;u=r.get(u);q=r.getStyle(u,"width");s=r.getStyle(u,"height");if(q.indexOf("px")===-1){q=0}if(s.indexOf("px")===-1){s=0}return{w:parseInt(q)||u.offsetWidth||u.clientWidth,h:parseInt(s)||u.offsetHeight||u.clientHeight}},getParent:function(t,s,q){return this.getParents(t,s,q,false)},getParents:function(A,x,u,z){var s=this,q,v=s.settings,y=[];A=s.get(A);z=z===undefined;if(v.strict_root){u=u||s.getRoot()}if(k(x,"string")){q=x;if(x==="*"){x=function(r){return r.nodeType==1}}else{x=function(r){return s.is(r,q)}}}while(A){if(A==u||!A.nodeType||A.nodeType===9){break}if(!x||x(A)){if(z){y.push(A)}else{return A}}A=A.parentNode}return z?y:null},get:function(q){var r;if(q&&this.doc&&typeof(q)=="string"){r=q;q=this.doc.getElementById(q);if(q&&q.id!==r){return this.doc.getElementsByName(r)[1]}}return q},getNext:function(r,q){return this._findSib(r,q,"nextSibling")},getPrev:function(r,q){return this._findSib(r,q,"previousSibling")},select:function(u,r){var q=this;return o.dom.Sizzle(u,q.get(r)||q.get(q.settings.root_element)||q.doc,[])},is:function(s,q){var r;if(s.length===undefined){if(q==="*"){return s.nodeType==1}if(b.test(q)){q=q.toLowerCase().split(/,/);s=s.nodeName.toLowerCase();for(r=q.length-1;r>=0;r--){if(q[r]==s){return true}}return false}}return o.dom.Sizzle.matches(q,s.nodeType?[s]:s).length>0},add:function(u,x,q,s,v){var r=this;return this.run(u,function(z){var y,t;y=k(x,"string")?r.doc.createElement(x):x;r.setAttribs(y,q);if(s){if(s.nodeType){y.appendChild(s)}else{r.setHTML(y,s)}}return !v?z.appendChild(y):y})},create:function(s,q,r){return this.add(this.doc.createElement(s),s,q,r,1)},createHTML:function(x,q,u){var v="",s=this,r;v+="<"+x;for(r in q){if(q.hasOwnProperty(r)){v+=" "+r+'="'+s.encode(q[r])+'"'}}if(o.is(u)){return v+">"+u+"</"+x+">"}if(x.match(h)){return v+" />"}else{return v+"></"+x+">"}},remove:function(q,r){return this.run(q,function(t){var s,u;s=t.parentNode;if(!s){return null}if(r){while(u=t.firstChild){if(!o.isIE||u.nodeType!==3||u.nodeValue){s.insertBefore(u,t)}else{t.removeChild(u)}}}return s.removeChild(t)})},setStyle:function(u,q,r){var s=this;return s.run(u,function(x){var v,t;v=x.style;q=q.replace(/-(\D)/g,function(z,y){return y.toUpperCase()});if(s.pixelStyles.test(q)&&(o.is(r,"number")||/^[\-0-9\.]+$/.test(r))){r+="px"}switch(q){case"opacity":if(d){v.filter=r===""?"":"alpha(opacity="+(r*100)+")";if(!u.currentStyle||!u.currentStyle.hasLayout){v.display="inline-block"}}v[q]=v["-moz-opacity"]=v["-khtml-opacity"]=r||"";break;case"float":d?v.styleFloat=r:v.cssFloat=r;break;default:v[q]=r||""}if(s.settings.update_styles){s.setAttrib(x,"_mce_style")}})},getStyle:function(t,q,s){t=this.get(t);if(!t){return false}if(this.doc.defaultView&&s){q=q.replace(/[A-Z]/g,function(u){return"-"+u});try{return this.doc.defaultView.getComputedStyle(t,null).getPropertyValue(q)}catch(r){return null}}if(typeof(q)=="undefined"){return false}q=q.replace(/-(\D)/g,function(v,u){return u.toUpperCase()});if(q=="float"){q=d?"styleFloat":"cssFloat"}if(t.currentStyle&&s){return t.currentStyle[q]}return t.style[q]},setStyles:function(v,x){var r=this,u=r.settings,q;q=u.update_styles;u.update_styles=0;m(x,function(s,t){r.setStyle(v,t,s)});u.update_styles=q;if(u.update_styles){r.setAttrib(v,u.cssText)}},setAttrib:function(s,u,q){var r=this;if(!s||!u){return}if(r.settings.strict){u=u.toLowerCase()}return this.run(s,function(v){var t=r.settings;switch(u){case"style":if(!k(q,"string")){m(q,function(x,y){r.setStyle(v,y,x)});return}if(t.keep_values){if(q&&!r._isRes(q)){v.setAttribute("_mce_style",q,2)}else{v.removeAttribute("_mce_style",2)}}v.style.cssText=q;break;case"class":v.className=q||"";break;case"src":case"href":if(t.keep_values){if(t.url_converter){q=t.url_converter.call(t.url_converter_scope||r,q,u,v)}r.setAttrib(v,"_mce_"+u,q,2)}break;case"shape":v.setAttribute("_mce_style",q);break}if(k(q)&&q!==null&&q.length!==0){v.setAttribute(u,""+q,2)}else{v.removeAttribute(u,2)}})},setAttribs:function(r,s){var q=this;return this.run(r,function(t){m(s,function(u,x){q.setAttrib(t,x,u)})})},getAttrib:function(u,y,s){var q,r=this;u=r.get(u);if(!u||u.nodeType!==1){return false}if(!k(s)){s=""}if(/^(?:src|href|style|coords|shape)$/.test(y)){q=u.getAttribute("_mce_"+y);if(q){if(typeof(q)=="object"&&y=="style"){var x=r.serializeStyle(q);if(q!=null&&typeof(q.cssText)!="undefined"){q=q.cssText}q=r.serializeStyle(r.parseStyle(q))}return q}}if(d&&r.props[y]){q=u[r.props[y]];q=q&&q.nodeValue?q.nodeValue:q}if(!q){q=u.getAttribute(y,2)}if(/^(?:checked|compact|declare|defer|disabled|ismap|multiple|nohref|noshade|nowrap|readonly|selected)$/.test(y)){if(u[r.props[y]]===true&&q===""){return y}return q?y:""}if(u.nodeName==="FORM"&&u.getAttributeNode(y)){return u.getAttributeNode(y).nodeValue}if(y==="style"){q=q||u.style.cssText;if(q){q=r.serializeStyle(r.parseStyle(q),u.nodeName);if(r.settings.keep_values&&!r._isRes(q)){u.setAttribute("_mce_style",q)}}}if(j&&y==="class"&&q){q=q.replace(/(apple|webkit)\-[a-z\-]+/gi,"")}if(d){switch(y){case"rowspan":case"colspan":if(q===1){q=""}break;case"size":if(q==="+0"||q===20||q===0){q=""}break;case"width":case"height":case"vspace":case"checked":case"disabled":case"readonly":if(q===0){q=""}break;case"hspace":if(q===-1){q=""}break;case"maxlength":case"tabindex":if(q===32768||q===2147483647||q==="32768"){q=""}break;case"multiple":case"compact":case"noshade":case"nowrap":if(q===65535){return y}return s;case"shape":q=q.toLowerCase();break;default:if(y.indexOf("on")===0&&q){q=(""+q).replace(/^function\s+\w+\(\)\s+\{\s+(.*)\s+\}$/,"$1")}}}return(q!==undefined&&q!==null&&q!=="")?""+q:s},getPos:function(C,v){var s=this,q=0,B=0,z,A=s.doc,u;C=s.get(C);v=v||A.body;if(C){if(d&&!s.stdMode){C=C.getBoundingClientRect();z=s.boxModel?A.documentElement:A.body;q=s.getStyle(s.select("html")[0],"borderWidth");q=(q=="medium"||s.boxModel&&!s.isIE6)&&2||q;return{x:C.left+z.scrollLeft-q,y:C.top+z.scrollTop-q}}u=C;while(u&&u!=v&&u.nodeType){q+=u.offsetLeft||0;B+=u.offsetTop||0;u=u.offsetParent}u=C.parentNode;while(u&&u!=v&&u.nodeType){q-=u.scrollLeft||0;B-=u.scrollTop||0;u=u.parentNode}}return{x:q,y:B}},parseStyle:function(u){var v=this,x=v.settings,y={};if(!u){return y}function q(F,C,E){var B,D,z,A;B=y[F+"-top"+C];if(!B){return}D=y[F+"-right"+C];if(B!=D){return}z=y[F+"-bottom"+C];if(D!=z){return}A=y[F+"-left"+C];if(z!=A){return}y[E]=A;delete y[F+"-top"+C];delete y[F+"-right"+C];delete y[F+"-bottom"+C];delete y[F+"-left"+C]}function r(A,z,s,C){var B;B=y[z];if(!B){return}B=y[s];if(!B){return}B=y[C];if(!B){return}y[A]=y[z]+" "+y[s]+" "+y[C];delete y[z];delete y[s];delete y[C]}u=u.replace(/&(#?[a-z0-9]+);/g,"&$1_MCE_SEMI_");m(u.split(";"),function(t){var s,z=[];if(t){t=t.replace(/_MCE_SEMI_/g,";");t=t.replace(/url\([^\)]+\)/g,function(A){z.push(A);return"url("+z.length+")"});t=t.split(":");s=o.trim(t[1]);s=s.replace(/url\(([^\)]+)\)/g,function(B,A){return z[parseInt(A)-1]});s=s.replace(/rgb\([^\)]+\)/g,function(A){return v.toHex(A)});if(x.url_converter){s=s.replace(/url\([\'\"]?([^\)\'\"]+)[\'\"]?\)/g,function(A,B){return"url("+x.url_converter.call(x.url_converter_scope||v,v.decode(B),"style",null)+")"})}y[o.trim(t[0]).toLowerCase()]=s}});q("border","","border");q("border","-width","border-width");q("border","-color","border-color");q("border","-style","border-style");q("padding","","padding");q("margin","","margin");if(d){if(y.border=="medium none"){y.border=""}}return y},serializeStyle:function(x,q){var r=this,u="";function v(t,s){if(s&&t){if(s.indexOf("-")===0){return}switch(s){case"font-weight":if(t==700){t="bold"}break;case"color":case"background-color":t=t.toLowerCase();break}u+=(u?" ":"")+s+": "+t+";"}}if(q&&r._styles){m(r._styles["*"],function(s){v(x[s],s)});m(r._styles[q.toLowerCase()],function(s){v(x[s],s)})}else{m(x,v)}return u},loadCSS:function(q){var s=this,v=s.doc,r;if(!q){q=""}r=s.select("head")[0];m(q.split(","),function(t){var x;if(s.files[t]){return}s.files[t]=true;x=s.create("link",{rel:"stylesheet",href:o._addVer(t)});if(d&&v.documentMode){x.onload=function(){v.recalc();x.onload=null}}r.appendChild(x)})},addClass:function(q,r){return this.run(q,function(s){var t;if(!r){return 0}if(this.hasClass(s,r)){return s.className}t=this.removeClass(s,r);return s.className=(t!=""?(t+" "):"")+r})},removeClass:function(s,u){var q=this,r;return q.run(s,function(x){var t;if(q.hasClass(x,u)){if(!r){r=new RegExp("(^|\\s+)"+u+"(\\s+|$)","g")}t=x.className.replace(r," ");t=o.trim(t!=" "?t:"");x.className=t;if(!t){x.removeAttribute("class");x.removeAttribute("className")}return t}return x.className})},hasClass:function(r,q){r=this.get(r);if(!r||!q){return false}return(" "+r.className+" ").indexOf(" "+q+" ")!==-1},show:function(q){return this.setStyle(q,"display","block")},hide:function(q){return this.setStyle(q,"display","none")},isHidden:function(q){q=this.get(q);return !q||q.style.display=="none"||this.getStyle(q,"display")=="none"},uniqueId:function(q){return(!q?"mce_":q)+(this.counter++)},setHTML:function(s,r){var q=this;return this.run(s,function(z){var t,v,u,B,y,t;r=q.processHTML(r);if(d){function A(){while(z.firstChild){z.firstChild.removeNode()}try{z.innerHTML="<br />"+r;z.removeChild(z.firstChild)}catch(x){t=q.create("div");t.innerHTML="<br />"+r;m(t.childNodes,function(D,C){if(C){z.appendChild(D)}})}}if(q.settings.fix_ie_paragraphs){r=r.replace(/<p><\/p>|<p([^>]+)><\/p>|<p[^\/+]\/>/gi,'<p$1 _mce_keep="true">&nbsp;</p>')}A();if(q.settings.fix_ie_paragraphs){u=z.getElementsByTagName("p");for(v=u.length-1,t=0;v>=0;v--){B=u[v];if(!B.hasChildNodes()){if(!B._mce_keep){t=1;break}B.removeAttribute("_mce_keep")}}}if(t){r=r.replace(/<p ([^>]+)>|<p>/ig,'<div $1 _mce_tmp="1">');r=r.replace(/<\/p>/gi,"</div>");A();if(q.settings.fix_ie_paragraphs){u=z.getElementsByTagName("DIV");for(v=u.length-1;v>=0;v--){B=u[v];if(B._mce_tmp){y=q.doc.createElement("p");B.cloneNode(false).outerHTML.replace(/([a-z0-9\-_]+)=/gi,function(C,x){var D;if(x!=="_mce_tmp"){D=B.getAttribute(x);if(!D&&x==="class"){D=B.className}y.setAttribute(x,D)}});for(t=0;t<B.childNodes.length;t++){y.appendChild(B.childNodes[t].cloneNode(true))}B.swapNode(y)}}}}}else{z.innerHTML=r}return r})},processHTML:function(v){var r=this,u=r.settings,y=[];if(!u.process_html){return v}if(d){v=v.replace(/&apos;/g,"&#39;");v=v.replace(/\s+(disabled|checked|readonly|selected)\s*=\s*[\"\']?(false|0)[\"\']?/gi,"")}v=v.replace(/<a( )([^>]+)\/>|<a\/>/gi,"<a$1$2></a>");if(u.keep_values){if(/<script|noscript|style/i.test(v)){function q(t){t=t.replace(/(<!--\[CDATA\[|\]\]-->)/g,"\n");t=t.replace(/^[\r\n]*|[\r\n]*$/g,"");t=t.replace(/^\s*(\/\/\s*<!--|\/\/\s*<!\[CDATA\[|<!--|<!\[CDATA\[)[\r\n]*/g,"");t=t.replace(/\s*(\/\/\s*\]\]>|\/\/\s*-->|\]\]>|-->|\]\]-->)\s*$/g,"");return t}v=v.replace(/<script([^>]+|)>([\s\S]*?)<\/script>/gi,function(s,z,t){if(!z){z=' type="text/javascript"'}z=z.replace(/src=\"([^\"]+)\"?/i,function(A,B){if(u.url_converter){B=r.encode(u.url_converter.call(u.url_converter_scope||r,r.decode(B),"src","script"))}return'_mce_src="'+B+'"'});if(o.trim(t)){y.push(q(t));t="<!--\nMCE_SCRIPT:"+(y.length-1)+"\n// -->"}return"<mce:script"+z+">"+t+"</mce:script>"});v=v.replace(/<style([^>]+|)>([\s\S]*?)<\/style>/gi,function(s,z,t){if(t){y.push(q(t));t="<!--\nMCE_SCRIPT:"+(y.length-1)+"\n-->"}return"<mce:style"+z+">"+t+"</mce:style><style "+z+' _mce_bogus="1">'+t+"</style>"});v=v.replace(/<noscript([^>]+|)>([\s\S]*?)<\/noscript>/g,function(s,z,t){return"<mce:noscript"+z+"><!--"+r.encode(t).replace(/--/g,"&#45;&#45;")+"--></mce:noscript>"})}v=v.replace(/<!\[CDATA\[([\s\S]+)\]\]>/g,"<!--[CDATA[$1]]-->");function x(s){return s.replace(i,function(A,B,z,t){return"<"+B+z.replace(n,function(D,C,G,F,E){var H;C=C.toLowerCase();G=G||F||E||"";if(e[C]){if(G==="false"||G==="0"){return}return C+'="'+C+'"'}if(f[C]&&z.indexOf("_mce_"+C)==-1){H=r.decode(G);if(u.url_converter&&(C=="src"||C=="href")){H=u.url_converter.call(u.url_converter_scope||r,H,C,B)}if(C=="style"){H=r.serializeStyle(r.parseStyle(H),C)}return C+'="'+G+'" _mce_'+C+'="'+r.encode(H)+'"'}return D})+t+">"})}v=x(v);v=v.replace(/MCE_SCRIPT:([0-9]+)/g,function(t,s){return y[s]})}return v},getOuterHTML:function(q){var r;q=this.get(q);if(!q){return null}if(q.outerHTML!==undefined){return q.outerHTML}r=(q.ownerDocument||this.doc).createElement("body");r.appendChild(q.cloneNode(true));return r.innerHTML},setOuterHTML:function(u,r,v){var q=this;function s(x,t,z){var A,y;y=z.createElement("body");y.innerHTML=t;A=y.lastChild;while(A){q.insertAfter(A.cloneNode(true),x);A=A.previousSibling}q.remove(x)}return this.run(u,function(x){x=q.get(x);if(x.nodeType==1){v=v||x.ownerDocument||q.doc;if(d){try{if(d&&x.nodeType==1){x.outerHTML=r}else{s(x,r,v)}}catch(t){s(x,r,v)}}else{s(x,r,v)}}})},decode:function(r){var t,u,q;if(/&[\w#]+;/.test(r)){t=this.doc.createElement("div");t.innerHTML=r;u=t.firstChild;q="";if(u){do{q+=u.nodeValue}while(u=u.nextSibling)}return q||r}return r},encode:function(q){return(""+q).replace(p,function(r){return c[r]})},insertAfter:function(q,r){r=this.get(r);return this.run(q,function(t){var s,u;s=r.parentNode;u=r.nextSibling;if(u){s.insertBefore(t,u)}else{s.appendChild(t)}return t})},isBlock:function(q){if(q.nodeType&&q.nodeType!==1){return false}q=q.nodeName||q;return a.test(q)},replace:function(u,s,q){var r=this;if(k(s,"array")){u=u.cloneNode(true)}return r.run(s,function(t){if(q){m(o.grep(t.childNodes),function(v){u.appendChild(v)})}return t.parentNode.replaceChild(u,t)})},rename:function(u,q){var s=this,r;if(u.nodeName!=q.toUpperCase()){r=s.create(q);m(s.getAttribs(u),function(t){s.setAttrib(r,t.nodeName,s.getAttrib(u,t.nodeName))});s.replace(r,u,1)}return r||u},findCommonAncestor:function(s,q){var t=s,r;while(t){r=q;while(r&&t!=r){r=r.parentNode}if(t==r){break}t=t.parentNode}if(!t&&s.ownerDocument){return s.ownerDocument.documentElement}return t},toHex:function(q){var t=/^\s*rgb\s*?\(\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?\)\s*$/i.exec(q);function r(u){u=parseInt(u).toString(16);return u.length>1?u:"0"+u}if(t){q="#"+r(t[1])+r(t[2])+r(t[3]);return q}return q},getClasses:function(){var v=this,q=[],u,x={},y=v.settings.class_filter,s;if(v.classes){return v.classes}function z(t){m(t.imports,function(A){z(A)});m(t.cssRules||t.rules,function(A){switch(A.type||1){case 1:if(A.selectorText){m(A.selectorText.split(","),function(B){B=B.replace(/^\s*|\s*$|^\s\./g,"");if(/\.mce/.test(B)||!/\.[\w\-]+$/.test(B)){return}s=B;B=B.replace(/.*\.([a-z0-9_\-]+).*/i,"$1");if(y&&!(B=y(B,s))){return}if(!x[B]){q.push({"class":B});x[B]=1}})}break;case 3:z(A.styleSheet);break}})}try{m(v.doc.styleSheets,z)}catch(r){}if(q.length>0){v.classes=q}return q},run:function(v,u,r){var q=this,x;if(q.doc&&typeof(v)==="string"){v=q.get(v)}if(!v){return false}r=r||this;if(!v.nodeType&&(v.length||v.length===0)){x=[];m(v,function(t,s){if(t){if(typeof(t)=="string"){t=q.doc.getElementById(t)}x.push(u.call(r,t,s))}});return x}return u.call(r,v)},getAttribs:function(r){var q;r=this.get(r);if(!r){return[]}if(d){q=[];if(r.nodeName=="OBJECT"){return r.attributes}if(r.nodeName==="OPTION"&&this.getAttrib(r,"selected")){q.push({specified:1,nodeName:"selected"})}r.cloneNode(false).outerHTML.replace(/<\/?[\w:\-]+ ?|=[\"][^\"]+\"|=\'[^\']+\'|=[\w\-]+|>/gi,"").replace(/[\w:\-]+/gi,function(s){q.push({specified:1,nodeName:s})});return q}return r.attributes},destroy:function(r){var q=this;if(q.events){q.events.destroy()}q.win=q.doc=q.root=q.events=null;if(!r){o.removeUnload(q.destroy)}},createRng:function(){var q=this.doc;return q.createRange?q.createRange():new o.dom.Range(this)},nodeIndex:function(u,v){var q=0,s,t,r;if(u){for(s=u.nodeType,u=u.previousSibling,t=u;u;u=u.previousSibling){r=u.nodeType;if(v&&r==3){if(r==s||!u.nodeValue.length){continue}}q++;s=r}}return q},split:function(x,v,A){var B=this,q=B.createRng(),y,u,z;function s(C){var t,r=C.childNodes;if(C.nodeType==1&&C.getAttribute("_mce_type")=="bookmark"){return}for(t=r.length-1;t>=0;t--){s(r[t])}if(C.nodeType!=9){if(C.nodeType==3&&C.nodeValue.length>0){return}if(C.nodeType==1){r=C.childNodes;if(r.length==1&&r[0]&&r[0].nodeType==1&&r[0].getAttribute("_mce_type")=="bookmark"){C.parentNode.insertBefore(r[0],C)}if(r.length||/^(br|hr|input|img)$/i.test(C.nodeName)){return}}B.remove(C)}return C}if(x&&v){l=l||(function(){if(B.doc.createRange&&o.isWebKit){var E=B.create("div");E.innerHTML="<p><span>1234</span><span>two</span><br /></p>";var r=B.doc.createRange();r.setStart(E,0);r.setEnd(E.firstChild,2);var D=r.extractContents();if(!D||!D.firstChild||!D.firstChild.childNodes||D.firstChild.childNodes.length!=2){return function t(G){var F=new o.dom.Range(B);F.setStart(G.startContainer,G.startOffset);F.setEnd(G.endContainer,G.endOffset);var H=F.extractContents();G.setStart(F.startContainer,F.startOffset);G.setEnd(F.endContainer,F.endOffset);return H}}}return function C(F){return F.extractContents()}})();q.setStart(x.parentNode,B.nodeIndex(x));q.setEnd(v.parentNode,B.nodeIndex(v));y=l(q);q=B.createRng();q.setStart(v.parentNode,B.nodeIndex(v)+1);q.setEnd(x.parentNode,B.nodeIndex(x)+1);u=l(q);z=x.parentNode;z.insertBefore(s(y),x);if(A){z.insertBefore(A,x)}else{z.insertBefore(v,x)}z.insertBefore(s(u),x);B.remove(x);return A||v}},bind:function(v,q,u,s){var r=this;if(!r.events){r.events=new o.dom.EventUtils()}return r.events.add(v,q,u,s||this)},unbind:function(u,q,s){var r=this;if(!r.events){r.events=new o.dom.EventUtils()}return r.events.remove(u,q,s)},_findSib:function(u,q,r){var s=this,v=q;if(u){if(k(v,"string")){v=function(t){return s.is(t,q)}}for(u=u[r];u;u=u[r]){if(v(u)){return u}}}return null},_isRes:function(q){return/^(top|left|bottom|right|width|height)/i.test(q)||/;\s*(top|left|bottom|right|width|height)/i.test(q)}});o.DOM=new o.dom.DOMUtils(document,{process_html:0})})(tinymce);(function(a){function b(c){var N=this,e=c.doc,S=0,E=1,j=2,D=true,R=false,U="startOffset",h="startContainer",P="endContainer",z="endOffset",k=tinymce.extend,n=c.nodeIndex;k(N,{startContainer:e,startOffset:0,endContainer:e,endOffset:0,collapsed:D,commonAncestorContainer:e,START_TO_START:0,START_TO_END:1,END_TO_END:2,END_TO_START:3,setStart:q,setEnd:s,setStartBefore:g,setStartAfter:I,setEndBefore:J,setEndAfter:u,collapse:A,selectNode:x,selectNodeContents:F,compareBoundaryPoints:v,deleteContents:p,extractContents:H,cloneContents:d,insertNode:C,surroundContents:M,cloneRange:K});function q(V,t){B(D,V,t)}function s(V,t){B(R,V,t)}function g(t){q(t.parentNode,n(t))}function I(t){q(t.parentNode,n(t)+1)}function J(t){s(t.parentNode,n(t))}function u(t){s(t.parentNode,n(t)+1)}function A(t){if(t){N[P]=N[h];N[z]=N[U]}else{N[h]=N[P];N[U]=N[z]}N.collapsed=D}function x(t){g(t);u(t)}function F(t){q(t,0);s(t,t.nodeType===1?t.childNodes.length:t.nodeValue.length)}function v(W,X){var Z=N[h],Y=N[U],V=N[P],t=N[z];if(W===0){return G(Z,Y,Z,Y)}if(W===1){return G(Z,Y,V,t)}if(W===2){return G(V,t,V,t)}if(W===3){return G(V,t,Z,Y)}}function p(){m(j)}function H(){return m(S)}function d(){return m(E)}function C(Y){var V=this[h],t=this[U],X,W;if((V.nodeType===3||V.nodeType===4)&&V.nodeValue){if(!t){V.parentNode.insertBefore(Y,V)}else{if(t>=V.nodeValue.length){c.insertAfter(Y,V)}else{X=V.splitText(t);V.parentNode.insertBefore(Y,X)}}}else{if(V.childNodes.length>0){W=V.childNodes[t]}if(W){V.insertBefore(Y,W)}else{V.appendChild(Y)}}}function M(V){var t=N.extractContents();N.insertNode(V);V.appendChild(t);N.selectNode(V)}function K(){return k(new b(c),{startContainer:N[h],startOffset:N[U],endContainer:N[P],endOffset:N[z],collapsed:N.collapsed,commonAncestorContainer:N.commonAncestorContainer})}function O(t,V){var W;if(t.nodeType==3){return t}if(V<0){return t}W=t.firstChild;while(W&&V>0){--V;W=W.nextSibling}if(W){return W}return t}function l(){return(N[h]==N[P]&&N[U]==N[z])}function G(X,Z,V,Y){var aa,W,t,ab,ad,ac;if(X==V){if(Z==Y){return 0}if(Z<Y){return -1}return 1}aa=V;while(aa&&aa.parentNode!=X){aa=aa.parentNode}if(aa){W=0;t=X.firstChild;while(t!=aa&&W<Z){W++;t=t.nextSibling}if(Z<=W){return -1}return 1}aa=X;while(aa&&aa.parentNode!=V){aa=aa.parentNode}if(aa){W=0;t=V.firstChild;while(t!=aa&&W<Y){W++;t=t.nextSibling}if(W<Y){return -1}return 1}ab=c.findCommonAncestor(X,V);ad=X;while(ad&&ad.parentNode!=ab){ad=ad.parentNode}if(!ad){ad=ab}ac=V;while(ac&&ac.parentNode!=ab){ac=ac.parentNode}if(!ac){ac=ab}if(ad==ac){return 0}t=ab.firstChild;while(t){if(t==ad){return -1}if(t==ac){return 1}t=t.nextSibling}}function B(V,Y,X){var t,W;if(V){N[h]=Y;N[U]=X}else{N[P]=Y;N[z]=X}t=N[P];while(t.parentNode){t=t.parentNode}W=N[h];while(W.parentNode){W=W.parentNode}if(W==t){if(G(N[h],N[U],N[P],N[z])>0){N.collapse(V)}}else{N.collapse(V)}N.collapsed=l();N.commonAncestorContainer=c.findCommonAncestor(N[h],N[P])}function m(ab){var aa,X=0,ad=0,V,Z,W,Y,t,ac;if(N[h]==N[P]){return f(ab)}for(aa=N[P],V=aa.parentNode;V;aa=V,V=V.parentNode){if(V==N[h]){return r(aa,ab)}++X}for(aa=N[h],V=aa.parentNode;V;aa=V,V=V.parentNode){if(V==N[P]){return T(aa,ab)}++ad}Z=ad-X;W=N[h];while(Z>0){W=W.parentNode;Z--}Y=N[P];while(Z<0){Y=Y.parentNode;Z++}for(t=W.parentNode,ac=Y.parentNode;t!=ac;t=t.parentNode,ac=ac.parentNode){W=t;Y=ac}return o(W,Y,ab)}function f(Z){var ab,Y,X,aa,t,W,V;if(Z!=j){ab=e.createDocumentFragment()}if(N[U]==N[z]){return ab}if(N[h].nodeType==3){Y=N[h].nodeValue;X=Y.substring(N[U],N[z]);if(Z!=E){N[h].deleteData(N[U],N[z]-N[U]);N.collapse(D)}if(Z==j){return}ab.appendChild(e.createTextNode(X));return ab}aa=O(N[h],N[U]);t=N[z]-N[U];while(t>0){W=aa.nextSibling;V=y(aa,Z);if(ab){ab.appendChild(V)}--t;aa=W}if(Z!=E){N.collapse(D)}return ab}function r(ab,Y){var aa,Z,V,t,X,W;if(Y!=j){aa=e.createDocumentFragment()}Z=i(ab,Y);if(aa){aa.appendChild(Z)}V=n(ab);t=V-N[U];if(t<=0){if(Y!=E){N.setEndBefore(ab);N.collapse(R)}return aa}Z=ab.previousSibling;while(t>0){X=Z.previousSibling;W=y(Z,Y);if(aa){aa.insertBefore(W,aa.firstChild)}--t;Z=X}if(Y!=E){N.setEndBefore(ab);N.collapse(R)}return aa}function T(Z,Y){var ab,V,aa,t,X,W;if(Y!=j){ab=e.createDocumentFragment()}aa=Q(Z,Y);if(ab){ab.appendChild(aa)}V=n(Z);++V;t=N[z]-V;aa=Z.nextSibling;while(t>0){X=aa.nextSibling;W=y(aa,Y);if(ab){ab.appendChild(W)}--t;aa=X}if(Y!=E){N.setStartAfter(Z);N.collapse(D)}return ab}function o(Z,t,ac){var W,ae,Y,aa,ab,V,ad,X;if(ac!=j){ae=e.createDocumentFragment()}W=Q(Z,ac);if(ae){ae.appendChild(W)}Y=Z.parentNode;aa=n(Z);ab=n(t);++aa;V=ab-aa;ad=Z.nextSibling;while(V>0){X=ad.nextSibling;W=y(ad,ac);if(ae){ae.appendChild(W)}ad=X;--V}W=i(t,ac);if(ae){ae.appendChild(W)}if(ac!=E){N.setStartAfter(Z);N.collapse(D)}return ae}function i(aa,ab){var W=O(N[P],N[z]-1),ac,Z,Y,t,V,X=W!=N[P];if(W==aa){return L(W,X,R,ab)}ac=W.parentNode;Z=L(ac,R,R,ab);while(ac){while(W){Y=W.previousSibling;t=L(W,X,R,ab);if(ab!=j){Z.insertBefore(t,Z.firstChild)}X=D;W=Y}if(ac==aa){return Z}W=ac.previousSibling;ac=ac.parentNode;V=L(ac,R,R,ab);if(ab!=j){V.appendChild(Z)}Z=V}}function Q(aa,ab){var X=O(N[h],N[U]),Y=X!=N[h],ac,Z,W,t,V;if(X==aa){return L(X,Y,D,ab)}ac=X.parentNode;Z=L(ac,R,D,ab);while(ac){while(X){W=X.nextSibling;t=L(X,Y,D,ab);if(ab!=j){Z.appendChild(t)}Y=D;X=W}if(ac==aa){return Z}X=ac.nextSibling;ac=ac.parentNode;V=L(ac,R,D,ab);if(ab!=j){V.appendChild(Z)}Z=V}}function L(t,Y,ab,ac){var X,W,Z,V,aa;if(Y){return y(t,ac)}if(t.nodeType==3){X=t.nodeValue;if(ab){V=N[U];W=X.substring(V);Z=X.substring(0,V)}else{V=N[z];W=X.substring(0,V);Z=X.substring(V)}if(ac!=E){t.nodeValue=Z}if(ac==j){return}aa=t.cloneNode(R);aa.nodeValue=W;return aa}if(ac==j){return}return t.cloneNode(R)}function y(V,t){if(t!=j){return t==E?V.cloneNode(D):V}V.parentNode.removeChild(V)}}a.Range=b})(tinymce.dom);(function(){function a(g){var i=this,j="\uFEFF",e,h,d=g.dom,c=true,f=false;function b(){var n=g.getRng(),k=d.createRng(),m,o;m=n.item?n.item(0):n.parentElement();if(m.ownerDocument!=d.doc){return k}if(n.item||!m.hasChildNodes()){k.setStart(m.parentNode,d.nodeIndex(m));k.setEnd(k.startContainer,k.startOffset+1);return k}o=g.isCollapsed();function l(s){var u,q,t,p,A=0,x,y,z,r,v;r=n.duplicate();r.collapse(s);u=d.create("a");z=r.parentElement();if(!z.hasChildNodes()){k[s?"setStart":"setEnd"](z,0);return}z.appendChild(u);r.moveToElementText(u);v=n.compareEndPoints(s?"StartToStart":"EndToEnd",r);if(v>0){k[s?"setStartAfter":"setEndAfter"](z);d.remove(u);return}p=tinymce.grep(z.childNodes);x=p.length-1;while(A<=x){y=Math.floor((A+x)/2);z.insertBefore(u,p[y]);r.moveToElementText(u);v=n.compareEndPoints(s?"StartToStart":"EndToEnd",r);if(v>0){A=y+1}else{if(v<0){x=y-1}else{found=true;break}}}q=v>0||y==0?u.nextSibling:u.previousSibling;if(q.nodeType==1){d.remove(u);t=d.nodeIndex(q);q=q.parentNode;if(!s||y>0){t++}}else{if(v>0||y==0){r.setEndPoint(s?"StartToStart":"EndToEnd",n);t=r.text.length}else{r.setEndPoint(s?"StartToStart":"EndToEnd",n);t=q.nodeValue.length-r.text.length}d.remove(u)}k[s?"setStart":"setEnd"](q,t)}l(true);if(!o){l()}return k}this.addRange=function(k){var p,n,m,r,u,s,t=g.dom.doc,o=t.body;function l(B){var x,A,v,z,y;v=d.create("a");x=B?m:u;A=B?r:s;z=p.duplicate();if(x==t){x=o;A=0}if(x.nodeType==3){x.parentNode.insertBefore(v,x);z.moveToElementText(v);z.moveStart("character",A);d.remove(v);p.setEndPoint(B?"StartToStart":"EndToEnd",z)}else{y=x.childNodes;if(y.length){if(A>=y.length){d.insertAfter(v,y[y.length-1])}else{x.insertBefore(v,y[A])}z.moveToElementText(v)}else{v=t.createTextNode(j);x.appendChild(v);z.moveToElementText(v.parentNode);z.collapse(c)}p.setEndPoint(B?"StartToStart":"EndToEnd",z);d.remove(v)}}this.destroy();m=k.startContainer;r=k.startOffset;u=k.endContainer;s=k.endOffset;p=o.createTextRange();if(m==u&&m.nodeType==1&&r==s-1){if(r==s-1){try{n=o.createControlRange();n.addElement(m.childNodes[r]);n.select();n.scrollIntoView();return}catch(q){}}}l(true);l();p.select();p.scrollIntoView()};this.getRangeAt=function(){if(!e||!tinymce.dom.RangeUtils.compareRanges(h,g.getRng())){e=b();h=g.getRng()}try{e.startContainer.nextSibling}catch(k){e=b();h=null}return e};this.destroy=function(){h=e=null};if(g.dom.boxModel){(function(){var q=d.doc,l=q.body,n,o;q.documentElement.unselectable=c;function p(r,u){var s=l.createTextRange();try{s.moveToPoint(r,u)}catch(t){s=null}return s}function m(s){var r;if(s.button){r=p(s.x,s.y);if(r){if(r.compareEndPoints("StartToStart",o)>0){r.setEndPoint("StartToStart",o)}else{r.setEndPoint("EndToEnd",o)}r.select()}}else{k()}}function k(){d.unbind(q,"mouseup",k);d.unbind(q,"mousemove",m);n=0}d.bind(q,"mousedown",function(r){if(r.target.nodeName==="HTML"){if(q.parentWindow.screenLeft+r.x>q.parentWindow.frameElement.clientWidth||q.parentWindow.screenTop+r.y>q.parentWindow.frameElement.clientHeight){return}if(n){k()}n=1;o=p(r.x,r.y);if(o){d.bind(q,"mouseup",k);d.bind(q,"mousemove",m);o.select()}}})})()}}tinymce.dom.TridentSelection=a})();(function(){var p=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,j=0,d=Object.prototype.toString,o=false,i=true;[0,0].sort(function(){i=false;return 0});var b=function(v,e,z,A){z=z||[];e=e||document;var C=e;if(e.nodeType!==1&&e.nodeType!==9){return[]}if(!v||typeof v!=="string"){return z}var x=[],s,E,H,r,u=true,t=b.isXML(e),B=v,D,G,F,y;do{p.exec("");s=p.exec(B);if(s){B=s[3];x.push(s[1]);if(s[2]){r=s[3];break}}}while(s);if(x.length>1&&k.exec(v)){if(x.length===2&&f.relative[x[0]]){E=h(x[0]+x[1],e)}else{E=f.relative[x[0]]?[e]:b(x.shift(),e);while(x.length){v=x.shift();if(f.relative[v]){v+=x.shift()}E=h(v,E)}}}else{if(!A&&x.length>1&&e.nodeType===9&&!t&&f.match.ID.test(x[0])&&!f.match.ID.test(x[x.length-1])){D=b.find(x.shift(),e,t);e=D.expr?b.filter(D.expr,D.set)[0]:D.set[0]}if(e){D=A?{expr:x.pop(),set:a(A)}:b.find(x.pop(),x.length===1&&(x[0]==="~"||x[0]==="+")&&e.parentNode?e.parentNode:e,t);E=D.expr?b.filter(D.expr,D.set):D.set;if(x.length>0){H=a(E)}else{u=false}while(x.length){G=x.pop();F=G;if(!f.relative[G]){G=""}else{F=x.pop()}if(F==null){F=e}f.relative[G](H,F,t)}}else{H=x=[]}}if(!H){H=E}if(!H){b.error(G||v)}if(d.call(H)==="[object Array]"){if(!u){z.push.apply(z,H)}else{if(e&&e.nodeType===1){for(y=0;H[y]!=null;y++){if(H[y]&&(H[y]===true||H[y].nodeType===1&&b.contains(e,H[y]))){z.push(E[y])}}}else{for(y=0;H[y]!=null;y++){if(H[y]&&H[y].nodeType===1){z.push(E[y])}}}}}else{a(H,z)}if(r){b(r,C,z,A);b.uniqueSort(z)}return z};b.uniqueSort=function(r){if(c){o=i;r.sort(c);if(o){for(var e=1;e<r.length;e++){if(r[e]===r[e-1]){r.splice(e--,1)}}}}return r};b.matches=function(e,r){return b(e,null,null,r)};b.find=function(y,e,z){var x;if(!y){return[]}for(var t=0,s=f.order.length;t<s;t++){var v=f.order[t],u;if((u=f.leftMatch[v].exec(y))){var r=u[1];u.splice(1,1);if(r.substr(r.length-1)!=="\\"){u[1]=(u[1]||"").replace(/\\/g,"");x=f.find[v](u,e,z);if(x!=null){y=y.replace(f.match[v],"");break}}}}if(!x){x=e.getElementsByTagName("*")}return{set:x,expr:y}};b.filter=function(C,B,F,u){var s=C,H=[],z=B,x,e,y=B&&B[0]&&b.isXML(B[0]);while(C&&B.length){for(var A in f.filter){if((x=f.leftMatch[A].exec(C))!=null&&x[2]){var r=f.filter[A],G,E,t=x[1];e=false;x.splice(1,1);if(t.substr(t.length-1)==="\\"){continue}if(z===H){H=[]}if(f.preFilter[A]){x=f.preFilter[A](x,z,F,H,u,y);if(!x){e=G=true}else{if(x===true){continue}}}if(x){for(var v=0;(E=z[v])!=null;v++){if(E){G=r(E,x,v,z);var D=u^!!G;if(F&&G!=null){if(D){e=true}else{z[v]=false}}else{if(D){H.push(E);e=true}}}}}if(G!==undefined){if(!F){z=H}C=C.replace(f.match[A],"");if(!e){return[]}break}}}if(C===s){if(e==null){b.error(C)}else{break}}s=C}return z};b.error=function(e){throw"Syntax error, unrecognized expression: "+e};var f=b.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+\-]*)\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(e){return e.getAttribute("href")}},relative:{"+":function(x,r){var t=typeof r==="string",v=t&&!/\W/.test(r),y=t&&!v;if(v){r=r.toLowerCase()}for(var s=0,e=x.length,u;s<e;s++){if((u=x[s])){while((u=u.previousSibling)&&u.nodeType!==1){}x[s]=y||u&&u.nodeName.toLowerCase()===r?u||false:u===r}}if(y){b.filter(r,x,true)}},">":function(x,r){var u=typeof r==="string",v,s=0,e=x.length;if(u&&!/\W/.test(r)){r=r.toLowerCase();for(;s<e;s++){v=x[s];if(v){var t=v.parentNode;x[s]=t.nodeName.toLowerCase()===r?t:false}}}else{for(;s<e;s++){v=x[s];if(v){x[s]=u?v.parentNode:v.parentNode===r}}if(u){b.filter(r,x,true)}}},"":function(t,r,v){var s=j++,e=q,u;if(typeof r==="string"&&!/\W/.test(r)){r=r.toLowerCase();u=r;e=n}e("parentNode",r,s,t,u,v)},"~":function(t,r,v){var s=j++,e=q,u;if(typeof r==="string"&&!/\W/.test(r)){r=r.toLowerCase();u=r;e=n}e("previousSibling",r,s,t,u,v)}},find:{ID:function(r,s,t){if(typeof s.getElementById!=="undefined"&&!t){var e=s.getElementById(r[1]);return e?[e]:[]}},NAME:function(s,v){if(typeof v.getElementsByName!=="undefined"){var r=[],u=v.getElementsByName(s[1]);for(var t=0,e=u.length;t<e;t++){if(u[t].getAttribute("name")===s[1]){r.push(u[t])}}return r.length===0?null:r}},TAG:function(e,r){return r.getElementsByTagName(e[1])}},preFilter:{CLASS:function(t,r,s,e,x,y){t=" "+t[1].replace(/\\/g,"")+" ";if(y){return t}for(var u=0,v;(v=r[u])!=null;u++){if(v){if(x^(v.className&&(" "+v.className+" ").replace(/[\t\n]/g," ").indexOf(t)>=0)){if(!s){e.push(v)}}else{if(s){r[u]=false}}}}return false},ID:function(e){return e[1].replace(/\\/g,"")},TAG:function(r,e){return r[1].toLowerCase()},CHILD:function(e){if(e[1]==="nth"){var r=/(-?)(\d*)n((?:\+|-)?\d*)/.exec(e[2]==="even"&&"2n"||e[2]==="odd"&&"2n+1"||!/\D/.test(e[2])&&"0n+"+e[2]||e[2]);e[2]=(r[1]+(r[2]||1))-0;e[3]=r[3]-0}e[0]=j++;return e},ATTR:function(u,r,s,e,v,x){var t=u[1].replace(/\\/g,"");if(!x&&f.attrMap[t]){u[1]=f.attrMap[t]}if(u[2]==="~="){u[4]=" "+u[4]+" "}return u},PSEUDO:function(u,r,s,e,v){if(u[1]==="not"){if((p.exec(u[3])||"").length>1||/^\w/.test(u[3])){u[3]=b(u[3],null,null,r)}else{var t=b.filter(u[3],r,s,true^v);if(!s){e.push.apply(e,t)}return false}}else{if(f.match.POS.test(u[0])||f.match.CHILD.test(u[0])){return true}}return u},POS:function(e){e.unshift(true);return e}},filters:{enabled:function(e){return e.disabled===false&&e.type!=="hidden"},disabled:function(e){return e.disabled===true},checked:function(e){return e.checked===true},selected:function(e){e.parentNode.selectedIndex;return e.selected===true},parent:function(e){return !!e.firstChild},empty:function(e){return !e.firstChild},has:function(s,r,e){return !!b(e[3],s).length},header:function(e){return(/h\d/i).test(e.nodeName)},text:function(e){return"text"===e.type},radio:function(e){return"radio"===e.type},checkbox:function(e){return"checkbox"===e.type},file:function(e){return"file"===e.type},password:function(e){return"password"===e.type},submit:function(e){return"submit"===e.type},image:function(e){return"image"===e.type},reset:function(e){return"reset"===e.type},button:function(e){return"button"===e.type||e.nodeName.toLowerCase()==="button"},input:function(e){return(/input|select|textarea|button/i).test(e.nodeName)}},setFilters:{first:function(r,e){return e===0},last:function(s,r,e,t){return r===t.length-1},even:function(r,e){return e%2===0},odd:function(r,e){return e%2===1},lt:function(s,r,e){return r<e[3]-0},gt:function(s,r,e){return r>e[3]-0},nth:function(s,r,e){return e[3]-0===r},eq:function(s,r,e){return e[3]-0===r}},filter:{PSEUDO:function(s,y,x,z){var e=y[1],r=f.filters[e];if(r){return r(s,x,y,z)}else{if(e==="contains"){return(s.textContent||s.innerText||b.getText([s])||"").indexOf(y[3])>=0}else{if(e==="not"){var t=y[3];for(var v=0,u=t.length;v<u;v++){if(t[v]===s){return false}}return true}else{b.error("Syntax error, unrecognized expression: "+e)}}}},CHILD:function(e,t){var x=t[1],r=e;switch(x){case"only":case"first":while((r=r.previousSibling)){if(r.nodeType===1){return false}}if(x==="first"){return true}r=e;case"last":while((r=r.nextSibling)){if(r.nodeType===1){return false}}return true;case"nth":var s=t[2],A=t[3];if(s===1&&A===0){return true}var v=t[0],z=e.parentNode;if(z&&(z.sizcache!==v||!e.nodeIndex)){var u=0;for(r=z.firstChild;r;r=r.nextSibling){if(r.nodeType===1){r.nodeIndex=++u}}z.sizcache=v}var y=e.nodeIndex-A;if(s===0){return y===0}else{return(y%s===0&&y/s>=0)}}},ID:function(r,e){return r.nodeType===1&&r.getAttribute("id")===e},TAG:function(r,e){return(e==="*"&&r.nodeType===1)||r.nodeName.toLowerCase()===e},CLASS:function(r,e){return(" "+(r.className||r.getAttribute("class"))+" ").indexOf(e)>-1},ATTR:function(v,t){var s=t[1],e=f.attrHandle[s]?f.attrHandle[s](v):v[s]!=null?v[s]:v.getAttribute(s),x=e+"",u=t[2],r=t[4];return e==null?u==="!=":u==="="?x===r:u==="*="?x.indexOf(r)>=0:u==="~="?(" "+x+" ").indexOf(r)>=0:!r?x&&e!==false:u==="!="?x!==r:u==="^="?x.indexOf(r)===0:u==="$="?x.substr(x.length-r.length)===r:u==="|="?x===r||x.substr(0,r.length+1)===r+"-":false},POS:function(u,r,s,v){var e=r[2],t=f.setFilters[e];if(t){return t(u,s,r,v)}}}};var k=f.match.POS,g=function(r,e){return"\\"+(e-0+1)};for(var m in f.match){f.match[m]=new RegExp(f.match[m].source+(/(?![^\[]*\])(?![^\(]*\))/.source));f.leftMatch[m]=new RegExp(/(^(?:.|\r|\n)*?)/.source+f.match[m].source.replace(/\\(\d+)/g,g))}var a=function(r,e){r=Array.prototype.slice.call(r,0);if(e){e.push.apply(e,r);return e}return r};try{Array.prototype.slice.call(document.documentElement.childNodes,0)[0].nodeType}catch(l){a=function(u,t){var r=t||[],s=0;if(d.call(u)==="[object Array]"){Array.prototype.push.apply(r,u)}else{if(typeof u.length==="number"){for(var e=u.length;s<e;s++){r.push(u[s])}}else{for(;u[s];s++){r.push(u[s])}}}return r}}var c;if(document.documentElement.compareDocumentPosition){c=function(r,e){if(!r.compareDocumentPosition||!e.compareDocumentPosition){if(r==e){o=true}return r.compareDocumentPosition?-1:1}var s=r.compareDocumentPosition(e)&4?-1:r===e?0:1;if(s===0){o=true}return s}}else{if("sourceIndex" in document.documentElement){c=function(r,e){if(!r.sourceIndex||!e.sourceIndex){if(r==e){o=true}return r.sourceIndex?-1:1}var s=r.sourceIndex-e.sourceIndex;if(s===0){o=true}return s}}else{if(document.createRange){c=function(t,r){if(!t.ownerDocument||!r.ownerDocument){if(t==r){o=true}return t.ownerDocument?-1:1}var s=t.ownerDocument.createRange(),e=r.ownerDocument.createRange();s.setStart(t,0);s.setEnd(t,0);e.setStart(r,0);e.setEnd(r,0);var u=s.compareBoundaryPoints(Range.START_TO_END,e);if(u===0){o=true}return u}}}}b.getText=function(e){var r="",t;for(var s=0;e[s];s++){t=e[s];if(t.nodeType===3||t.nodeType===4){r+=t.nodeValue}else{if(t.nodeType!==8){r+=b.getText(t.childNodes)}}}return r};(function(){var r=document.createElement("div"),s="script"+(new Date()).getTime();r.innerHTML="<a name='"+s+"'/>";var e=document.documentElement;e.insertBefore(r,e.firstChild);if(document.getElementById(s)){f.find.ID=function(u,v,x){if(typeof v.getElementById!=="undefined"&&!x){var t=v.getElementById(u[1]);return t?t.id===u[1]||typeof t.getAttributeNode!=="undefined"&&t.getAttributeNode("id").nodeValue===u[1]?[t]:undefined:[]}};f.filter.ID=function(v,t){var u=typeof v.getAttributeNode!=="undefined"&&v.getAttributeNode("id");return v.nodeType===1&&u&&u.nodeValue===t}}e.removeChild(r);e=r=null})();(function(){var e=document.createElement("div");e.appendChild(document.createComment(""));if(e.getElementsByTagName("*").length>0){f.find.TAG=function(r,v){var u=v.getElementsByTagName(r[1]);if(r[1]==="*"){var t=[];for(var s=0;u[s];s++){if(u[s].nodeType===1){t.push(u[s])}}u=t}return u}}e.innerHTML="<a href='#'></a>";if(e.firstChild&&typeof e.firstChild.getAttribute!=="undefined"&&e.firstChild.getAttribute("href")!=="#"){f.attrHandle.href=function(r){return r.getAttribute("href",2)}}e=null})();if(document.querySelectorAll){(function(){var e=b,s=document.createElement("div");s.innerHTML="<p class='TEST'></p>";if(s.querySelectorAll&&s.querySelectorAll(".TEST").length===0){return}b=function(x,v,t,u){v=v||document;if(!u&&v.nodeType===9&&!b.isXML(v)){try{return a(v.querySelectorAll(x),t)}catch(y){}}return e(x,v,t,u)};for(var r in e){b[r]=e[r]}s=null})()}(function(){var e=document.createElement("div");e.innerHTML="<div class='test e'></div><div class='test'></div>";if(!e.getElementsByClassName||e.getElementsByClassName("e").length===0){return}e.lastChild.className="e";if(e.getElementsByClassName("e").length===1){return}f.order.splice(1,0,"CLASS");f.find.CLASS=function(r,s,t){if(typeof s.getElementsByClassName!=="undefined"&&!t){return s.getElementsByClassName(r[1])}};e=null})();function n(r,x,v,A,y,z){for(var t=0,s=A.length;t<s;t++){var e=A[t];if(e){e=e[r];var u=false;while(e){if(e.sizcache===v){u=A[e.sizset];break}if(e.nodeType===1&&!z){e.sizcache=v;e.sizset=t}if(e.nodeName.toLowerCase()===x){u=e;break}e=e[r]}A[t]=u}}}function q(r,x,v,A,y,z){for(var t=0,s=A.length;t<s;t++){var e=A[t];if(e){e=e[r];var u=false;while(e){if(e.sizcache===v){u=A[e.sizset];break}if(e.nodeType===1){if(!z){e.sizcache=v;e.sizset=t}if(typeof x!=="string"){if(e===x){u=true;break}}else{if(b.filter(x,[e]).length>0){u=e;break}}}e=e[r]}A[t]=u}}}b.contains=document.compareDocumentPosition?function(r,e){return !!(r.compareDocumentPosition(e)&16)}:function(r,e){return r!==e&&(r.contains?r.contains(e):true)};b.isXML=function(e){var r=(e?e.ownerDocument||e:0).documentElement;return r?r.nodeName!=="HTML":false};var h=function(e,y){var t=[],u="",v,s=y.nodeType?[y]:y;while((v=f.match.PSEUDO.exec(e))){u+=v[0];e=e.replace(f.match.PSEUDO,"")}e=f.relative[e]?e+"*":e;for(var x=0,r=s.length;x<r;x++){b(e,s[x],t)}return b.filter(u,t)};window.tinymce.dom.Sizzle=b})();(function(d){var f=d.each,c=d.DOM,b=d.isIE,e=d.isWebKit,a;d.create("tinymce.dom.EventUtils",{EventUtils:function(){this.inits=[];this.events=[]},add:function(m,p,l,j){var g,h=this,i=h.events,k;if(p instanceof Array){k=[];f(p,function(o){k.push(h.add(m,o,l,j))});return k}if(m&&m.hasOwnProperty&&m instanceof Array){k=[];f(m,function(n){n=c.get(n);k.push(h.add(n,p,l,j))});return k}m=c.get(m);if(!m){return}g=function(n){if(h.disabled){return}n=n||window.event;if(n&&b){if(!n.target){n.target=n.srcElement}d.extend(n,h._stoppers)}if(!j){return l(n)}return l.call(j,n)};if(p=="unload"){d.unloads.unshift({func:g});return g}if(p=="init"){if(h.domLoaded){g()}else{h.inits.push(g)}return g}i.push({obj:m,name:p,func:l,cfunc:g,scope:j});h._add(m,p,g);return l},remove:function(l,m,k){var h=this,g=h.events,i=false,j;if(l&&l.hasOwnProperty&&l instanceof Array){j=[];f(l,function(n){n=c.get(n);j.push(h.remove(n,m,k))});return j}l=c.get(l);f(g,function(o,n){if(o.obj==l&&o.name==m&&(!k||(o.func==k||o.cfunc==k))){g.splice(n,1);h._remove(l,m,o.cfunc);i=true;return false}});return i},clear:function(l){var j=this,g=j.events,h,k;if(l){l=c.get(l);for(h=g.length-1;h>=0;h--){k=g[h];if(k.obj===l){j._remove(k.obj,k.name,k.cfunc);k.obj=k.cfunc=null;g.splice(h,1)}}}},cancel:function(g){if(!g){return false}this.stop(g);return this.prevent(g)},stop:function(g){if(g.stopPropagation){g.stopPropagation()}else{g.cancelBubble=true}return false},prevent:function(g){if(g.preventDefault){g.preventDefault()}else{g.returnValue=false}return false},destroy:function(){var g=this;f(g.events,function(j,h){g._remove(j.obj,j.name,j.cfunc);j.obj=j.cfunc=null});g.events=[];g=null},_add:function(h,i,g){if(h.attachEvent){h.attachEvent("on"+i,g)}else{if(h.addEventListener){h.addEventListener(i,g,false)}else{h["on"+i]=g}}},_remove:function(i,j,h){if(i){try{if(i.detachEvent){i.detachEvent("on"+j,h)}else{if(i.removeEventListener){i.removeEventListener(j,h,false)}else{i["on"+j]=null}}}catch(g){}}},_pageInit:function(h){var g=this;if(g.domLoaded){return}g.domLoaded=true;f(g.inits,function(i){i()});g.inits=[]},_wait:function(i){var g=this,h=i.document;if(i.tinyMCE_GZ&&tinyMCE_GZ.loaded){g.domLoaded=1;return}if(h.attachEvent){h.attachEvent("onreadystatechange",function(){if(h.readyState==="complete"){h.detachEvent("onreadystatechange",arguments.callee);g._pageInit(i)}});if(h.documentElement.doScroll&&i==i.top){(function(){if(g.domLoaded){return}try{h.documentElement.doScroll("left")}catch(j){setTimeout(arguments.callee,0);return}g._pageInit(i)})()}}else{if(h.addEventListener){g._add(i,"DOMContentLoaded",function(){g._pageInit(i)})}}g._add(i,"load",function(){g._pageInit(i)})},_stoppers:{preventDefault:function(){this.returnValue=false},stopPropagation:function(){this.cancelBubble=true}}});a=d.dom.Event=new d.dom.EventUtils();a._wait(window);d.addUnload(function(){a.destroy()})})(tinymce);(function(a){a.dom.Element=function(f,d){var b=this,e,c;b.settings=d=d||{};b.id=f;b.dom=e=d.dom||a.DOM;if(!a.isIE){c=e.get(b.id)}a.each(("getPos,getRect,getParent,add,setStyle,getStyle,setStyles,setAttrib,setAttribs,getAttrib,addClass,removeClass,hasClass,getOuterHTML,setOuterHTML,remove,show,hide,isHidden,setHTML,get").split(/,/),function(g){b[g]=function(){var h=[f],j;for(j=0;j<arguments.length;j++){h.push(arguments[j])}h=e[g].apply(e,h);b.update(g);return h}});a.extend(b,{on:function(i,h,g){return a.dom.Event.add(b.id,i,h,g)},getXY:function(){return{x:parseInt(b.getStyle("left")),y:parseInt(b.getStyle("top"))}},getSize:function(){var g=e.get(b.id);return{w:parseInt(b.getStyle("width")||g.clientWidth),h:parseInt(b.getStyle("height")||g.clientHeight)}},moveTo:function(g,h){b.setStyles({left:g,top:h})},moveBy:function(g,i){var h=b.getXY();b.moveTo(h.x+g,h.y+i)},resizeTo:function(g,i){b.setStyles({width:g,height:i})},resizeBy:function(g,j){var i=b.getSize();b.resizeTo(i.w+g,i.h+j)},update:function(h){var g;if(a.isIE6&&d.blocker){h=h||"";if(h.indexOf("get")===0||h.indexOf("has")===0||h.indexOf("is")===0){return}if(h=="remove"){e.remove(b.blocker);return}if(!b.blocker){b.blocker=e.uniqueId();g=e.add(d.container||e.getRoot(),"iframe",{id:b.blocker,style:"position:absolute;",frameBorder:0,src:'javascript:""'});e.setStyle(g,"opacity",0)}else{g=e.get(b.blocker)}e.setStyles(g,{left:b.getStyle("left",1),top:b.getStyle("top",1),width:b.getStyle("width",1),height:b.getStyle("height",1),display:b.getStyle("display",1),zIndex:parseInt(b.getStyle("zIndex",1)||0)-1})}}})}})(tinymce);(function(c){function e(f){return f.replace(/[\n\r]+/g,"")}var b=c.is,a=c.isIE,d=c.each;c.create("tinymce.dom.Selection",{Selection:function(i,h,g){var f=this;f.dom=i;f.win=h;f.serializer=g;d(["onBeforeSetContent","onBeforeGetContent","onSetContent","onGetContent"],function(j){f[j]=new c.util.Dispatcher(f)});if(!f.win.getSelection){f.tridentSel=new c.dom.TridentSelection(f)}c.addUnload(f.destroy,f)},getContent:function(g){var f=this,h=f.getRng(),l=f.dom.create("body"),j=f.getSel(),i,k,m;g=g||{};i=k="";g.get=true;g.format=g.format||"html";f.onBeforeGetContent.dispatch(f,g);if(g.format=="text"){return f.isCollapsed()?"":(h.text||(j.toString?j.toString():""))}if(h.cloneContents){m=h.cloneContents();if(m){l.appendChild(m)}}else{if(b(h.item)||b(h.htmlText)){l.innerHTML=h.item?h.item(0).outerHTML:h.htmlText}else{l.innerHTML=h.toString()}}if(/^\s/.test(l.innerHTML)){i=" "}if(/\s+$/.test(l.innerHTML)){k=" "}g.getInner=true;g.content=f.isCollapsed()?"":i+f.serializer.serialize(l,g)+k;f.onGetContent.dispatch(f,g);return g.content},setContent:function(i,g){var f=this,j=f.getRng(),l,k=f.win.document;g=g||{format:"html"};g.set=true;i=g.content=f.dom.processHTML(i);f.onBeforeSetContent.dispatch(f,g);i=g.content;if(j.insertNode){i+='<span id="__caret">_</span>';if(j.startContainer==k&&j.endContainer==k){k.body.innerHTML=i}else{j.deleteContents();if(k.body.childNodes.length==0){k.body.innerHTML=i}else{j.insertNode(j.createContextualFragment(i))}}l=f.dom.get("__caret");j=k.createRange();j.setStartBefore(l);j.setEndBefore(l);f.setRng(j);f.dom.remove("__caret")}else{if(j.item){k.execCommand("Delete",false,null);j=f.getRng()}j.pasteHTML(i)}f.onSetContent.dispatch(f,g)},getStart:function(){var g=this.getRng(),h,f,j,i;if(g.duplicate||g.item){if(g.item){return g.item(0)}j=g.duplicate();j.collapse(1);h=j.parentElement();f=i=g.parentElement();while(i=i.parentNode){if(i==h){h=f;break}}if(h&&h.nodeName=="BODY"){return h.firstChild||h}return h}else{h=g.startContainer;if(h.nodeType==1&&h.hasChildNodes()){h=h.childNodes[Math.min(h.childNodes.length-1,g.startOffset)]}if(h&&h.nodeType==3){return h.parentNode}return h}},getEnd:function(){var g=this,h=g.getRng(),i,f;if(h.duplicate||h.item){if(h.item){return h.item(0)}h=h.duplicate();h.collapse(0);i=h.parentElement();if(i&&i.nodeName=="BODY"){return i.lastChild||i}return i}else{i=h.endContainer;f=h.endOffset;if(i.nodeType==1&&i.hasChildNodes()){i=i.childNodes[f>0?f-1:f]}if(i&&i.nodeType==3){return i.parentNode}return i}},getBookmark:function(q,r){var u=this,m=u.dom,g,j,i,n,h,o,p,l="\uFEFF",s;function f(v,x){var t=0;d(m.select(v),function(z,y){if(z==x){t=y}});return t}if(q==2){function k(){var v=u.getRng(true),t=m.getRoot(),x={};function y(B,G){var A=B[G?"startContainer":"endContainer"],F=B[G?"startOffset":"endOffset"],z=[],C,E,D=0;if(A.nodeType==3){if(r){for(C=A.previousSibling;C&&C.nodeType==3;C=C.previousSibling){F+=C.nodeValue.length}}z.push(F)}else{E=A.childNodes;if(F>=E.length&&E.length){D=1;F=Math.max(0,E.length-1)}z.push(u.dom.nodeIndex(E[F],r)+D)}for(;A&&A!=t;A=A.parentNode){z.push(u.dom.nodeIndex(A,r))}return z}x.start=y(v,true);if(!u.isCollapsed()){x.end=y(v)}return x}return k()}if(q){return{rng:u.getRng()}}g=u.getRng();i=m.uniqueId();n=tinyMCE.activeEditor.selection.isCollapsed();s="overflow:hidden;line-height:0px";if(g.duplicate||g.item){if(!g.item){j=g.duplicate();g.collapse();g.pasteHTML('<span _mce_type="bookmark" id="'+i+'_start" style="'+s+'">'+l+"</span>");if(!n){j.collapse(false);j.pasteHTML('<span _mce_type="bookmark" id="'+i+'_end" style="'+s+'">'+l+"</span>")}}else{o=g.item(0);h=o.nodeName;return{name:h,index:f(h,o)}}}else{o=u.getNode();h=o.nodeName;if(h=="IMG"&&g.toString()==""){return{name:h,index:f(h,o)}}j=g.cloneRange();if(!n){j.collapse(false);j.insertNode(m.create("span",{_mce_type:"bookmark",id:i+"_end",style:s},l))}g.collapse(true);g.insertNode(m.create("span",{_mce_type:"bookmark",id:i+"_start",style:s},l))}u.moveToBookmark({id:i,keep:1});return{id:i}},moveToBookmark:function(o){var s=this,l=s.dom,i,h,f,r,j,u,p,q;try{if(s.tridentSel){s.tridentSel.destroy()}if(o){if(o.start){f=l.createRng();r=l.getRoot();function g(A){var t=o[A?"start":"end"],x,y,z,v;if(t){for(y=r,x=t.length-1;x>=1;x--){v=y.childNodes;if(v.length){y=v[Math.min(t[x],v.length-1)]}}if(A){f.setStart(y,t[0])}else{f.setEnd(y,t[0])}}}g(true);g();s.setRng(f)}else{if(o.id){function k(B){var v=l.get(o.id+"_"+B),A,t,y,z,x=o.keep;if(v){A=v.parentNode;if(B=="start"){if(!x){t=l.nodeIndex(v)}else{A=v.firstChild;t=1}j=u=A;p=q=t}else{if(!x){t=l.nodeIndex(v)}else{A=v.firstChild;t=1}u=A;q=t}if(!x){z=v.previousSibling;y=v.nextSibling;d(c.grep(v.childNodes),function(C){if(C.nodeType==3){C.nodeValue=C.nodeValue.replace(/\uFEFF/g,"")}});while(v=l.get(o.id+"_"+B)){l.remove(v,1)}if(z&&y&&z.nodeType==y.nodeType&&z.nodeType==3){t=z.nodeValue.length;z.appendData(y.nodeValue);l.remove(y);if(B=="start"){j=u=z;p=q=t}else{u=z;q=t}}}}}function m(t){if(!a&&l.isBlock(t)&&!t.innerHTML){t.innerHTML='<br _mce_bogus="1" />'}return t}k("start");k("end");f=l.createRng();f.setStart(m(j),p);f.setEnd(m(u),q);s.setRng(f)}else{if(o.name){s.select(l.select(o.name)[o.index])}else{if(o.rng){s.setRng(o.rng)}}}}}}catch(n){}},select:function(k,j){var i=this,l=i.dom,g=l.createRng(),f;f=l.nodeIndex(k);g.setStart(k.parentNode,f);g.setEnd(k.parentNode,f+1);if(j){function h(m,o){var n=new c.dom.TreeWalker(m,m);do{if(m.nodeType==3&&c.trim(m.nodeValue).length!=0){if(o){g.setStart(m,0)}else{g.setEnd(m,m.nodeValue.length)}return}if(m.nodeName=="BR"){if(o){g.setStartBefore(m)}else{g.setEndBefore(m)}return}}while(m=(o?n.next():n.prev()))}h(k,1);h(k)}i.setRng(g);return k},isCollapsed:function(){var f=this,h=f.getRng(),g=f.getSel();if(!h||h.item){return false}if(h.compareEndPoints){return h.compareEndPoints("StartToEnd",h)===0}return !g||h.collapsed},collapse:function(f){var g=this,h=g.getRng(),i;if(h.item){i=h.item(0);h=this.win.document.body.createTextRange();h.moveToElementText(i)}h.collapse(!!f);g.setRng(h)},getSel:function(){var g=this,f=this.win;return f.getSelection?f.getSelection():f.document.selection},getRng:function(j){var g=this,h,i;if(j&&g.tridentSel){return g.tridentSel.getRangeAt(0)}try{if(h=g.getSel()){i=h.rangeCount>0?h.getRangeAt(0):(h.createRange?h.createRange():g.win.document.createRange())}}catch(f){}if(!i){i=g.win.document.createRange?g.win.document.createRange():g.win.document.body.createTextRange()}if(g.selectedRange&&g.explicitRange){if(i.compareBoundaryPoints(i.START_TO_START,g.selectedRange)===0&&i.compareBoundaryPoints(i.END_TO_END,g.selectedRange)===0){i=g.explicitRange}else{g.selectedRange=null;g.explicitRange=null}}return i},setRng:function(i){var h,g=this;if(!g.tridentSel){h=g.getSel();if(h){g.explicitRange=i;h.removeAllRanges();h.addRange(i);g.selectedRange=h.getRangeAt(0)}}else{if(i.cloneRange){g.tridentSel.addRange(i);return}try{i.select()}catch(f){}}},setNode:function(g){var f=this;f.setContent(f.dom.getOuterHTML(g));return g},getNode:function(){var g=this,f=g.getRng(),h=g.getSel(),i;if(f.setStart){if(!f){return g.dom.getRoot()}i=f.commonAncestorContainer;if(!f.collapsed){if(f.startContainer==f.endContainer){if(f.startOffset-f.endOffset<2){if(f.startContainer.hasChildNodes()){i=f.startContainer.childNodes[f.startOffset]}}}if(c.isWebKit&&h.anchorNode&&h.anchorNode.nodeType==1){return h.anchorNode.childNodes[h.anchorOffset]}}if(i&&i.nodeType==3){return i.parentNode}return i}return f.item?f.item(0):f.parentElement()},getSelectedBlocks:function(g,f){var i=this,j=i.dom,m,h,l,k=[];m=j.getParent(g||i.getStart(),j.isBlock);h=j.getParent(f||i.getEnd(),j.isBlock);if(m){k.push(m)}if(m&&h&&m!=h){l=m;while((l=l.nextSibling)&&l!=h){if(j.isBlock(l)){k.push(l)}}}if(h&&m!=h){k.push(h)}return k},destroy:function(g){var f=this;f.win=null;if(f.tridentSel){f.tridentSel.destroy()}if(!g){c.removeUnload(f.destroy)}}})})(tinymce);(function(a){a.create("tinymce.dom.XMLWriter",{node:null,XMLWriter:function(c){function b(){var e=document.implementation;if(!e||!e.createDocument){try{return new ActiveXObject("MSXML2.DOMDocument")}catch(d){}try{return new ActiveXObject("Microsoft.XmlDom")}catch(d){}}else{return e.createDocument("","",null)}}this.doc=b();this.valid=a.isOpera||a.isWebKit;this.reset()},reset:function(){var b=this,c=b.doc;if(c.firstChild){c.removeChild(c.firstChild)}b.node=c.appendChild(c.createElement("html"))},writeStartElement:function(c){var b=this;b.node=b.node.appendChild(b.doc.createElement(c))},writeAttribute:function(c,b){if(this.valid){b=b.replace(/>/g,"%MCGT%")}this.node.setAttribute(c,b)},writeEndElement:function(){this.node=this.node.parentNode},writeFullEndElement:function(){var b=this,c=b.node;c.appendChild(b.doc.createTextNode(""));b.node=c.parentNode},writeText:function(b){if(this.valid){b=b.replace(/>/g,"%MCGT%")}this.node.appendChild(this.doc.createTextNode(b))},writeCDATA:function(b){this.node.appendChild(this.doc.createCDATASection(b))},writeComment:function(b){if(a.isIE){b=b.replace(/^\-|\-$/g," ")}this.node.appendChild(this.doc.createComment(b.replace(/\-\-/g," ")))},getContent:function(){var b;b=this.doc.xml||new XMLSerializer().serializeToString(this.doc);b=b.replace(/<\?[^?]+\?>|<html>|<\/html>|<html\/>|<!DOCTYPE[^>]+>/g,"");b=b.replace(/ ?\/>/g," />");if(this.valid){b=b.replace(/\%MCGT%/g,"&gt;")}return b}})})(tinymce);(function(a){a.create("tinymce.dom.StringWriter",{str:null,tags:null,count:0,settings:null,indent:null,StringWriter:function(b){this.settings=a.extend({indent_char:" ",indentation:0},b);this.reset()},reset:function(){this.indent="";this.str="";this.tags=[];this.count=0},writeStartElement:function(b){this._writeAttributesEnd();this.writeRaw("<"+b);this.tags.push(b);this.inAttr=true;this.count++;this.elementCount=this.count},writeAttribute:function(d,b){var c=this;c.writeRaw(" "+c.encode(d)+'="'+c.encode(b)+'"')},writeEndElement:function(){var b;if(this.tags.length>0){b=this.tags.pop();if(this._writeAttributesEnd(1)){this.writeRaw("</"+b+">")}if(this.settings.indentation>0){this.writeRaw("\n")}}},writeFullEndElement:function(){if(this.tags.length>0){this._writeAttributesEnd();this.writeRaw("</"+this.tags.pop()+">");if(this.settings.indentation>0){this.writeRaw("\n")}}},writeText:function(b){this._writeAttributesEnd();this.writeRaw(this.encode(b));this.count++},writeCDATA:function(b){this._writeAttributesEnd();this.writeRaw("<![CDATA["+b+"]]>");this.count++},writeComment:function(b){this._writeAttributesEnd();this.writeRaw("<!-- "+b+"-->");this.count++},writeRaw:function(b){this.str+=b},encode:function(b){return b.replace(/[<>&"]/g,function(c){switch(c){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case'"':return"&quot;"}return c})},getContent:function(){return this.str},_writeAttributesEnd:function(b){if(!this.inAttr){return}this.inAttr=false;if(b&&this.elementCount==this.count){this.writeRaw(" />");return false}this.writeRaw(">");return true}})})(tinymce);(function(e){var g=e.extend,f=e.each,b=e.util.Dispatcher,d=e.isIE,a=e.isGecko;function c(h){return h.replace(/([?+*])/g,".$1")}e.create("tinymce.dom.Serializer",{Serializer:function(j){var i=this;i.key=0;i.onPreProcess=new b(i);i.onPostProcess=new b(i);try{i.writer=new e.dom.XMLWriter()}catch(h){i.writer=new e.dom.StringWriter()}i.settings=j=g({dom:e.DOM,valid_nodes:0,node_filter:0,attr_filter:0,invalid_attrs:/^(_mce_|_moz_|sizset|sizcache)/,closed:/^(br|hr|input|meta|img|link|param|area)$/,entity_encoding:"named",entities:"160,nbsp,161,iexcl,162,cent,163,pound,164,curren,165,yen,166,brvbar,167,sect,168,uml,169,copy,170,ordf,171,laquo,172,not,173,shy,174,reg,175,macr,176,deg,177,plusmn,178,sup2,179,sup3,180,acute,181,micro,182,para,183,middot,184,cedil,185,sup1,186,ordm,187,raquo,188,frac14,189,frac12,190,frac34,191,iquest,192,Agrave,193,Aacute,194,Acirc,195,Atilde,196,Auml,197,Aring,198,AElig,199,Ccedil,200,Egrave,201,Eacute,202,Ecirc,203,Euml,204,Igrave,205,Iacute,206,Icirc,207,Iuml,208,ETH,209,Ntilde,210,Ograve,211,Oacute,212,Ocirc,213,Otilde,214,Ouml,215,times,216,Oslash,217,Ugrave,218,Uacute,219,Ucirc,220,Uuml,221,Yacute,222,THORN,223,szlig,224,agrave,225,aacute,226,acirc,227,atilde,228,auml,229,aring,230,aelig,231,ccedil,232,egrave,233,eacute,234,ecirc,235,euml,236,igrave,237,iacute,238,icirc,239,iuml,240,eth,241,ntilde,242,ograve,243,oacute,244,ocirc,245,otilde,246,ouml,247,divide,248,oslash,249,ugrave,250,uacute,251,ucirc,252,uuml,253,yacute,254,thorn,255,yuml,402,fnof,913,Alpha,914,Beta,915,Gamma,916,Delta,917,Epsilon,918,Zeta,919,Eta,920,Theta,921,Iota,922,Kappa,923,Lambda,924,Mu,925,Nu,926,Xi,927,Omicron,928,Pi,929,Rho,931,Sigma,932,Tau,933,Upsilon,934,Phi,935,Chi,936,Psi,937,Omega,945,alpha,946,beta,947,gamma,948,delta,949,epsilon,950,zeta,951,eta,952,theta,953,iota,954,kappa,955,lambda,956,mu,957,nu,958,xi,959,omicron,960,pi,961,rho,962,sigmaf,963,sigma,964,tau,965,upsilon,966,phi,967,chi,968,psi,969,omega,977,thetasym,978,upsih,982,piv,8226,bull,8230,hellip,8242,prime,8243,Prime,8254,oline,8260,frasl,8472,weierp,8465,image,8476,real,8482,trade,8501,alefsym,8592,larr,8593,uarr,8594,rarr,8595,darr,8596,harr,8629,crarr,8656,lArr,8657,uArr,8658,rArr,8659,dArr,8660,hArr,8704,forall,8706,part,8707,exist,8709,empty,8711,nabla,8712,isin,8713,notin,8715,ni,8719,prod,8721,sum,8722,minus,8727,lowast,8730,radic,8733,prop,8734,infin,8736,ang,8743,and,8744,or,8745,cap,8746,cup,8747,int,8756,there4,8764,sim,8773,cong,8776,asymp,8800,ne,8801,equiv,8804,le,8805,ge,8834,sub,8835,sup,8836,nsub,8838,sube,8839,supe,8853,oplus,8855,otimes,8869,perp,8901,sdot,8968,lceil,8969,rceil,8970,lfloor,8971,rfloor,9001,lang,9002,rang,9674,loz,9824,spades,9827,clubs,9829,hearts,9830,diams,338,OElig,339,oelig,352,Scaron,353,scaron,376,Yuml,710,circ,732,tilde,8194,ensp,8195,emsp,8201,thinsp,8204,zwnj,8205,zwj,8206,lrm,8207,rlm,8211,ndash,8212,mdash,8216,lsquo,8217,rsquo,8218,sbquo,8220,ldquo,8221,rdquo,8222,bdquo,8224,dagger,8225,Dagger,8240,permil,8249,lsaquo,8250,rsaquo,8364,euro",bool_attrs:/(checked|disabled|readonly|selected|nowrap)/,valid_elements:"*[*]",extended_valid_elements:0,valid_child_elements:0,invalid_elements:0,fix_table_elements:1,fix_list_elements:true,fix_content_duplication:true,convert_fonts_to_spans:false,font_size_classes:0,font_size_style_values:0,apply_source_formatting:0,indent_mode:"simple",indent_char:"\t",indent_levels:1,remove_linebreaks:1,remove_redundant_brs:1,element_format:"xhtml"},j);i.dom=j.dom;i.schema=j.schema;if(j.entity_encoding=="named"&&!j.entities){j.entity_encoding="raw"}if(j.remove_redundant_brs){i.onPostProcess.add(function(k,l){l.content=l.content.replace(/(<br \/>\s*)+<\/(p|h[1-6]|div|li)>/gi,function(n,m,o){if(/^<br \/>\s*<\//.test(n)){return"</"+o+">"}return n})})}if(j.element_format=="html"){i.onPostProcess.add(function(k,l){l.content=l.content.replace(/<([^>]+) \/>/g,"<$1>")})}if(j.fix_list_elements){i.onPreProcess.add(function(v,s){var l,z,y=["ol","ul"],u,t,q,k=/^(OL|UL)$/,A;function m(r,x){var o=x.split(","),p;while((r=r.previousSibling)!=null){for(p=0;p<o.length;p++){if(r.nodeName==o[p]){return r}}}return null}for(z=0;z<y.length;z++){l=i.dom.select(y[z],s.node);for(u=0;u<l.length;u++){t=l[u];q=t.parentNode;if(k.test(q.nodeName)){A=m(t,"LI");if(!A){A=i.dom.create("li");A.innerHTML="&nbsp;";A.appendChild(t);q.insertBefore(A,q.firstChild)}else{A.appendChild(t)}}}}})}if(j.fix_table_elements){i.onPreProcess.add(function(k,l){if(!e.isOpera||opera.buildNumber()>=1767){f(i.dom.select("p table",l.node).reverse(),function(p){var o=i.dom.getParent(p.parentNode,"table,p");if(o.nodeName!="TABLE"){try{i.dom.split(o,p)}catch(m){}}})}})}},setEntities:function(o){var n=this,j,m,h={},k;if(n.entityLookup){return}j=o.split(",");for(m=0;m<j.length;m+=2){k=j[m];if(k==34||k==38||k==60||k==62){continue}h[String.fromCharCode(j[m])]=j[m+1];k=parseInt(j[m]).toString(16)}n.entityLookup=h},setRules:function(i){var h=this;h._setup();h.rules={};h.wildRules=[];h.validElements={};return h.addRules(i)},addRules:function(i){var h=this,j;if(!i){return}h._setup();f(i.split(","),function(m){var q=m.split(/\[|\]/),l=q[0].split("/"),r,k,o,n=[];if(j){k=e.extend([],j.attribs)}if(q.length>1){f(q[1].split("|"),function(u){var p={},t;k=k||[];u=u.replace(/::/g,"~");u=/^([!\-])?([\w*.?~_\-]+|)([=:<])?(.+)?$/.exec(u);u[2]=u[2].replace(/~/g,":");if(u[1]=="!"){r=r||[];r.push(u[2])}if(u[1]=="-"){for(t=0;t<k.length;t++){if(k[t].name==u[2]){k.splice(t,1);return}}}switch(u[3]){case"=":p.defaultVal=u[4]||"";break;case":":p.forcedVal=u[4];break;case"<":p.validVals=u[4].split("?");break}if(/[*.?]/.test(u[2])){o=o||[];p.nameRE=new RegExp("^"+c(u[2])+"$");o.push(p)}else{p.name=u[2];k.push(p)}n.push(u[2])})}f(l,function(v,u){var y=v.charAt(0),t=1,p={};if(j){if(j.noEmpty){p.noEmpty=j.noEmpty}if(j.fullEnd){p.fullEnd=j.fullEnd}if(j.padd){p.padd=j.padd}}switch(y){case"-":p.noEmpty=true;break;case"+":p.fullEnd=true;break;case"#":p.padd=true;break;default:t=0}l[u]=v=v.substring(t);h.validElements[v]=1;if(/[*.?]/.test(l[0])){p.nameRE=new RegExp("^"+c(l[0])+"$");h.wildRules=h.wildRules||{};h.wildRules.push(p)}else{p.name=l[0];if(l[0]=="@"){j=p}h.rules[v]=p}p.attribs=k;if(r){p.requiredAttribs=r}if(o){v="";f(n,function(s){if(v){v+="|"}v+="("+c(s)+")"});p.validAttribsRE=new RegExp("^"+v.toLowerCase()+"$");p.wildAttribs=o}})});i="";f(h.validElements,function(m,l){if(i){i+="|"}if(l!="@"){i+=l}});h.validElementsRE=new RegExp("^("+c(i.toLowerCase())+")$")},findRule:function(m){var j=this,l=j.rules,h,k;j._setup();k=l[m];if(k){return k}l=j.wildRules;for(h=0;h<l.length;h++){if(l[h].nameRE.test(m)){return l[h]}}return null},findAttribRule:function(h,l){var j,k=h.wildAttribs;for(j=0;j<k.length;j++){if(k[j].nameRE.test(l)){return k[j]}}return null},serialize:function(r,q){var m,k=this,p,i,j,l;k._setup();q=q||{};q.format=q.format||"html";k.processObj=q;if(d){l=[];f(r.getElementsByTagName("option"),function(o){var h=k.dom.getAttrib(o,"selected");l.push(h?h:null)})}r=r.cloneNode(true);if(d){f(r.getElementsByTagName("option"),function(o,h){k.dom.setAttrib(o,"selected",l[h])})}j=r.ownerDocument.implementation;if(j.createHTMLDocument&&(e.isOpera&&opera.buildNumber()>=1767)){p=j.createHTMLDocument("");f(r.nodeName=="BODY"?r.childNodes:[r],function(h){p.body.appendChild(p.importNode(h,true))});if(r.nodeName!="BODY"){r=p.body.firstChild}else{r=p.body}i=k.dom.doc;k.dom.doc=p}k.key=""+(parseInt(k.key)+1);if(!q.no_events){q.node=r;k.onPreProcess.dispatch(k,q)}k.writer.reset();k._info=q;k._serializeNode(r,q.getInner);q.content=k.writer.getContent();if(i){k.dom.doc=i}if(!q.no_events){k.onPostProcess.dispatch(k,q)}k._postProcess(q);q.node=null;return e.trim(q.content)},_postProcess:function(n){var i=this,k=i.settings,j=n.content,m=[],l;if(n.format=="html"){l=i._protect({content:j,patterns:[{pattern:/(<script[^>]*>)(.*?)(<\/script>)/g},{pattern:/(<noscript[^>]*>)(.*?)(<\/noscript>)/g},{pattern:/(<style[^>]*>)(.*?)(<\/style>)/g},{pattern:/(<pre[^>]*>)(.*?)(<\/pre>)/g,encode:1},{pattern:/(<!--\[CDATA\[)(.*?)(\]\]-->)/g}]});j=l.content;if(k.entity_encoding!=="raw"){j=i._encode(j)}if(!n.set){j=j.replace(/<p>\s+<\/p>|<p([^>]+)>\s+<\/p>/g,k.entity_encoding=="numeric"?"<p$1>&#160;</p>":"<p$1>&nbsp;</p>");if(k.remove_linebreaks){j=j.replace(/\r?\n|\r/g," ");j=j.replace(/(<[^>]+>)\s+/g,"$1 ");j=j.replace(/\s+(<\/[^>]+>)/g," $1");j=j.replace(/<(p|h[1-6]|blockquote|hr|div|table|tbody|tr|td|body|head|html|title|meta|style|pre|script|link|object) ([^>]+)>\s+/g,"<$1 $2>")}if(k.apply_source_formatting&&k.indent_mode=="simple"){j=j.replace(/<(\/?)(ul|hr|table|meta|link|tbody|tr|object|body|head|html|map)(|[^>]+)>\s*/g,"\n<$1$2$3>\n");j=j.replace(/\s*<(p|h[1-6]|blockquote|div|title|style|pre|script|td|li|area)(|[^>]+)>/g,"\n<$1$2>");j=j.replace(/<\/(p|h[1-6]|blockquote|div|title|style|pre|script|td|li)>\s*/g,"</$1>\n");j=j.replace(/\n\n/g,"\n")}}j=i._unprotect(j,l);j=j.replace(/<!--\[CDATA\[([\s\S]+)\]\]-->/g,"<![CDATA[$1]]>");if(k.entity_encoding=="raw"){j=j.replace(/<p>&nbsp;<\/p>|<p([^>]+)>&nbsp;<\/p>/g,"<p$1>\u00a0</p>")}j=j.replace(/<noscript([^>]+|)>([\s\S]*?)<\/noscript>/g,function(h,p,o){return"<noscript"+p+">"+i.dom.decode(o.replace(/<!--|-->/g,""))+"</noscript>"})}n.content=j},_serializeNode:function(E,J){var A=this,B=A.settings,y=A.writer,q,j,u,G,F,I,C,h,z,k,r,D,p,m,H,o,x;if(!B.node_filter||B.node_filter(E)){switch(E.nodeType){case 1:if(E.hasAttribute?E.hasAttribute("_mce_bogus"):E.getAttribute("_mce_bogus")){return}p=H=false;q=E.hasChildNodes();k=E.getAttribute("_mce_name")||E.nodeName.toLowerCase();o=E.getAttribute("_mce_type");if(o){if(!A._info.cleanup){p=true;return}else{H=1}}if(d){x=E.scopeName;if(x&&x!=="HTML"&&x!=="html"){k=x+":"+k}}if(k.indexOf("mce:")===0){k=k.substring(4)}if(!H){if(!A.validElementsRE||!A.validElementsRE.test(k)||(A.invalidElementsRE&&A.invalidElementsRE.test(k))||J){p=true;break}}if(d){if(B.fix_content_duplication){if(E._mce_serialized==A.key){return}E._mce_serialized=A.key}if(k.charAt(0)=="/"){k=k.substring(1)}}else{if(a){if(E.nodeName==="BR"&&E.getAttribute("type")=="_moz"){return}}}if(B.validate_children){if(A.elementName&&!A.schema.isValid(A.elementName,k)){p=true;break}A.elementName=k}r=A.findRule(k);if(!r){p=true;break}k=r.name||k;m=B.closed.test(k);if((!q&&r.noEmpty)||(d&&!k)){p=true;break}if(r.requiredAttribs){I=r.requiredAttribs;for(G=I.length-1;G>=0;G--){if(this.dom.getAttrib(E,I[G])!==""){break}}if(G==-1){p=true;break}}y.writeStartElement(k);if(r.attribs){for(G=0,C=r.attribs,F=C.length;G<F;G++){I=C[G];z=A._getAttrib(E,I);if(z!==null){y.writeAttribute(I.name,z)}}}if(r.validAttribsRE){C=A.dom.getAttribs(E);for(G=C.length-1;G>-1;G--){h=C[G];if(h.specified){I=h.nodeName.toLowerCase();if(B.invalid_attrs.test(I)||!r.validAttribsRE.test(I)){continue}D=A.findAttribRule(r,I);z=A._getAttrib(E,D,I);if(z!==null){y.writeAttribute(I,z)}}}}if(o&&H){y.writeAttribute("_mce_type",o)}if(k==="script"&&e.trim(E.innerHTML)){y.writeText("// ");y.writeCDATA(E.innerHTML.replace(/<!--|-->|<\[CDATA\[|\]\]>/g,""));q=false;break}if(r.padd){if(q&&(u=E.firstChild)&&u.nodeType===1&&E.childNodes.length===1){if(u.hasAttribute?u.hasAttribute("_mce_bogus"):u.getAttribute("_mce_bogus")){y.writeText("\u00a0")}}else{if(!q){y.writeText("\u00a0")}}}break;case 3:if(B.validate_children&&A.elementName&&!A.schema.isValid(A.elementName,"#text")){return}return y.writeText(E.nodeValue);case 4:return y.writeCDATA(E.nodeValue);case 8:return y.writeComment(E.nodeValue)}}else{if(E.nodeType==1){q=E.hasChildNodes()}}if(q&&!m){u=E.firstChild;while(u){A._serializeNode(u);A.elementName=k;u=u.nextSibling}}if(!p){if(!m){y.writeFullEndElement()}else{y.writeEndElement()}}},_protect:function(j){var i=this;j.items=j.items||[];function h(l){return l.replace(/[\r\n\\]/g,function(m){if(m==="\n"){return"\\n"}else{if(m==="\\"){return"\\\\"}}return"\\r"})}function k(l){return l.replace(/\\[\\rn]/g,function(m){if(m==="\\n"){return"\n"}else{if(m==="\\\\"){return"\\"}}return"\r"})}f(j.patterns,function(l){j.content=k(h(j.content).replace(l.pattern,function(n,o,m,p){m=k(m);if(l.encode){m=i._encode(m)}j.items.push(m);return o+"<!--mce:"+(j.items.length-1)+"-->"+p}))});return j},_unprotect:function(i,j){i=i.replace(/\<!--mce:([0-9]+)--\>/g,function(k,h){return j.items[parseInt(h)]});j.items=[];return i},_encode:function(m){var j=this,k=j.settings,i;if(k.entity_encoding!=="raw"){if(k.entity_encoding.indexOf("named")!=-1){j.setEntities(k.entities);i=j.entityLookup;m=m.replace(/[\u007E-\uFFFF]/g,function(h){var l;if(l=i[h]){h="&"+l+";"}return h})}if(k.entity_encoding.indexOf("numeric")!=-1){m=m.replace(/[\u007E-\uFFFF]/g,function(h){return"&#"+h.charCodeAt(0)+";"})}}return m},_setup:function(){var h=this,i=this.settings;if(h.done){return}h.done=1;h.setRules(i.valid_elements);h.addRules(i.extended_valid_elements);if(i.invalid_elements){h.invalidElementsRE=new RegExp("^("+c(i.invalid_elements.replace(/,/g,"|").toLowerCase())+")$")}if(i.attrib_value_filter){h.attribValueFilter=i.attribValueFilter}},_getAttrib:function(m,j,h){var l,k;if(!j){return null}h=h||j.name;if(j.forcedVal&&(k=j.forcedVal)){if(k==="{$uid}"){return this.dom.uniqueId()}return k}k=this.dom.getAttrib(m,h);switch(h){case"rowspan":case"colspan":if(k=="1"){k=""}break}if(this.attribValueFilter){k=this.attribValueFilter(h,k,m)}if(j.validVals){for(l=j.validVals.length-1;l>=0;l--){if(k==j.validVals[l]){break}}if(l==-1){return null}}if(k===""&&typeof(j.defaultVal)!="undefined"){k=j.defaultVal;if(k==="{$uid}"){return this.dom.uniqueId()}return k}else{if(h=="class"&&this.processObj.get){k=k.replace(/\s?mceItem\w+\s?/g,"")}}if(k===""){return null}return k}})})(tinymce);(function(a){a.dom.ScriptLoader=function(h){var c=0,k=1,i=2,l={},j=[],f={},d=[],g=0,e;function b(m,u){var v=this,q=a.DOM,s,o,r,n;function p(){q.remove(n);if(s){s.onreadystatechange=s.onload=s=null}u()}n=q.uniqueId();if(a.isIE6){o=new a.util.URI(m);r=location;if(o.host==r.hostname&&o.port==r.port&&(o.protocol+":")==r.protocol){a.util.XHR.send({url:a._addVer(o.getURI()),success:function(x){var t=q.create("script",{type:"text/javascript"});t.text=x;document.getElementsByTagName("head")[0].appendChild(t);q.remove(t);p()}});return}}s=q.create("script",{id:n,type:"text/javascript",src:a._addVer(m)});s.onload=p;s.onreadystatechange=function(){var t=s.readyState;if(t=="complete"||t=="loaded"){p()}};(document.getElementsByTagName("head")[0]||document.body).appendChild(s)}this.isDone=function(m){return l[m]==i};this.markDone=function(m){l[m]=i};this.add=this.load=function(m,q,n){var o,p=l[m];if(p==e){j.push(m);l[m]=c}if(q){if(!f[m]){f[m]=[]}f[m].push({func:q,scope:n||this})}};this.loadQueue=function(n,m){this.loadScripts(j,n,m)};this.loadScripts=function(m,q,p){var o;function n(r){a.each(f[r],function(s){s.func.call(s.scope)});f[r]=e}d.push({func:q,scope:p||this});o=function(){var r=a.grep(m);m.length=0;a.each(r,function(s){if(l[s]==i){n(s);return}if(l[s]!=k){l[s]=k;g++;b(s,function(){l[s]=i;g--;n(s);o()})}});if(!g){a.each(d,function(s){s.func.call(s.scope)});d.length=0}};o()}};a.ScriptLoader=new a.dom.ScriptLoader()})(tinymce);tinymce.dom.TreeWalker=function(a,c){var b=a;function d(i,f,e,j){var h,g;if(i){if(!j&&i[f]){return i[f]}if(i!=c){h=i[e];if(h){return h}for(g=i.parentNode;g&&g!=c;g=g.parentNode){h=g[e];if(h){return h}}}}}this.current=function(){return b};this.next=function(e){return(b=d(b,"firstChild","nextSibling",e))};this.prev=function(e){return(b=d(b,"lastChild","lastSibling",e))}};(function(){var a={};function b(f,e){var d;function c(g){return g.replace(/[A-Z]+/g,function(h){return c(f[h])})}for(d in f){if(f.hasOwnProperty(d)){f[d]=c(f[d])}}c(e).replace(/#/g,"#text").replace(/(\w+)\[([^\]]+)\]/g,function(l,g,j){var h,k={};j=j.split(/\|/);for(h=j.length-1;h>=0;h--){k[j[h]]=1}a[g]=k})}b({Z:"#|H|K|N|O|P",Y:"#|X|form|R|Q",X:"p|T|div|U|W|isindex|fieldset|table",W:"pre|hr|blockquote|address|center|noframes",U:"ul|ol|dl|menu|dir",ZC:"#|p|Y|div|U|W|table|br|span|bdo|object|applet|img|map|K|N|Q",T:"h1|h2|h3|h4|h5|h6",ZB:"#|X|S|Q",S:"R|P",ZA:"#|a|G|J|M|O|P",R:"#|a|H|K|N|O",Q:"noscript|P",P:"ins|del|script",O:"input|select|textarea|label|button",N:"M|L",M:"em|strong|dfn|code|q|samp|kbd|var|cite|abbr|acronym",L:"sub|sup",K:"J|I",J:"tt|i|b|u|s|strike",I:"big|small|font|basefont",H:"G|F",G:"br|span|bdo",F:"object|applet|img|map|iframe"},"script[]style[]object[#|param|X|form|a|H|K|N|O|Q]param[]p[S]a[Z]br[]span[S]bdo[S]applet[#|param|X|form|a|H|K|N|O|Q]h1[S]img[]map[X|form|Q|area]h2[S]iframe[#|X|form|a|H|K|N|O|Q]h3[S]tt[S]i[S]b[S]u[S]s[S]strike[S]big[S]small[S]font[S]basefont[]em[S]strong[S]dfn[S]code[S]q[S]samp[S]kbd[S]var[S]cite[S]abbr[S]acronym[S]sub[S]sup[S]input[]select[optgroup|option]optgroup[option]option[]textarea[]label[S]button[#|p|T|div|U|W|table|G|object|applet|img|map|K|N|Q]h4[S]ins[#|X|form|a|H|K|N|O|Q]h5[S]del[#|X|form|a|H|K|N|O|Q]h6[S]div[#|X|form|a|H|K|N|O|Q]ul[li]li[#|X|form|a|H|K|N|O|Q]ol[li]dl[dt|dd]dt[S]dd[#|X|form|a|H|K|N|O|Q]menu[li]dir[li]pre[ZA]hr[]blockquote[#|X|form|a|H|K|N|O|Q]address[S|p]center[#|X|form|a|H|K|N|O|Q]noframes[#|X|form|a|H|K|N|O|Q]isindex[]fieldset[#|legend|X|form|a|H|K|N|O|Q]legend[S]table[caption|col|colgroup|thead|tfoot|tbody|tr]caption[S]col[]colgroup[col]thead[tr]tr[th|td]th[#|X|form|a|H|K|N|O|Q]form[#|X|a|H|K|N|O|Q]noscript[#|X|form|a|H|K|N|O|Q]td[#|X|form|a|H|K|N|O|Q]tfoot[tr]tbody[tr]area[]base[]body[#|X|form|a|H|K|N|O|Q]");tinymce.dom.Schema=function(){var c=this,d=a;c.isValid=function(f,e){var g=d[f];return !!(g&&(!e||g[e]))}}})();(function(a){a.dom.RangeUtils=function(c){var b="\uFEFF";this.walk=function(d,r){var h=d.startContainer,k=d.startOffset,s=d.endContainer,l=d.endOffset,i,f,n,g,q,p,e;e=c.select("td.mceSelected,th.mceSelected");if(e.length>0){a.each(e,function(t){r([t])});return}function o(v,u,t){var x=[];for(;v&&v!=t;v=v[u]){x.push(v)}return x}function m(u,t){do{if(u.parentNode==t){return u}u=u.parentNode}while(u)}function j(v,u,x){var t=x?"nextSibling":"previousSibling";for(g=v,q=g.parentNode;g&&g!=u;g=q){q=g.parentNode;p=o(g==v?g:g[t],t);if(p.length){if(!x){p.reverse()}r(p)}}}if(h.nodeType==1&&h.hasChildNodes()){h=h.childNodes[k]}if(s.nodeType==1&&s.hasChildNodes()){s=s.childNodes[Math.min(k==l?l:l-1,s.childNodes.length-1)]}i=c.findCommonAncestor(h,s);if(h==s){return r([h])}for(g=h;g;g=g.parentNode){if(g==s){return j(h,i,true)}if(g==i){break}}for(g=s;g;g=g.parentNode){if(g==h){return j(s,i)}if(g==i){break}}f=m(h,i)||h;n=m(s,i)||s;j(h,f,true);p=o(f==h?f:f.nextSibling,"nextSibling",n==s?n.nextSibling:n);if(p.length){r(p)}j(s,n)}};a.dom.RangeUtils.compareRanges=function(c,b){if(c&&b){if(c.item||c.duplicate){if(c.item&&b.item&&c.item(0)===b.item(0)){return true}if(c.isEqual&&b.isEqual&&b.isEqual(c)){return true}}else{return c.startContainer==b.startContainer&&c.startOffset==b.startOffset}}return false}})(tinymce);(function(c){var b=c.DOM,a=c.is;c.create("tinymce.ui.Control",{Control:function(e,d){this.id=e;this.settings=d=d||{};this.rendered=false;this.onRender=new c.util.Dispatcher(this);this.classPrefix="";this.scope=d.scope||this;this.disabled=0;this.active=0},setDisabled:function(d){var f;if(d!=this.disabled){f=b.get(this.id);if(f&&this.settings.unavailable_prefix){if(d){this.prevTitle=f.title;f.title=this.settings.unavailable_prefix+": "+f.title}else{f.title=this.prevTitle}}this.setState("Disabled",d);this.setState("Enabled",!d);this.disabled=d}},isDisabled:function(){return this.disabled},setActive:function(d){if(d!=this.active){this.setState("Active",d);this.active=d}},isActive:function(){return this.active},setState:function(f,d){var e=b.get(this.id);f=this.classPrefix+f;if(d){b.addClass(e,f)}else{b.removeClass(e,f)}},isRendered:function(){return this.rendered},renderHTML:function(){},renderTo:function(d){b.setHTML(d,this.renderHTML())},postRender:function(){var e=this,d;if(a(e.disabled)){d=e.disabled;e.disabled=-1;e.setDisabled(d)}if(a(e.active)){d=e.active;e.active=-1;e.setActive(d)}},remove:function(){b.remove(this.id);this.destroy()},destroy:function(){c.dom.Event.clear(this.id)}})})(tinymce);tinymce.create("tinymce.ui.Container:tinymce.ui.Control",{Container:function(b,a){this.parent(b,a);this.controls=[];this.lookup={}},add:function(a){this.lookup[a.id]=a;this.controls.push(a);return a},get:function(a){return this.lookup[a]}});tinymce.create("tinymce.ui.Separator:tinymce.ui.Control",{Separator:function(b,a){this.parent(b,a);this.classPrefix="mceSeparator"},renderHTML:function(){return tinymce.DOM.createHTML("span",{"class":this.classPrefix})}});(function(d){var c=d.is,b=d.DOM,e=d.each,a=d.walk;d.create("tinymce.ui.MenuItem:tinymce.ui.Control",{MenuItem:function(g,f){this.parent(g,f);this.classPrefix="mceMenuItem"},setSelected:function(f){this.setState("Selected",f);this.selected=f},isSelected:function(){return this.selected},postRender:function(){var f=this;f.parent();if(c(f.selected)){f.setSelected(f.selected)}}})})(tinymce);(function(d){var c=d.is,b=d.DOM,e=d.each,a=d.walk;d.create("tinymce.ui.Menu:tinymce.ui.MenuItem",{Menu:function(h,g){var f=this;f.parent(h,g);f.items={};f.collapsed=false;f.menuCount=0;f.onAddItem=new d.util.Dispatcher(this)},expand:function(g){var f=this;if(g){a(f,function(h){if(h.expand){h.expand()}},"items",f)}f.collapsed=false},collapse:function(g){var f=this;if(g){a(f,function(h){if(h.collapse){h.collapse()}},"items",f)}f.collapsed=true},isCollapsed:function(){return this.collapsed},add:function(f){if(!f.settings){f=new d.ui.MenuItem(f.id||b.uniqueId(),f)}this.onAddItem.dispatch(this,f);return this.items[f.id]=f},addSeparator:function(){return this.add({separator:true})},addMenu:function(f){if(!f.collapse){f=this.createMenu(f)}this.menuCount++;return this.add(f)},hasMenus:function(){return this.menuCount!==0},remove:function(f){delete this.items[f.id]},removeAll:function(){var f=this;a(f,function(g){if(g.removeAll){g.removeAll()}else{g.remove()}g.destroy()},"items",f);f.items={}},createMenu:function(g){var f=new d.ui.Menu(g.id||b.uniqueId(),g);f.onAddItem.add(this.onAddItem.dispatch,this.onAddItem);return f}})})(tinymce);(function(e){var d=e.is,c=e.DOM,f=e.each,a=e.dom.Event,b=e.dom.Element;e.create("tinymce.ui.DropMenu:tinymce.ui.Menu",{DropMenu:function(h,g){g=g||{};g.container=g.container||c.doc.body;g.offset_x=g.offset_x||0;g.offset_y=g.offset_y||0;g.vp_offset_x=g.vp_offset_x||0;g.vp_offset_y=g.vp_offset_y||0;if(d(g.icons)&&!g.icons){g["class"]+=" mceNoIcons"}this.parent(h,g);this.onShowMenu=new e.util.Dispatcher(this);this.onHideMenu=new e.util.Dispatcher(this);this.classPrefix="mceMenu"},createMenu:function(j){var h=this,i=h.settings,g;j.container=j.container||i.container;j.parent=h;j.constrain=j.constrain||i.constrain;j["class"]=j["class"]||i["class"];j.vp_offset_x=j.vp_offset_x||i.vp_offset_x;j.vp_offset_y=j.vp_offset_y||i.vp_offset_y;g=new e.ui.DropMenu(j.id||c.uniqueId(),j);g.onAddItem.add(h.onAddItem.dispatch,h.onAddItem);return g},update:function(){var i=this,j=i.settings,g=c.get("menu_"+i.id+"_tbl"),l=c.get("menu_"+i.id+"_co"),h,k;h=j.max_width?Math.min(g.clientWidth,j.max_width):g.clientWidth;k=j.max_height?Math.min(g.clientHeight,j.max_height):g.clientHeight;if(!c.boxModel){i.element.setStyles({width:h+2,height:k+2})}else{i.element.setStyles({width:h,height:k})}if(j.max_width){c.setStyle(l,"width",h)}if(j.max_height){c.setStyle(l,"height",k);if(g.clientHeight<j.max_height){c.setStyle(l,"overflow","hidden")}}},showMenu:function(p,n,r){var z=this,A=z.settings,o,g=c.getViewPort(),u,l,v,q,i=2,k,j,m=z.classPrefix;z.collapse(1);if(z.isMenuVisible){return}if(!z.rendered){o=c.add(z.settings.container,z.renderNode());f(z.items,function(h){h.postRender()});z.element=new b("menu_"+z.id,{blocker:1,container:A.container})}else{o=c.get("menu_"+z.id)}if(!e.isOpera){c.setStyles(o,{left:-65535,top:-65535})}c.show(o);z.update();p+=A.offset_x||0;n+=A.offset_y||0;g.w-=4;g.h-=4;if(A.constrain){u=o.clientWidth-i;l=o.clientHeight-i;v=g.x+g.w;q=g.y+g.h;if((p+A.vp_offset_x+u)>v){p=r?r-u:Math.max(0,(v-A.vp_offset_x)-u)}if((n+A.vp_offset_y+l)>q){n=Math.max(0,(q-A.vp_offset_y)-l)}}c.setStyles(o,{left:p,top:n});z.element.update();z.isMenuVisible=1;z.mouseClickFunc=a.add(o,"click",function(s){var h;s=s.target;if(s&&(s=c.getParent(s,"tr"))&&!c.hasClass(s,m+"ItemSub")){h=z.items[s.id];if(h.isDisabled()){return}k=z;while(k){if(k.hideMenu){k.hideMenu()}k=k.settings.parent}if(h.settings.onclick){h.settings.onclick(s)}return a.cancel(s)}});if(z.hasMenus()){z.mouseOverFunc=a.add(o,"mouseover",function(x){var h,t,s;x=x.target;if(x&&(x=c.getParent(x,"tr"))){h=z.items[x.id];if(z.lastMenu){z.lastMenu.collapse(1)}if(h.isDisabled()){return}if(x&&c.hasClass(x,m+"ItemSub")){t=c.getRect(x);h.showMenu((t.x+t.w-i),t.y-i,t.x);z.lastMenu=h;c.addClass(c.get(h.id).firstChild,m+"ItemActive")}}})}z.onShowMenu.dispatch(z);if(A.keyboard_focus){a.add(o,"keydown",z._keyHandler,z);c.select("a","menu_"+z.id)[0].focus();z._focusIdx=0}},hideMenu:function(j){var g=this,i=c.get("menu_"+g.id),h;if(!g.isMenuVisible){return}a.remove(i,"mouseover",g.mouseOverFunc);a.remove(i,"click",g.mouseClickFunc);a.remove(i,"keydown",g._keyHandler);c.hide(i);g.isMenuVisible=0;if(!j){g.collapse(1)}if(g.element){g.element.hide()}if(h=c.get(g.id)){c.removeClass(h.firstChild,g.classPrefix+"ItemActive")}g.onHideMenu.dispatch(g)},add:function(i){var g=this,h;i=g.parent(i);if(g.isRendered&&(h=c.get("menu_"+g.id))){g._add(c.select("tbody",h)[0],i)}return i},collapse:function(g){this.parent(g);this.hideMenu(1)},remove:function(g){c.remove(g.id);this.destroy();return this.parent(g)},destroy:function(){var g=this,h=c.get("menu_"+g.id);a.remove(h,"mouseover",g.mouseOverFunc);a.remove(h,"click",g.mouseClickFunc);if(g.element){g.element.remove()}c.remove(h)},renderNode:function(){var i=this,j=i.settings,l,h,k,g;g=c.create("div",{id:"menu_"+i.id,"class":j["class"],style:"position:absolute;left:0;top:0;z-index:200000"});k=c.add(g,"div",{id:"menu_"+i.id+"_co","class":i.classPrefix+(j["class"]?" "+j["class"]:"")});i.element=new b("menu_"+i.id,{blocker:1,container:j.container});if(j.menu_line){c.add(k,"span",{"class":i.classPrefix+"Line"})}l=c.add(k,"table",{id:"menu_"+i.id+"_tbl",border:0,cellPadding:0,cellSpacing:0});h=c.add(l,"tbody");f(i.items,function(m){i._add(h,m)});i.rendered=true;return g},_keyHandler:function(j){var i=this,h=j.keyCode;function g(m){var k=i._focusIdx+m,l=c.select("a","menu_"+i.id)[k];if(l){i._focusIdx=k;l.focus()}}switch(h){case 38:g(-1);return;case 40:g(1);return;case 13:return;case 27:return this.hideMenu()}},_add:function(j,h){var i,q=h.settings,p,l,k,m=this.classPrefix,g;if(q.separator){l=c.add(j,"tr",{id:h.id,"class":m+"ItemSeparator"});c.add(l,"td",{"class":m+"ItemSeparator"});if(i=l.previousSibling){c.addClass(i,"mceLast")}return}i=l=c.add(j,"tr",{id:h.id,"class":m+"Item "+m+"ItemEnabled"});i=k=c.add(i,"td");i=p=c.add(i,"a",{href:"javascript:;",onclick:"return false;",onmousedown:"return false;"});c.addClass(k,q["class"]);g=c.add(i,"span",{"class":"mceIcon"+(q.icon?" mce_"+q.icon:"")});if(q.icon_src){c.add(g,"img",{src:q.icon_src})}i=c.add(i,q.element||"span",{"class":"mceText",title:h.settings.title},h.settings.title);if(h.settings.style){c.setAttrib(i,"style",h.settings.style)}if(j.childNodes.length==1){c.addClass(l,"mceFirst")}if((i=l.previousSibling)&&c.hasClass(i,m+"ItemSeparator")){c.addClass(l,"mceFirst")}if(h.collapse){c.addClass(l,m+"ItemSub")}if(i=l.previousSibling){c.removeClass(i,"mceLast")}c.addClass(l,"mceLast")}})})(tinymce);(function(b){var a=b.DOM;b.create("tinymce.ui.Button:tinymce.ui.Control",{Button:function(d,c){this.parent(d,c);this.classPrefix="mceButton"},renderHTML:function(){var f=this.classPrefix,e=this.settings,d,c;c=a.encode(e.label||"");d='<a id="'+this.id+'" href="javascript:;" class="'+f+" "+f+"Enabled "+e["class"]+(c?" "+f+"Labeled":"")+'" onmousedown="return false;" onclick="return false;" title="'+a.encode(e.title)+'">';if(e.image){d+='<img class="mceIcon" src="'+e.image+'" />'+c+"</a>"}else{d+='<span class="mceIcon '+e["class"]+'"></span>'+(c?'<span class="'+f+'Label">'+c+"</span>":"")+"</a>"}return d},postRender:function(){var c=this,d=c.settings;b.dom.Event.add(c.id,"click",function(f){if(!c.isDisabled()){return d.onclick.call(d.scope,f)}})}})})(tinymce);(function(d){var c=d.DOM,b=d.dom.Event,e=d.each,a=d.util.Dispatcher;d.create("tinymce.ui.ListBox:tinymce.ui.Control",{ListBox:function(h,g){var f=this;f.parent(h,g);f.items=[];f.onChange=new a(f);f.onPostRender=new a(f);f.onAdd=new a(f);f.onRenderMenu=new d.util.Dispatcher(this);f.classPrefix="mceListBox"},select:function(h){var g=this,j,i;if(h==undefined){return g.selectByIndex(-1)}if(h&&h.call){i=h}else{i=function(f){return f==h}}if(h!=g.selectedValue){e(g.items,function(k,f){if(i(k.value)){j=1;g.selectByIndex(f);return false}});if(!j){g.selectByIndex(-1)}}},selectByIndex:function(f){var g=this,h,i;if(f!=g.selectedIndex){h=c.get(g.id+"_text");i=g.items[f];if(i){g.selectedValue=i.value;g.selectedIndex=f;c.setHTML(h,c.encode(i.title));c.removeClass(h,"mceTitle")}else{c.setHTML(h,c.encode(g.settings.title));c.addClass(h,"mceTitle");g.selectedValue=g.selectedIndex=null}h=0}},add:function(i,f,h){var g=this;h=h||{};h=d.extend(h,{title:i,value:f});g.items.push(h);g.onAdd.dispatch(g,h)},getLength:function(){return this.items.length},renderHTML:function(){var i="",f=this,g=f.settings,j=f.classPrefix;i='<table id="'+f.id+'" cellpadding="0" cellspacing="0" class="'+j+" "+j+"Enabled"+(g["class"]?(" "+g["class"]):"")+'"><tbody><tr>';i+="<td>"+c.createHTML("a",{id:f.id+"_text",href:"javascript:;","class":"mceText",onclick:"return false;",onmousedown:"return false;"},c.encode(f.settings.title))+"</td>";i+="<td>"+c.createHTML("a",{id:f.id+"_open",tabindex:-1,href:"javascript:;","class":"mceOpen",onclick:"return false;",onmousedown:"return false;"},"<span></span>")+"</td>";i+="</tr></tbody></table>";return i},showMenu:function(){var g=this,j,i,h=c.get(this.id),f;if(g.isDisabled()||g.items.length==0){return}if(g.menu&&g.menu.isMenuVisible){return g.hideMenu()}if(!g.isMenuRendered){g.renderMenu();g.isMenuRendered=true}j=c.getPos(this.settings.menu_container);i=c.getPos(h);f=g.menu;f.settings.offset_x=i.x;f.settings.offset_y=i.y;f.settings.keyboard_focus=!d.isOpera;if(g.oldID){f.items[g.oldID].setSelected(0)}e(g.items,function(k){if(k.value===g.selectedValue){f.items[k.id].setSelected(1);g.oldID=k.id}});f.showMenu(0,h.clientHeight);b.add(c.doc,"mousedown",g.hideMenu,g);c.addClass(g.id,g.classPrefix+"Selected")},hideMenu:function(g){var f=this;if(f.menu&&f.menu.isMenuVisible){if(g&&g.type=="mousedown"&&(g.target.id==f.id+"_text"||g.target.id==f.id+"_open")){return}if(!g||!c.getParent(g.target,".mceMenu")){c.removeClass(f.id,f.classPrefix+"Selected");b.remove(c.doc,"mousedown",f.hideMenu,f);f.menu.hideMenu()}}},renderMenu:function(){var g=this,f;f=g.settings.control_manager.createDropMenu(g.id+"_menu",{menu_line:1,"class":g.classPrefix+"Menu mceNoIcons",max_width:150,max_height:150});f.onHideMenu.add(g.hideMenu,g);f.add({title:g.settings.title,"class":"mceMenuItemTitle",onclick:function(){if(g.settings.onselect("")!==false){g.select("")}}});e(g.items,function(h){if(h.value===undefined){f.add({title:h.title,"class":"mceMenuItemTitle",onclick:function(){if(g.settings.onselect("")!==false){g.select("")}}})}else{h.id=c.uniqueId();h.onclick=function(){if(g.settings.onselect(h.value)!==false){g.select(h.value)}};f.add(h)}});g.onRenderMenu.dispatch(g,f);g.menu=f},postRender:function(){var f=this,g=f.classPrefix;b.add(f.id,"click",f.showMenu,f);b.add(f.id+"_text","focus",function(){if(!f._focused){f.keyDownHandler=b.add(f.id+"_text","keydown",function(k){var h=-1,i,j=k.keyCode;e(f.items,function(l,m){if(f.selectedValue==l.value){h=m}});if(j==38){i=f.items[h-1]}else{if(j==40){i=f.items[h+1]}else{if(j==13){i=f.selectedValue;f.selectedValue=null;f.settings.onselect(i);return b.cancel(k)}}}if(i){f.hideMenu();f.select(i.value)}})}f._focused=1});b.add(f.id+"_text","blur",function(){b.remove(f.id+"_text","keydown",f.keyDownHandler);f._focused=0});if(d.isIE6||!c.boxModel){b.add(f.id,"mouseover",function(){if(!c.hasClass(f.id,g+"Disabled")){c.addClass(f.id,g+"Hover")}});b.add(f.id,"mouseout",function(){if(!c.hasClass(f.id,g+"Disabled")){c.removeClass(f.id,g+"Hover")}})}f.onPostRender.dispatch(f,c.get(f.id))},destroy:function(){this.parent();b.clear(this.id+"_text");b.clear(this.id+"_open")}})})(tinymce);(function(d){var c=d.DOM,b=d.dom.Event,e=d.each,a=d.util.Dispatcher;d.create("tinymce.ui.NativeListBox:tinymce.ui.ListBox",{NativeListBox:function(g,f){this.parent(g,f);this.classPrefix="mceNativeListBox"},setDisabled:function(f){c.get(this.id).disabled=f},isDisabled:function(){return c.get(this.id).disabled},select:function(h){var g=this,j,i;if(h==undefined){return g.selectByIndex(-1)}if(h&&h.call){i=h}else{i=function(f){return f==h}}if(h!=g.selectedValue){e(g.items,function(k,f){if(i(k.value)){j=1;g.selectByIndex(f);return false}});if(!j){g.selectByIndex(-1)}}},selectByIndex:function(f){c.get(this.id).selectedIndex=f+1;this.selectedValue=this.items[f]?this.items[f].value:null},add:function(j,g,f){var i,h=this;f=f||{};f.value=g;if(h.isRendered()){c.add(c.get(this.id),"option",f,j)}i={title:j,value:g,attribs:f};h.items.push(i);h.onAdd.dispatch(h,i)},getLength:function(){return this.items.length},renderHTML:function(){var g,f=this;g=c.createHTML("option",{value:""},"-- "+f.settings.title+" --");e(f.items,function(h){g+=c.createHTML("option",{value:h.value},h.title)});g=c.createHTML("select",{id:f.id,"class":"mceNativeListBox"},g);return g},postRender:function(){var g=this,h;g.rendered=true;function f(j){var i=g.items[j.target.selectedIndex-1];if(i&&(i=i.value)){g.onChange.dispatch(g,i);if(g.settings.onselect){g.settings.onselect(i)}}}b.add(g.id,"change",f);b.add(g.id,"keydown",function(j){var i;b.remove(g.id,"change",h);i=b.add(g.id,"blur",function(){b.add(g.id,"change",f);b.remove(g.id,"blur",i)});if(j.keyCode==13||j.keyCode==32){f(j);return b.cancel(j)}});g.onPostRender.dispatch(g,c.get(g.id))}})})(tinymce);(function(c){var b=c.DOM,a=c.dom.Event,d=c.each;c.create("tinymce.ui.MenuButton:tinymce.ui.Button",{MenuButton:function(f,e){this.parent(f,e);this.onRenderMenu=new c.util.Dispatcher(this);e.menu_container=e.menu_container||b.doc.body},showMenu:function(){var g=this,j,i,h=b.get(g.id),f;if(g.isDisabled()){return}if(!g.isMenuRendered){g.renderMenu();g.isMenuRendered=true}if(g.isMenuVisible){return g.hideMenu()}j=b.getPos(g.settings.menu_container);i=b.getPos(h);f=g.menu;f.settings.offset_x=i.x;f.settings.offset_y=i.y;f.settings.vp_offset_x=i.x;f.settings.vp_offset_y=i.y;f.settings.keyboard_focus=g._focused;f.showMenu(0,h.clientHeight);a.add(b.doc,"mousedown",g.hideMenu,g);g.setState("Selected",1);g.isMenuVisible=1},renderMenu:function(){var f=this,e;e=f.settings.control_manager.createDropMenu(f.id+"_menu",{menu_line:1,"class":this.classPrefix+"Menu",icons:f.settings.icons});e.onHideMenu.add(f.hideMenu,f);f.onRenderMenu.dispatch(f,e);f.menu=e},hideMenu:function(g){var f=this;if(g&&g.type=="mousedown"&&b.getParent(g.target,function(h){return h.id===f.id||h.id===f.id+"_open"})){return}if(!g||!b.getParent(g.target,".mceMenu")){f.setState("Selected",0);a.remove(b.doc,"mousedown",f.hideMenu,f);if(f.menu){f.menu.hideMenu()}}f.isMenuVisible=0},postRender:function(){var e=this,f=e.settings;a.add(e.id,"click",function(){if(!e.isDisabled()){if(f.onclick){f.onclick(e.value)}e.showMenu()}})}})})(tinymce);(function(c){var b=c.DOM,a=c.dom.Event,d=c.each;c.create("tinymce.ui.SplitButton:tinymce.ui.MenuButton",{SplitButton:function(f,e){this.parent(f,e);this.classPrefix="mceSplitButton"},renderHTML:function(){var i,f=this,g=f.settings,e;i="<tbody><tr>";if(g.image){e=b.createHTML("img ",{src:g.image,"class":"mceAction "+g["class"]})}else{e=b.createHTML("span",{"class":"mceAction "+g["class"]},"")}i+="<td>"+b.createHTML("a",{id:f.id+"_action",href:"javascript:;","class":"mceAction "+g["class"],onclick:"return false;",onmousedown:"return false;",title:g.title},e)+"</td>";e=b.createHTML("span",{"class":"mceOpen "+g["class"]});i+="<td>"+b.createHTML("a",{id:f.id+"_open",href:"javascript:;","class":"mceOpen "+g["class"],onclick:"return false;",onmousedown:"return false;",title:g.title},e)+"</td>";i+="</tr></tbody>";return b.createHTML("table",{id:f.id,"class":"mceSplitButton mceSplitButtonEnabled "+g["class"],cellpadding:"0",cellspacing:"0",onmousedown:"return false;",title:g.title},i)},postRender:function(){var e=this,f=e.settings;if(f.onclick){a.add(e.id+"_action","click",function(){if(!e.isDisabled()){f.onclick(e.value)}})}a.add(e.id+"_open","click",e.showMenu,e);a.add(e.id+"_open","focus",function(){e._focused=1});a.add(e.id+"_open","blur",function(){e._focused=0});if(c.isIE6||!b.boxModel){a.add(e.id,"mouseover",function(){if(!b.hasClass(e.id,"mceSplitButtonDisabled")){b.addClass(e.id,"mceSplitButtonHover")}});a.add(e.id,"mouseout",function(){if(!b.hasClass(e.id,"mceSplitButtonDisabled")){b.removeClass(e.id,"mceSplitButtonHover")}})}},destroy:function(){this.parent();a.clear(this.id+"_action");a.clear(this.id+"_open")}})})(tinymce);(function(d){var c=d.DOM,a=d.dom.Event,b=d.is,e=d.each;d.create("tinymce.ui.ColorSplitButton:tinymce.ui.SplitButton",{ColorSplitButton:function(h,g){var f=this;f.parent(h,g);f.settings=g=d.extend({colors:"000000,993300,333300,003300,003366,000080,333399,333333,800000,FF6600,808000,008000,008080,0000FF,666699,808080,FF0000,FF9900,99CC00,339966,33CCCC,3366FF,800080,999999,FF00FF,FFCC00,FFFF00,00FF00,00FFFF,00CCFF,993366,C0C0C0,FF99CC,FFCC99,FFFF99,CCFFCC,CCFFFF,99CCFF,CC99FF,FFFFFF",grid_width:8,default_color:"#888888"},f.settings);f.onShowMenu=new d.util.Dispatcher(f);f.onHideMenu=new d.util.Dispatcher(f);f.value=g.default_color},showMenu:function(){var f=this,g,j,i,h;if(f.isDisabled()){return}if(!f.isMenuRendered){f.renderMenu();f.isMenuRendered=true}if(f.isMenuVisible){return f.hideMenu()}i=c.get(f.id);c.show(f.id+"_menu");c.addClass(i,"mceSplitButtonSelected");h=c.getPos(i);c.setStyles(f.id+"_menu",{left:h.x,top:h.y+i.clientHeight,zIndex:200000});i=0;a.add(c.doc,"mousedown",f.hideMenu,f);f.onShowMenu.dispatch(f);if(f._focused){f._keyHandler=a.add(f.id+"_menu","keydown",function(k){if(k.keyCode==27){f.hideMenu()}});c.select("a",f.id+"_menu")[0].focus()}f.isMenuVisible=1},hideMenu:function(g){var f=this;if(g&&g.type=="mousedown"&&c.getParent(g.target,function(h){return h.id===f.id+"_open"})){return}if(!g||!c.getParent(g.target,".mceSplitButtonMenu")){c.removeClass(f.id,"mceSplitButtonSelected");a.remove(c.doc,"mousedown",f.hideMenu,f);a.remove(f.id+"_menu","keydown",f._keyHandler);c.hide(f.id+"_menu")}f.onHideMenu.dispatch(f);f.isMenuVisible=0},renderMenu:function(){var k=this,f,j=0,l=k.settings,p,h,o,g;g=c.add(l.menu_container,"div",{id:k.id+"_menu","class":l.menu_class+" "+l["class"],style:"position:absolute;left:0;top:-1000px;"});f=c.add(g,"div",{"class":l["class"]+" mceSplitButtonMenu"});c.add(f,"span",{"class":"mceMenuLine"});p=c.add(f,"table",{"class":"mceColorSplitMenu"});h=c.add(p,"tbody");j=0;e(b(l.colors,"array")?l.colors:l.colors.split(","),function(i){i=i.replace(/^#/,"");if(!j--){o=c.add(h,"tr");j=l.grid_width-1}p=c.add(o,"td");p=c.add(p,"a",{href:"javascript:;",style:{backgroundColor:"#"+i},_mce_color:"#"+i})});if(l.more_colors_func){p=c.add(h,"tr");p=c.add(p,"td",{colspan:l.grid_width,"class":"mceMoreColors"});p=c.add(p,"a",{id:k.id+"_more",href:"javascript:;",onclick:"return false;","class":"mceMoreColors"},l.more_colors_title);a.add(p,"click",function(i){l.more_colors_func.call(l.more_colors_scope||this);return a.cancel(i)})}c.addClass(f,"mceColorSplitMenu");a.add(k.id+"_menu","click",function(i){var m;i=i.target;if(i.nodeName=="A"&&(m=i.getAttribute("_mce_color"))){k.setColor(m)}return a.cancel(i)});return g},setColor:function(g){var f=this;c.setStyle(f.id+"_preview","backgroundColor",g);f.value=g;f.hideMenu();f.settings.onselect(g)},postRender:function(){var f=this,g=f.id;f.parent();c.add(g+"_action","div",{id:g+"_preview","class":"mceColorPreview"});c.setStyle(f.id+"_preview","backgroundColor",f.value)},destroy:function(){this.parent();a.clear(this.id+"_menu");a.clear(this.id+"_more");c.remove(this.id+"_menu")}})})(tinymce);tinymce.create("tinymce.ui.Toolbar:tinymce.ui.Container",{renderHTML:function(){var l=this,e="",g,j,b=tinymce.DOM,m=l.settings,d,a,f,k;k=l.controls;for(d=0;d<k.length;d++){j=k[d];a=k[d-1];f=k[d+1];if(d===0){g="mceToolbarStart";if(j.Button){g+=" mceToolbarStartButton"}else{if(j.SplitButton){g+=" mceToolbarStartSplitButton"}else{if(j.ListBox){g+=" mceToolbarStartListBox"}}}e+=b.createHTML("td",{"class":g},b.createHTML("span",null,"<!-- IE -->"))}if(a&&j.ListBox){if(a.Button||a.SplitButton){e+=b.createHTML("td",{"class":"mceToolbarEnd"},b.createHTML("span",null,"<!-- IE -->"))}}if(b.stdMode){e+='<td style="position: relative">'+j.renderHTML()+"</td>"}else{e+="<td>"+j.renderHTML()+"</td>"}if(f&&j.ListBox){if(f.Button||f.SplitButton){e+=b.createHTML("td",{"class":"mceToolbarStart"},b.createHTML("span",null,"<!-- IE -->"))}}}g="mceToolbarEnd";if(j.Button){g+=" mceToolbarEndButton"}else{if(j.SplitButton){g+=" mceToolbarEndSplitButton"}else{if(j.ListBox){g+=" mceToolbarEndListBox"}}}e+=b.createHTML("td",{"class":g},b.createHTML("span",null,"<!-- IE -->"));return b.createHTML("table",{id:l.id,"class":"mceToolbar"+(m["class"]?" "+m["class"]:""),cellpadding:"0",cellspacing:"0",align:l.settings.align||""},"<tbody><tr>"+e+"</tr></tbody>")}});(function(b){var a=b.util.Dispatcher,c=b.each;b.create("tinymce.AddOnManager",{items:[],urls:{},lookup:{},onAdd:new a(this),get:function(d){return this.lookup[d]},requireLangPack:function(e){var d=b.settings;if(d&&d.language){b.ScriptLoader.add(this.urls[e]+"/langs/"+d.language+".js")}},add:function(e,d){this.items.push(d);this.lookup[e]=d;this.onAdd.dispatch(this,e,d);return d},load:function(h,e,d,g){var f=this;if(f.urls[h]){return}if(e.indexOf("/")!=0&&e.indexOf("://")==-1){e=b.baseURL+"/"+e}f.urls[h]=e.substring(0,e.lastIndexOf("/"));b.ScriptLoader.add(e,d,g)}});b.PluginManager=new b.AddOnManager();b.ThemeManager=new b.AddOnManager()}(tinymce));(function(j){var g=j.each,d=j.extend,k=j.DOM,i=j.dom.Event,f=j.ThemeManager,b=j.PluginManager,e=j.explode,h=j.util.Dispatcher,a,c=0;j.documentBaseURL=window.location.href.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,"");if(!/[\/\\]$/.test(j.documentBaseURL)){j.documentBaseURL+="/"}j.baseURL=new j.util.URI(j.documentBaseURL).toAbsolute(j.baseURL);j.baseURI=new j.util.URI(j.baseURL);j.onBeforeUnload=new h(j);i.add(window,"beforeunload",function(l){j.onBeforeUnload.dispatch(j,l)});j.onAddEditor=new h(j);j.onRemoveEditor=new h(j);j.EditorManager=d(j,{editors:[],i18n:{},activeEditor:null,init:function(q){var n=this,p,l=j.ScriptLoader,u,o=[],m;function r(x,y,t){var v=x[y];if(!v){return}if(j.is(v,"string")){t=v.replace(/\.\w+$/,"");t=t?j.resolve(t):0;v=j.resolve(v)}return v.apply(t||this,Array.prototype.slice.call(arguments,2))}q=d({theme:"simple",language:"en"},q);n.settings=q;i.add(document,"init",function(){var s,v;r(q,"onpageload");switch(q.mode){case"exact":s=q.elements||"";if(s.length>0){g(e(s),function(x){if(k.get(x)){m=new j.Editor(x,q);o.push(m);m.render(1)}else{g(document.forms,function(y){g(y.elements,function(z){if(z.name===x){x="mce_editor_"+c++;k.setAttrib(z,"id",x);m=new j.Editor(x,q);o.push(m);m.render(1)}})})}})}break;case"textareas":case"specific_textareas":function t(y,x){return x.constructor===RegExp?x.test(y.className):k.hasClass(y,x)}g(k.select("textarea"),function(x){if(q.editor_deselector&&t(x,q.editor_deselector)){return}if(!q.editor_selector||t(x,q.editor_selector)){u=k.get(x.name);if(!x.id&&!u){x.id=x.name}if(!x.id||n.get(x.id)){x.id=k.uniqueId()}m=new j.Editor(x.id,q);o.push(m);m.render(1)}});break}if(q.oninit){s=v=0;g(o,function(x){v++;if(!x.initialized){x.onInit.add(function(){s++;if(s==v){r(q,"oninit")}})}else{s++}if(s==v){r(q,"oninit")}})}})},get:function(l){if(l===a){return this.editors}return this.editors[l]},getInstanceById:function(l){return this.get(l)},add:function(m){var l=this,n=l.editors;n[m.id]=m;n.push(m);l._setActive(m);l.onAddEditor.dispatch(l,m);return m},remove:function(n){var m=this,l,o=m.editors;if(!o[n.id]){return null}delete o[n.id];for(l=0;l<o.length;l++){if(o[l]==n){o.splice(l,1);break}}if(m.activeEditor==n){m._setActive(o[0])}n.destroy();m.onRemoveEditor.dispatch(m,n);return n},execCommand:function(r,p,o){var q=this,n=q.get(o),l;switch(r){case"mceFocus":n.focus();return true;case"mceAddEditor":case"mceAddControl":if(!q.get(o)){new j.Editor(o,q.settings).render()}return true;case"mceAddFrameControl":l=o.window;l.tinyMCE=tinyMCE;l.tinymce=j;j.DOM.doc=l.document;j.DOM.win=l;n=new j.Editor(o.element_id,o);n.render();if(j.isIE){function m(){n.destroy();l.detachEvent("onunload",m);l=l.tinyMCE=l.tinymce=null}l.attachEvent("onunload",m)}o.page_window=null;return true;case"mceRemoveEditor":case"mceRemoveControl":if(n){n.remove()}return true;case"mceToggleEditor":if(!n){q.execCommand("mceAddControl",0,o);return true}if(n.isHidden()){n.show()}else{n.hide()}return true}if(q.activeEditor){return q.activeEditor.execCommand(r,p,o)}return false},execInstanceCommand:function(p,o,n,m){var l=this.get(p);if(l){return l.execCommand(o,n,m)}return false},triggerSave:function(){g(this.editors,function(l){l.save()})},addI18n:function(n,q){var l,m=this.i18n;if(!j.is(n,"string")){g(n,function(r,p){g(r,function(t,s){g(t,function(v,u){if(s==="common"){m[p+"."+u]=v}else{m[p+"."+s+"."+u]=v}})})})}else{g(q,function(r,p){m[n+"."+p]=r})}},_setActive:function(l){this.selectedInstance=this.activeEditor=l}})})(tinymce);(function(m){var n=m.DOM,j=m.dom.Event,f=m.extend,k=m.util.Dispatcher,i=m.each,a=m.isGecko,b=m.isIE,e=m.isWebKit,d=m.is,h=m.ThemeManager,c=m.PluginManager,o=m.inArray,l=m.grep,g=m.explode;m.create("tinymce.Editor",{Editor:function(r,q){var p=this;p.id=p.editorId=r;p.execCommands={};p.queryStateCommands={};p.queryValueCommands={};p.isNotDirty=false;p.plugins={};i(["onPreInit","onBeforeRenderUI","onPostRender","onInit","onRemove","onActivate","onDeactivate","onClick","onEvent","onMouseUp","onMouseDown","onDblClick","onKeyDown","onKeyUp","onKeyPress","onContextMenu","onSubmit","onReset","onPaste","onPreProcess","onPostProcess","onBeforeSetContent","onBeforeGetContent","onSetContent","onGetContent","onLoadContent","onSaveContent","onNodeChange","onChange","onBeforeExecCommand","onExecCommand","onUndo","onRedo","onVisualAid","onSetProgressState","onFormatChange"],function(s){p[s]=new k(p)});p.settings=q=f({id:r,language:"en",docs_language:"en",theme:"simple",skin:"default",delta_width:0,delta_height:0,popup_css:"",plugins:"",document_base_url:m.documentBaseURL,add_form_submit_trigger:1,submit_patch:1,add_unload_trigger:1,convert_urls:1,relative_urls:1,remove_script_host:1,table_inline_editing:0,object_resizing:1,cleanup:1,accessibility_focus:1,custom_shortcuts:1,custom_undo_redo_keyboard_shortcuts:1,custom_undo_redo_restore_selection:1,custom_undo_redo:1,doctype:m.isIE6?'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">':"<!DOCTYPE>",visual_table_class:"mceItemTable",visual:1,inline_styles:true,convert_fonts_to_spans:true,font_size_style_values:"xx-small,x-small,small,medium,large,x-large,xx-large",apply_source_formatting:1,directionality:"ltr",forced_root_block:"p",valid_elements:"@[id|class|style|title|dir<ltr?rtl|lang|xml::lang|onclick|ondblclick|onmousedown|onmouseup|onmouseover|onmousemove|onmouseout|onkeypress|onkeydown|onkeyup],a[rel|rev|charset|hreflang|tabindex|accesskey|type|name|href|target|title|class|onfocus|onblur],strong/b,em/i,strike,u,#p,-ol[type|compact],-ul[type|compact],-li,br,img[longdesc|usemap|src|border|alt=|title|hspace|vspace|width|height|align],-sub,-sup,-blockquote[cite],-table[border|cellspacing|cellpadding|width|frame|rules|height|align|summary|bgcolor|background|bordercolor],-tr[rowspan|width|height|align|valign|bgcolor|background|bordercolor],tbody,thead,tfoot,#td[colspan|rowspan|width|height|align|valign|bgcolor|background|bordercolor|scope],#th[colspan|rowspan|width|height|align|valign|scope],caption,-div,-span,-code,-pre,address,-h1,-h2,-h3,-h4,-h5,-h6,hr[size|noshade],-font[face|size|color],dd,dl,dt,cite,abbr,acronym,del[datetime|cite],ins[datetime|cite],object[classid|width|height|codebase|*],param[name|value],embed[type|width|height|src|*],script[src|type],map[name],area[shape|coords|href|alt|target],bdo,button,col[align|char|charoff|span|valign|width],colgroup[align|char|charoff|span|valign|width],dfn,fieldset,form[action|accept|accept-charset|enctype|method],input[accept|alt|checked|disabled|maxlength|name|readonly|size|src|type|value|tabindex|accesskey],kbd,label[for],legend,noscript,optgroup[label|disabled],option[disabled|label|selected|value],q[cite],samp,select[disabled|multiple|name|size],small,textarea[cols|rows|disabled|name|readonly],tt,var,big",hidden_input:1,padd_empty_editor:1,render_ui:1,init_theme:1,force_p_newlines:1,indentation:"30px",keep_styles:1,fix_table_elements:1,removeformat_selector:"span,b,strong,em,i,font,u,strike"},q);p.documentBaseURI=new m.util.URI(q.document_base_url||m.documentBaseURL,{base_uri:tinyMCE.baseURI});p.baseURI=m.baseURI;p.execCallback("setup",p)},render:function(q){var r=this,u=r.settings,v=r.id,p=m.ScriptLoader;if(!j.domLoaded){j.add(document,"init",function(){r.render()});return}tinyMCE.settings=u;if(!r.getElement()){return}if(!/TEXTAREA|INPUT/i.test(r.getElement().nodeName)&&u.hidden_input&&n.getParent(v,"form")){n.insertAfter(n.create("input",{type:"hidden",name:v}),v)}if(m.WindowManager){r.windowManager=new m.WindowManager(r)}if(u.encoding=="xml"){r.onGetContent.add(function(s,t){if(t.save){t.content=n.encode(t.content)}})}if(u.add_form_submit_trigger){r.onSubmit.addToTop(function(){if(r.initialized){r.save();r.isNotDirty=1}})}if(u.add_unload_trigger){r._beforeUnload=tinyMCE.onBeforeUnload.add(function(){if(r.initialized&&!r.destroyed&&!r.isHidden()){r.save({format:"raw",no_events:true})}})}m.addUnload(r.destroy,r);if(u.submit_patch){r.onBeforeRenderUI.add(function(){var s=r.getElement().form;if(!s){return}if(s._mceOldSubmit){return}if(!s.submit.nodeType&&!s.submit.length){r.formElement=s;s._mceOldSubmit=s.submit;s.submit=function(){m.triggerSave();r.isNotDirty=1;return r.formElement._mceOldSubmit(r.formElement)}}s=null})}r.init()},init:function(){var r,E=this,F=E.settings,B,y,A=E.getElement(),q,p,C,x,z,D;m.add(E);if(F.theme){F.theme=F.theme.replace(/-/,"");q=h.get(F.theme);E.theme=new q();if(E.theme.init&&F.init_theme){E.theme.init(E,h.urls[F.theme]||m.documentBaseURL.replace(/\/$/,""))}}i(g(F.plugins.replace(/\-/g,"")),function(G){var H=c.get(G),t=c.urls[G]||m.documentBaseURL.replace(/\/$/,""),s;if(H){s=new H(E,t);E.plugins[G]=s;if(s.init){s.init(E,t)}}});if(F.popup_css!==false){if(F.popup_css){F.popup_css=E.documentBaseURI.toAbsolute(F.popup_css)}else{F.popup_css=E.baseURI.toAbsolute("themes/"+F.theme+"/skins/"+F.skin+"/dialog.css")}}if(F.popup_css_add){F.popup_css+=","+E.documentBaseURI.toAbsolute(F.popup_css_add)}E.controlManager=new m.ControlManager(E);if(F.custom_undo_redo){E.onBeforeExecCommand.add(function(t,G,u,H,s){if(G!="Undo"&&G!="Redo"&&G!="mceRepaint"&&(!s||!s.skip_undo)){if(!E.undoManager.hasUndo()){E.undoManager.add()}}});E.onExecCommand.add(function(t,G,u,H,s){if(G!="Undo"&&G!="Redo"&&G!="mceRepaint"&&(!s||!s.skip_undo)){E.undoManager.add()}})}E.onExecCommand.add(function(s,t){if(!/^(FontName|FontSize)$/.test(t)){E.nodeChanged()}});if(a){function v(s,t){if(!t||!t.initial){E.execCommand("mceRepaint")}}E.onUndo.add(v);E.onRedo.add(v);E.onSetContent.add(v)}E.onBeforeRenderUI.dispatch(E,E.controlManager);if(F.render_ui){B=F.width||A.style.width||A.offsetWidth;y=F.height||A.style.height||A.offsetHeight;E.orgDisplay=A.style.display;D=/^[0-9\.]+(|px)$/i;if(D.test(""+B)){B=Math.max(parseInt(B)+(q.deltaWidth||0),100)}if(D.test(""+y)){y=Math.max(parseInt(y)+(q.deltaHeight||0),100)}q=E.theme.renderUI({targetNode:A,width:B,height:y,deltaWidth:F.delta_width,deltaHeight:F.delta_height});E.editorContainer=q.editorContainer}if(document.domain&&location.hostname!=document.domain){m.relaxedDomain=document.domain}n.setStyles(q.sizeContainer||q.editorContainer,{width:B,height:y});y=(q.iframeHeight||y)+(typeof(y)=="number"?(q.deltaHeight||0):"");if(y<100){y=100}E.iframeHTML=F.doctype+'<html><head xmlns="http://www.w3.org/1999/xhtml">';if(F.document_base_url!=m.documentBaseURL){E.iframeHTML+='<base href="'+E.documentBaseURI.getURI()+'" />'}E.iframeHTML+='<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />';E.iframeHTML+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';if(m.relaxedDomain){E.iframeHTML+='<script type="text/javascript">document.domain = "'+m.relaxedDomain+'";<\/script>'}x=F.body_id||"tinymce";if(x.indexOf("=")!=-1){x=E.getParam("body_id","","hash");x=x[E.id]||x}z=F.body_class||"";if(z.indexOf("=")!=-1){z=E.getParam("body_class","","hash");z=z[E.id]||""}E.iframeHTML+='</head><body id="'+x+'" class="tiny_mce_content mceContentBody '+z+'"></body></html>';if(m.relaxedDomain){if(b||(m.isOpera&&parseFloat(opera.version())>=9.5)){C='javascript:(function(){document.open();document.domain="'+document.domain+'";var ed = window.parent.tinyMCE.get("'+E.id+'");document.write(ed.iframeHTML);document.close();ed.setupIframe();})()'}else{if(m.isOpera){C='javascript:(function(){document.open();document.domain="'+document.domain+'";document.close();ed.setupIframe();})()'}}}r=n.add(q.iframeContainer,"iframe",{id:E.id+"_ifr",src:C||'javascript:""',allowTransparency:true,frameBorder:"0",style:{width:"100%",height:y,position:"relative"}});E.contentAreaContainer=q.iframeContainer;n.get(q.editorContainer).style.display=E.orgDisplay;n.get(E.id).style.display="none";if(!b||!m.relaxedDomain){E.setupIframe()}A=r=q=null},setupIframe:function(){var z=this,A=z.settings,r=n.get(z.id),u=z.getDoc(),q,x;if(!b||!m.relaxedDomain){u.open();u.write(z.iframeHTML);u.close()}if(!b){try{if(!A.readonly){u.designMode="On"}}catch(v){}}if(b){x=z.getBody();n.hide(x);if(!A.readonly){x.contentEditable=true}n.show(x)}z.dom=new m.dom.DOMUtils(z.getDoc(),{keep_values:true,url_converter:z.convertURL,url_converter_scope:z,hex_colors:A.force_hex_style_colors,class_filter:A.class_filter,update_styles:1,fix_ie_paragraphs:1,valid_styles:A.valid_styles});z.schema=new m.dom.Schema();z.serializer=new m.dom.Serializer(f(A,{valid_elements:A.verify_html===false?"*[*]":A.valid_elements,dom:z.dom,schema:z.schema}));z.selection=new m.dom.Selection(z.dom,z.getWin(),z.serializer);z.formatter=new m.Formatter(this);z.formatter.register({alignleft:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"left"}},{selector:"img,table",styles:{"float":"left"}}],aligncenter:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"center"}},{selector:"img",styles:{display:"block",marginLeft:"auto",marginRight:"auto"}},{selector:"table",styles:{marginLeft:"auto",marginRight:"auto"}}],alignright:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"right"}},{selector:"img,table",styles:{"float":"right"}}],alignfull:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"justify"}}],bold:[{inline:"strong"},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b"}],italic:[{inline:"em"},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i"}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:true},{inline:"u"}],strikethrough:[{inline:"span",styles:{textDecoration:"line-through"},exact:true},{inline:"u"}],forecolor:{inline:"span",styles:{color:"%value"}},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"}},fontname:{inline:"span",styles:{fontFamily:"%value"}},fontsize:{inline:"span",styles:{fontSize:"%value"}},fontsize_class:{inline:"span",attributes:{"class":"%value"}},blockquote:{block:"blockquote",wrapper:1,remove:"all"},removeformat:[{selector:"b,strong,em,i,font,u,strike",remove:"all",split:true,expand:false,block_expand:true,deep:true},{selector:"span",attributes:["style","class"],remove:"empty",split:true,expand:false,deep:true},{selector:"*",attributes:["style","class"],split:false,expand:false,deep:true}]});i("p h1 h2 h3 h4 h5 h6 div address pre div code dt dd samp".split(/\s/),function(s){z.formatter.register(s,{block:s,remove:"all"})});z.formatter.register(z.settings.formats);z.undoManager=new m.UndoManager(z);z.undoManager.onAdd.add(function(t,s){if(!s.initial){return z.onChange.dispatch(z,s,t)}});z.undoManager.onUndo.add(function(t,s){return z.onUndo.dispatch(z,s,t)});z.undoManager.onRedo.add(function(t,s){return z.onRedo.dispatch(z,s,t)});z.forceBlocks=new m.ForceBlocks(z,{forced_root_block:A.forced_root_block});z.editorCommands=new m.EditorCommands(z);z.serializer.onPreProcess.add(function(s,t){return z.onPreProcess.dispatch(z,t,s)});z.serializer.onPostProcess.add(function(s,t){return z.onPostProcess.dispatch(z,t,s)});z.onPreInit.dispatch(z);if(!A.gecko_spellcheck){z.getBody().spellcheck=0}if(!A.readonly){z._addEvents()}z.controlManager.onPostRender.dispatch(z,z.controlManager);z.onPostRender.dispatch(z);if(A.directionality){z.getBody().dir=A.directionality}if(A.nowrap){z.getBody().style.whiteSpace="nowrap"}if(A.custom_elements){function y(s,t){i(g(A.custom_elements),function(B){var C;if(B.indexOf("~")===0){B=B.substring(1);C="span"}else{C="div"}t.content=t.content.replace(new RegExp("<("+B+")([^>]*)>","g"),"<"+C+' _mce_name="$1"$2>');t.content=t.content.replace(new RegExp("</("+B+")>","g"),"</"+C+">")})}z.onBeforeSetContent.add(y);z.onPostProcess.add(function(s,t){if(t.set){y(s,t)}})}if(A.handle_node_change_callback){z.onNodeChange.add(function(t,s,B){z.execCallback("handle_node_change_callback",z.id,B,-1,-1,true,z.selection.isCollapsed())})}if(A.save_callback){z.onSaveContent.add(function(s,B){var t=z.execCallback("save_callback",z.id,B.content,z.getBody());if(t){B.content=t}})}if(A.onchange_callback){z.onChange.add(function(t,s){z.execCallback("onchange_callback",z,s)})}if(A.convert_newlines_to_brs){z.onBeforeSetContent.add(function(s,t){if(t.initial){t.content=t.content.replace(/\r?\n/g,"<br />")}})}if(A.fix_nesting&&b){z.onBeforeSetContent.add(function(s,t){t.content=z._fixNesting(t.content)})}if(A.preformatted){z.onPostProcess.add(function(s,t){t.content=t.content.replace(/^\s*<pre.*?>/,"");t.content=t.content.replace(/<\/pre>\s*$/,"");if(t.set){t.content='<pre class="mceItemHidden">'+t.content+"</pre>"}})}if(A.verify_css_classes){z.serializer.attribValueFilter=function(D,B){var C,t;if(D=="class"){if(!z.classesRE){t=z.dom.getClasses();if(t.length>0){C="";i(t,function(s){C+=(C?"|":"")+s["class"]});z.classesRE=new RegExp("("+C+")","gi")}}return !z.classesRE||/(\bmceItem\w+\b|\bmceTemp\w+\b)/g.test(B)||z.classesRE.test(B)?B:""}return B}}if(A.cleanup_callback){z.onBeforeSetContent.add(function(s,t){t.content=z.execCallback("cleanup_callback","insert_to_editor",t.content,t)});z.onPreProcess.add(function(s,t){if(t.set){z.execCallback("cleanup_callback","insert_to_editor_dom",t.node,t)}if(t.get){z.execCallback("cleanup_callback","get_from_editor_dom",t.node,t)}});z.onPostProcess.add(function(s,t){if(t.set){t.content=z.execCallback("cleanup_callback","insert_to_editor",t.content,t)}if(t.get){t.content=z.execCallback("cleanup_callback","get_from_editor",t.content,t)}})}if(A.save_callback){z.onGetContent.add(function(s,t){if(t.save){t.content=z.execCallback("save_callback",z.id,t.content,z.getBody())}})}if(A.handle_event_callback){z.onEvent.add(function(s,t,B){if(z.execCallback("handle_event_callback",t,s,B)===false){j.cancel(t)}})}z.onSetContent.add(function(){z.addVisual(z.getBody())});if(A.padd_empty_editor){z.onPostProcess.add(function(s,t){t.content=t.content.replace(/^(<p[^>]*>(&nbsp;|&#160;|\s|\u00a0|)<\/p>[\r\n]*|<br \/>[\r\n]*)$/,"")})}if(a){function p(s,t){i(s.dom.select("a"),function(C){var B=C.parentNode;if(s.dom.isBlock(B)&&B.lastChild===C){s.dom.add(B,"br",{_mce_bogus:1})}})}z.onExecCommand.add(function(s,t){if(t==="CreateLink"){p(s)}});z.onSetContent.add(z.selection.onSetContent.add(p));if(!A.readonly){try{u.designMode="Off";u.designMode="On"}catch(v){}}}setTimeout(function(){if(z.removed){return}z.load({initial:true,format:(A.cleanup_on_startup?"html":"raw")});z.startContent=z.getContent({format:"raw"});z.undoManager.add({initial:true});z.initialized=true;z.onInit.dispatch(z);z.execCallback("setupcontent_callback",z.id,z.getBody(),z.getDoc());z.execCallback("init_instance_callback",z);z.focus(true);z.nodeChanged({initial:1});if(A.content_css){m.each(g(A.content_css),function(s){z.dom.loadCSS(z.documentBaseURI.toAbsolute(s))})}if(A.auto_focus){setTimeout(function(){var s=m.get(A.auto_focus);s.selection.select(s.getBody(),1);s.selection.collapse(1);s.getWin().focus()},100)}},1);r=null},focus:function(s){var x,q=this,v=q.settings.content_editable,r,p,u=q.getDoc();if(!s){r=q.selection.getRng();if(r.item){p=r.item(0)}if(!v){q.getWin().focus()}if(p&&p.ownerDocument==u){r=u.body.createControlRange();r.addElement(p);r.select()}}if(m.activeEditor!=q){if((x=m.activeEditor)!=null){x.onDeactivate.dispatch(x,q)}q.onActivate.dispatch(q,x)}m._setActive(q)},execCallback:function(u){var p=this,r=p.settings[u],q;if(!r){return}if(p.callbackLookup&&(q=p.callbackLookup[u])){r=q.func;q=q.scope}if(d(r,"string")){q=r.replace(/\.\w+$/,"");q=q?m.resolve(q):0;r=m.resolve(r);p.callbackLookup=p.callbackLookup||{};p.callbackLookup[u]={func:r,scope:q}}return r.apply(q||p,Array.prototype.slice.call(arguments,1))},translate:function(p){var r=this.settings.language||"en",q=m.i18n;if(!p){return""}return q[r+"."+p]||p.replace(/{\#([^}]+)\}/g,function(t,s){return q[r+"."+s]||"{#"+s+"}"})},getLang:function(q,p){return m.i18n[(this.settings.language||"en")+"."+q]||(d(p)?p:"{#"+q+"}")},getParam:function(u,r,p){var s=m.trim,q=d(this.settings[u])?this.settings[u]:r,t;if(p==="hash"){t={};if(d(q,"string")){i(q.indexOf("=")>0?q.split(/[;,](?![^=;,]*(?:[;,]|$))/):q.split(","),function(x){x=x.split("=");if(x.length>1){t[s(x[0])]=s(x[1])}else{t[s(x[0])]=s(x)}})}else{t=q}return t}return q},nodeChanged:function(r){var p=this,q=p.selection,u=(b?q.getNode():q.getStart())||p.getBody();if(p.initialized){r=r||{};u=b&&u.ownerDocument!=p.getDoc()?p.getBody():u;r.parents=[];p.dom.getParent(u,function(s){if(s.nodeName=="BODY"){return true}r.parents.push(s)});p.onNodeChange.dispatch(p,r?r.controlManager||p.controlManager:p.controlManager,u,q.isCollapsed(),r)}},addButton:function(r,q){var p=this;p.buttons=p.buttons||{};p.buttons[r]=q},addCommand:function(r,q,p){this.execCommands[r]={func:q,scope:p||this}},addQueryStateHandler:function(r,q,p){this.queryStateCommands[r]={func:q,scope:p||this}},addQueryValueHandler:function(r,q,p){this.queryValueCommands[r]={func:q,scope:p||this}},addShortcut:function(r,u,p,s){var q=this,v;if(!q.settings.custom_shortcuts){return false}q.shortcuts=q.shortcuts||{};if(d(p,"string")){v=p;p=function(){q.execCommand(v,false,null)}}if(d(p,"object")){v=p;p=function(){q.execCommand(v[0],v[1],v[2])}}i(g(r),function(t){var x={func:p,scope:s||this,desc:u,alt:false,ctrl:false,shift:false};i(g(t,"+"),function(y){switch(y){case"alt":case"ctrl":case"shift":x[y]=true;break;default:x.charCode=y.charCodeAt(0);x.keyCode=y.toUpperCase().charCodeAt(0)}});q.shortcuts[(x.ctrl?"ctrl":"")+","+(x.alt?"alt":"")+","+(x.shift?"shift":"")+","+x.keyCode]=x});return true},execCommand:function(r,x,q,y){var z=this,B=0,p,A;if(!/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint|SelectAll)$/.test(r)&&(!y||!y.skip_focus)){z.focus()}p={};z.onBeforeExecCommand.dispatch(z,r,x,q,p);if(p.terminate){return false}if(z.execCallback("execcommand_callback",z.id,z.selection.getNode(),r,x,q)){z.onExecCommand.dispatch(z,r,x,q,y);return true}if(p=z.execCommands[r]){A=p.func.call(p.scope,x,q);if(A!==true){z.onExecCommand.dispatch(z,r,x,q,y);return A}}i(z.plugins,function(s){if(s.execCommand&&s.execCommand(r,x,q)){z.onExecCommand.dispatch(z,r,x,q,y);B=1;return false}});if(B){return true}if(z.theme&&z.theme.execCommand&&z.theme.execCommand(r,x,q)){z.onExecCommand.dispatch(z,r,x,q,y);return true}if(m.GlobalCommands.execCommand(z,r,x,q)){z.onExecCommand.dispatch(z,r,x,q,y);return true}if(z.editorCommands.execCommand(r,x,q)){z.onExecCommand.dispatch(z,r,x,q,y);return true}var v=z.getDoc();try{v.execCommand(r,x,q)}catch(u){if(console&&console.log){console.log("execCommand("+r+"...) failed: ",u)}}z.onExecCommand.dispatch(z,r,x,q,y)},queryCommandState:function(u){var q=this,v,r;if(q._isHidden()){return}if(v=q.queryStateCommands[u]){r=v.func.call(v.scope);if(r!==true){return r}}v=q.editorCommands.queryCommandState(u);if(v!==-1){return v}try{return this.getDoc().queryCommandState(u)}catch(p){}},queryCommandValue:function(v){var q=this,u,r;if(q._isHidden()){return}if(u=q.queryValueCommands[v]){r=u.func.call(u.scope);if(r!==true){return r}}u=q.editorCommands.queryCommandValue(v);if(d(u)){return u}try{return this.getDoc().queryCommandValue(v)}catch(p){}},show:function(){var p=this;n.show(p.getContainer());n.hide(p.id);p.load()},hide:function(){var p=this,q=p.getDoc();if(b&&q){q.execCommand("SelectAll")}p.save();n.hide(p.getContainer());n.setStyle(p.id,"display",p.orgDisplay)},isHidden:function(){return !n.isHidden(this.id)},setProgressState:function(p,q,r){this.onSetProgressState.dispatch(this,p,q,r);return p},load:function(s){var p=this,r=p.getElement(),q;if(r){s=s||{};s.load=true;q=p.setContent(d(r.value)?r.value:r.innerHTML,s);s.element=r;if(!s.no_events){p.onLoadContent.dispatch(p,s)}s.element=r=null;return q}},save:function(u){var p=this,s=p.getElement(),q,r;if(!s||!p.initialized){return}u=u||{};u.save=true;if(!u.no_events){p.undoManager.typing=0;p.undoManager.deleting=0;p.undoManager.add()}u.element=s;q=u.content=p.getContent(u);if(!u.no_events){p.onSaveContent.dispatch(p,u)}q=u.content;if(!/TEXTAREA|INPUT/i.test(s.nodeName)){s.innerHTML=q;if(r=n.getParent(p.id,"form")){i(r.elements,function(t){if(t.name==p.id){t.value=q;return false}})}}else{s.value=q}u.element=s=null;return q},setContent:function(q,r){var p=this;r=r||{};r.format=r.format||"html";r.set=true;r.content=q;if(!r.no_events){p.onBeforeSetContent.dispatch(p,r)}if(!m.isIE&&(q.length===0||/^\s+$/.test(q))){r.content=p.dom.setHTML(p.getBody(),'<br _mce_bogus="1" />');r.format="raw"}r.content=p.dom.setHTML(p.getBody(),m.trim(r.content));if(r.format!="raw"&&p.settings.cleanup){r.getInner=true;r.content=p.dom.setHTML(p.getBody(),p.serializer.serialize(p.getBody(),r))}if(!r.no_events){p.onSetContent.dispatch(p,r)}return r.content},getContent:function(r){var p=this,q;r=r||{};r.format=r.format||"html";r.get=true;if(!r.no_events){p.onBeforeGetContent.dispatch(p,r)}if(r.format!="raw"&&p.settings.cleanup){r.getInner=true;q=p.serializer.serialize(p.getBody(),r)}else{q=p.getBody().innerHTML}q=q.replace(/^\s*|\s*$/g,"");r.content=q;if(!r.no_events){p.onGetContent.dispatch(p,r)}return r.content},isDirty:function(){var p=this;return m.trim(p.startContent)!=m.trim(p.getContent({format:"raw",no_events:1}))&&!p.isNotDirty},getContainer:function(){var p=this;if(!p.container){p.container=n.get(p.editorContainer||p.id+"_parent")}return p.container},getContentAreaContainer:function(){return this.contentAreaContainer},getElement:function(){return n.get(this.settings.content_element||this.id)},getWin:function(){var p=this,q;if(!p.contentWindow){q=n.get(p.id+"_ifr");if(q){p.contentWindow=q.contentWindow}}return p.contentWindow},getDoc:function(){var q=this,p;if(!q.contentDocument){p=q.getWin();if(p){q.contentDocument=p.document}}return q.contentDocument},getBody:function(){return this.bodyElement||this.getDoc().body},convertURL:function(p,x,v){var q=this,r=q.settings;if(r.urlconverter_callback){return q.execCallback("urlconverter_callback",p,v,true,x)}if(!r.convert_urls||(v&&v.nodeName=="LINK")||p.indexOf("file:")===0){return p}if(r.relative_urls){return q.documentBaseURI.toRelative(p)}p=q.documentBaseURI.toAbsolute(p,r.remove_script_host);return p},addVisual:function(r){var p=this,q=p.settings;r=r||p.getBody();if(!d(p.hasVisual)){p.hasVisual=q.visual}i(p.dom.select("table,a",r),function(t){var s;switch(t.nodeName){case"TABLE":s=p.dom.getAttrib(t,"border");if(!s||s=="0"){if(p.hasVisual){p.dom.addClass(t,q.visual_table_class)}else{p.dom.removeClass(t,q.visual_table_class)}}return;case"A":s=p.dom.getAttrib(t,"name");if(s){if(p.hasVisual){p.dom.addClass(t,"mceItemAnchor")}else{p.dom.removeClass(t,"mceItemAnchor")}}return}});p.onVisualAid.dispatch(p,r,p.hasVisual)},remove:function(){var p=this,q=p.getContainer();p.removed=1;p.hide();p.execCallback("remove_instance_callback",p);p.onRemove.dispatch(p);p.onExecCommand.listeners=[];m.remove(p);n.remove(q)},destroy:function(q){var p=this;if(p.destroyed){return}if(!q){m.removeUnload(p.destroy);tinyMCE.onBeforeUnload.remove(p._beforeUnload);if(p.theme&&p.theme.destroy){p.theme.destroy()}p.controlManager.destroy();p.selection.destroy();p.dom.destroy();if(!p.settings.content_editable){j.clear(p.getWin());j.clear(p.getDoc())}j.clear(p.getBody());j.clear(p.formElement)}if(p.formElement){p.formElement.submit=p.formElement._mceOldSubmit;p.formElement._mceOldSubmit=null}p.contentAreaContainer=p.formElement=p.container=p.settings.content_element=p.bodyElement=p.contentDocument=p.contentWindow=null;if(p.selection){p.selection=p.selection.win=p.selection.dom=p.selection.dom.doc=null}p.destroyed=1},_addEvents:function(){var v=this,u,y=v.settings,x={mouseup:"onMouseUp",mousedown:"onMouseDown",click:"onClick",keyup:"onKeyUp",keydown:"onKeyDown",keypress:"onKeyPress",submit:"onSubmit",reset:"onReset",contextmenu:"onContextMenu",dblclick:"onDblClick",paste:"onPaste"};function r(t,A){var s=t.type;if(v.removed){return}if(v.onEvent.dispatch(v,t,A)!==false){v[x[t.fakeType||t.type]].dispatch(v,t,A)}}i(x,function(t,s){switch(s){case"contextmenu":if(m.isOpera){v.dom.bind(v.getBody(),"mousedown",function(A){if(A.ctrlKey){A.fakeType="contextmenu";r(A)}})}else{v.dom.bind(v.getBody(),s,r)}break;case"paste":v.dom.bind(v.getBody(),s,function(A){r(A)});break;case"submit":case"reset":v.dom.bind(v.getElement().form||n.getParent(v.id,"form"),s,r);break;default:v.dom.bind(y.content_editable?v.getBody():v.getDoc(),s,r)}});v.dom.bind(y.content_editable?v.getBody():(a?v.getDoc():v.getWin()),"focus",function(s){v.focus(true)});if(m.isGecko){v.dom.bind(v.getDoc(),"DOMNodeInserted",function(t){var s;t=t.target;if(t.nodeType===1&&t.nodeName==="IMG"&&(s=t.getAttribute("_mce_src"))){t.src=v.documentBaseURI.toAbsolute(s)}})}if(a){function p(){var B=this,D=B.getDoc(),C=B.settings;if(a&&!C.readonly){if(B._isHidden()){try{if(!C.content_editable){D.designMode="On"}}catch(A){}}try{D.execCommand("styleWithCSS",0,false)}catch(A){if(!B._isHidden()){try{D.execCommand("useCSS",0,true)}catch(A){}}}if(!C.table_inline_editing){try{D.execCommand("enableInlineTableEditing",false,false)}catch(A){}}if(!C.object_resizing){try{D.execCommand("enableObjectResizing",false,false)}catch(A){}}}}v.onBeforeExecCommand.add(p);v.onMouseDown.add(p)}if(m.isWebKit){v.onClick.addToTop(function(s,B){B=B.target;if(B.nodeName=="IMG"){var t=v.dom.nodeIndex(B);var A=B.parentNode;v.selection.getSel().setBaseAndExtent(A,t,A,t+1);v.nodeChanged()}else{if(B.nodeName=="A"&&v.dom.hasClass(B,"mceItemAnchor")){v.selection.getSel().setBaseAndExtent(B,0,B,1);v.nodeChanged()}}})}v.onMouseUp.add(v.nodeChanged);v.onKeyUp.add(function(s,t){var A=t.keyCode;if((A>=33&&A<=36)||(A>=37&&A<=40)||A==13||A==45||A==46||A==8||(m.isMac&&(A==91||A==93))||t.ctrlKey){v.nodeChanged()}});v.onReset.add(function(){v.setContent(v.startContent,{format:"raw"})});if(y.custom_shortcuts){if(y.custom_undo_redo_keyboard_shortcuts){v.addShortcut("ctrl+z",v.getLang("undo_desc"),"Undo");v.addShortcut("ctrl+shift+z",v.getLang("redo_desc"),"Redo");v.addShortcut("ctrl+y",v.getLang("redo_desc"),"Redo")}v.addShortcut("ctrl+b",v.getLang("bold_desc"),"Bold");v.addShortcut("ctrl+i",v.getLang("italic_desc"),"Italic");v.addShortcut("ctrl+u",v.getLang("underline_desc"),"Underline");for(u=1;u<=6;u++){v.addShortcut("ctrl+"+u,"",["FormatBlock",false,"h"+u])}v.addShortcut("ctrl+7","",["FormatBlock",false,"p"]);v.addShortcut("ctrl+8","",["FormatBlock",false,"div"]);v.addShortcut("ctrl+9","",["FormatBlock",false,"address"]);function z(t){var s=null;if(!t.altKey&&!t.ctrlKey&&!t.metaKey){return s}i(v.shortcuts,function(A){if(m.isMac&&A.ctrl!=t.metaKey&&A.ctrl!=t.ctrlKey){return}else{if(!m.isMac&&A.ctrl!=t.ctrlKey){return}}if(A.alt!=t.altKey){return}if(A.shift!=t.shiftKey){return}if(t.keyCode==A.keyCode||(t.charCode&&t.charCode==A.charCode)){s=A;return false}});return s}v.onKeyUp.add(function(s,t){var A=z(t);if(A){return j.cancel(t)}});v.onKeyPress.add(function(s,t){var A=z(t);if(A){return j.cancel(t)}});v.onKeyDown.add(function(s,t){var A=z(t);if(A){A.func.call(A.scope);return j.cancel(t)}})}if(m.isIE){v.dom.bind(v.getDoc(),"controlselect",function(A){var t=v.resizeInfo,s;A=A.target;if(A.nodeName!=="IMG"){return}if(t){v.dom.unbind(t.node,t.ev,t.cb)}if(!v.dom.hasClass(A,"mceItemNoResize")){ev="resizeend";s=v.dom.bind(A,ev,function(C){var B;C=C.target;if(B=v.dom.getStyle(C,"width")){v.dom.setAttrib(C,"width",B.replace(/[^0-9%]+/g,""));v.dom.setStyle(C,"width","")}if(B=v.dom.getStyle(C,"height")){v.dom.setAttrib(C,"height",B.replace(/[^0-9%]+/g,""));v.dom.setStyle(C,"height","")}})}else{ev="resizestart";s=v.dom.bind(A,"resizestart",j.cancel,j)}t=v.resizeInfo={node:A,ev:ev,cb:s}});v.onKeyDown.add(function(s,t){switch(t.keyCode){case 8:if(v.selection.getRng().item){s.dom.remove(v.selection.getRng().item(0));return j.cancel(t)}}})}if(m.isOpera){v.onClick.add(function(s,t){j.prevent(t)})}if(y.custom_undo_redo){function q(){v.undoManager.typing=0;v.undoManager.deleting=0;v.undoManager.add()}v.dom.bind(v.getDoc(),"focusout",function(s){if(!v.removed&&(v.undoManager.typing||v.undoManager.deleting)){q()}});v.onKeyUp.add(function(s,t){if((t.keyCode>=33&&t.keyCode<=36)||(t.keyCode>=37&&t.keyCode<=40)||t.keyCode==13||t.keyCode==45||t.ctrlKey){q()}});v.onKeyDown.add(function(t,D){var s,C,B;if(b&&D.keyCode==46){s=v.selection.getRng();if(s.parentElement){C=s.parentElement();if(D.ctrlKey){s.moveEnd("word",1);s.select()}v.selection.getSel().clear();if(s.parentElement()==C){B=v.selection.getBookmark();try{C.innerHTML=C.innerHTML}catch(A){}v.selection.moveToBookmark(B)}D.preventDefault()}}if((D.keyCode>=33&&D.keyCode<=36)||(D.keyCode>=37&&D.keyCode<=40)||D.keyCode==13||D.keyCode==45){if(v.undoManager.typing||v.undoManager.deleting){q()}return}if(D.keyCode==8||D.keyCode==46){if(!v.undoManager.deleting){q();v.undoManager.deleting=1}return}if(!v.undoManager.typing){q();v.undoManager.typing=1}});v.onMouseDown.add(function(){if(v.undoManager.typing||v.undoManager.deleting){q()}})}},_isHidden:function(){var p;if(!a){return 0}p=this.selection.getSel();return(!p||!p.rangeCount||p.rangeCount==0)},_fixNesting:function(q){var r=[],p;q=q.replace(/<(\/)?([^\s>]+)[^>]*?>/g,function(t,s,v){var u;if(s==="/"){if(!r.length){return""}if(v!==r[r.length-1].tag){for(p=r.length-1;p>=0;p--){if(r[p].tag===v){r[p].close=1;break}}return""}else{r.pop();if(r.length&&r[r.length-1].close){t=t+"</"+r[r.length-1].tag+">";r.pop()}}}else{if(/^(br|hr|input|meta|img|link|param)$/i.test(v)){return t}if(/\/>$/.test(t)){return t}r.push({tag:v})}return t});for(p=r.length-1;p>=0;p--){q+="</"+r[p].tag+">"}return q}})})(tinymce);(function(c){var d=c.each,e,a=true,b=false;c.EditorCommands=function(n){var l=n.dom,p=n.selection,j={state:{},exec:{},value:{}},k=n.settings,o;function q(y,x,v){var u;y=y.toLowerCase();if(u=j.exec[y]){u(y,x,v);return a}return b}function m(v){var u;v=v.toLowerCase();if(u=j.state[v]){return u(v)}return -1}function h(v){var u;v=v.toLowerCase();if(u=j.value[v]){return u(v)}return b}function t(u,v){v=v||"exec";d(u,function(y,x){d(x.toLowerCase().split(","),function(z){j[v][z]=y})})}c.extend(this,{execCommand:q,queryCommandState:m,queryCommandValue:h,addCommands:t});function f(x,v,u){if(v===e){v=b}if(u===e){u=null}return n.getDoc().execCommand(x,v,u)}function s(u){return n.formatter.match(u)}function r(u,v){n.formatter.toggle(u,v?{value:v}:e)}function i(u){o=p.getBookmark(u)}function g(){p.moveToBookmark(o)}t({"mceResetDesignMode,mceBeginUndoLevel":function(){},"mceEndUndoLevel,mceAddUndoLevel":function(){n.undoManager.add()},"Cut,Copy,Paste":function(y){var x=n.getDoc(),u;try{f(y)}catch(v){u=a}if(u||!x.queryCommandSupported(y)){if(c.isGecko){n.windowManager.confirm(n.getLang("clipboard_msg"),function(z){if(z){open("http://www.mozilla.org/editor/midasdemo/securityprefs.html","_blank")}})}else{n.windowManager.alert(n.getLang("clipboard_no_support"))}}},unlink:function(u){if(p.isCollapsed()){p.select(p.getNode())}f(u);p.collapse(b)},"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull":function(u){var v=u.substring(7);d("left,center,right,full".split(","),function(x){if(v!=x){n.formatter.remove("align"+x)}});r("align"+v)},"InsertUnorderedList,InsertOrderedList":function(x){var u,v;f(x);u=l.getParent(p.getNode(),"ol,ul");if(u){v=u.parentNode;if(/^(H[1-6]|P|ADDRESS|PRE)$/.test(v.nodeName)){i();l.split(v,u);g()}}},"Bold,Italic,Underline,Strikethrough":function(u){r(u)},"ForeColor,HiliteColor,FontName":function(x,v,u){r(x,u)},FontSize:function(y,x,v){var u,z;if(v>=1&&v<=7){z=c.explode(k.font_size_style_values);u=c.explode(k.font_size_classes);if(u){v=u[v-1]||v}else{v=z[v-1]||v}}r(y,v)},RemoveFormat:function(v){n.formatter.remove(v);if(c.isWebKit){var u=$j("table",c.activeEditor.getBody());u.css("display","inline-table");setTimeout(function(){u.css("display","")},0)}},mceBlockQuote:function(u){r("blockquote")},FormatBlock:function(x,v,u){return r(u||"p")},mceCleanup:function(){var u=p.getBookmark();n.setContent(n.getContent({cleanup:a}),{cleanup:a});p.moveToBookmark(u)},mceRemoveNode:function(y,x,v){var u=v||p.getNode();if(u!=n.getBody()){i();n.dom.remove(u,a);g()}},mceSelectNodeDepth:function(y,x,v){var u=0;l.getParent(p.getNode(),function(z){if(z.nodeType==1&&u++==v){p.select(z);return b}},n.getBody())},mceSelectNode:function(x,v,u){p.select(u)},mceInsertContent:function(x,v,u){p.setContent(u)},mceInsertRawHTML:function(x,v,u){p.setContent("tiny_mce_marker");n.setContent(n.getContent().replace(/tiny_mce_marker/g,u))},mceSetContent:function(x,v,u){n.setContent(u)},"Indent,Outdent":function(y){var v,u,x;v=k.indentation;u=/[a-z%]+$/i.exec(v);v=parseInt(v);if(!m("InsertUnorderedList")&&!m("InsertOrderedList")){d(p.getSelectedBlocks(),function(z){if(y=="outdent"){x=Math.max(0,parseInt(z.style.paddingLeft||0)-v);l.setStyle(z,"paddingLeft",x?x+u:"")}else{l.setStyle(z,"paddingLeft",(parseInt(z.style.paddingLeft||0)+v)+u)}})}else{f(y)}},mceRepaint:function(){var v;if(c.isGecko){try{i(a);if(p.getSel()){p.getSel().selectAllChildren(n.getBody())}p.collapse(a);g()}catch(u){}}},mceToggleFormat:function(x,v,u){n.formatter.toggle(u)},InsertHorizontalRule:function(){p.setContent("<hr />")},mceToggleVisualAid:function(){n.hasVisual=!n.hasVisual;n.addVisual()},mceReplaceContent:function(x,v,u){p.setContent(u.replace(/\{\$selection\}/g,p.getContent({format:"text"})))},mceInsertLink:function(y,x,v){var u=l.getParent(p.getNode(),"a");if(c.is(v,"string")){v={href:v}}if(!u){f("CreateLink",b,"javascript:mctmp(0);");d(l.select("a[href=javascript:mctmp(0);]"),function(z){l.setAttribs(z,v)})}else{if(v.href){l.setAttribs(u,v)}else{n.dom.remove(u,a)}}},selectAll:function(){var v=l.getRoot(),u=l.createRng();u.setStart(v,0);u.setEnd(v,v.childNodes.length);n.selection.setRng(u)}});t({"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull":function(u){return s("align"+u.substring(7))},"Bold,Italic,Underline,Strikethrough":function(u){return s(u)},mceBlockQuote:function(){return s("blockquote")},Outdent:function(){var u;if(k.inline_styles){if((u=l.getParent(p.getStart(),l.isBlock))&&parseInt(u.style.paddingLeft)>0){return a}if((u=l.getParent(p.getEnd(),l.isBlock))&&parseInt(u.style.paddingLeft)>0){return a}}return m("InsertUnorderedList")||m("InsertOrderedList")||(!k.inline_styles&&!!l.getParent(p.getNode(),"BLOCKQUOTE"))},"InsertUnorderedList,InsertOrderedList":function(u){return l.getParent(p.getNode(),u=="insertunorderedlist"?"UL":"OL")}},"state");t({"FontSize,FontName":function(x){var v=0,u;if(u=l.getParent(p.getNode(),"span")){if(x=="fontsize"){v=u.style.fontSize}else{v=u.style.fontFamily.replace(/, /g,",").replace(/[\'\"]/g,"").toLowerCase()}}return v}},"value");if(k.custom_undo_redo){t({Undo:function(){n.undoManager.undo()},Redo:function(){n.undoManager.redo()}})}}})(tinymce);(function(b){var a=b.util.Dispatcher;b.UndoManager=function(e){var c,d=0,g=[];function f(){return b.trim(e.getContent({format:"raw",no_events:1}))}return c={typing:0,deleting:0,onAdd:new a(c),onUndo:new a(c),onRedo:new a(c),add:function(l){var h,j=e.settings,k;l=l||{};l.content=f();k=g[d];if(k&&k.content==l.content){if(d>0||g.length==1){return null}}if(j.custom_undo_redo_levels){if(g.length>j.custom_undo_redo_levels){for(h=0;h<g.length-1;h++){g[h]=g[h+1]}g.length--;d=g.length}}l.bookmark=e.selection.getBookmark(2,true);if(d<g.length-1){if(d==0){g=[]}else{g.length=d+1}}g.push(l);d=g.length-1;c.onAdd.dispatch(c,l);e.isNotDirty=0;return l},transparentChange:function(h){var j=f(),k=g[d];if(k&&k.content==j){if(d>0||g.length==1){var i=h();k.content=f();k.bookmark=e.selection.getBookmark(2,true);return i}}return h()},undo:function(){var j,h;if(c.typing||c.deleting){c.add();c.typing=0;c.deleting=0}if(d>0){j=g[--d];e.setContent(j.content,{format:"raw"});e.selection.moveToBookmark(j.bookmark);c.onUndo.dispatch(c,j)}return j},redo:function(){var h;if(d<g.length-1){h=g[++d];e.setContent(h.content,{format:"raw"});e.selection.moveToBookmark(h.bookmark);c.onRedo.dispatch(c,h)}return h},clear:function(){g=[];d=c.typing=c.deleting=0},hasUndo:function(){return d>0||c.typing||c.deleting},hasRedo:function(){return d<g.length-1}}}})(tinymce);(function(m){var k=m.dom.Event,c=m.isIE,a=m.isGecko,b=m.isOpera,j=m.each,i=m.extend,d=true,h=false;function l(p){var q,o,n;do{if(/^(SPAN|STRONG|B|EM|I|FONT|STRIKE|U)$/.test(p.nodeName)){if(q){o=p.cloneNode(false);o.appendChild(q);q=o}else{q=n=p.cloneNode(false)}q.removeAttribute("id")}}while(p=p.parentNode);if(q){return{wrapper:q,inner:n}}}function g(o,p){var n=p.ownerDocument.createRange();n.setStart(o.endContainer,o.endOffset);n.setEndAfter(p);return n.cloneContents().textContent.length==0}function f(o){o=o.innerHTML;o=o.replace(/<(img|hr|table|input|select|textarea)[ \>]/gi,"-");o=o.replace(/<[^>]+>/g,"");return o.replace(/[ \u00a0\t\r\n]+/g,"")==""}function e(p,r,n){var o,q;if(f(n)){o=r.getParent(n,"ul,ol");if(!r.getParent(o.parentNode,"ul,ol")){r.split(o,n);q=r.create("p",0,'<br _mce_bogus="1" />');r.replace(q,n);p.select(q,1)}return h}return d}m.create("tinymce.ForceBlocks",{ForceBlocks:function(o){var p=this,q=o.settings,r;p.editor=o;p.dom=o.dom;r=(q.forced_root_block||"p").toLowerCase();q.element=r.toUpperCase();o.onPreInit.add(p.setup,p);p.reOpera=new RegExp("(\\u00a0|&#160;|&nbsp;)</"+r+">","gi");p.rePadd=new RegExp("<p( )([^>]+)><\\/p>|<p( )([^>]+)\\/>|<p( )([^>]+)>[\\s&&[^\\u00a0]]+<\\/p>|<p><\\/p>|<p\\/>|<p>[\\s&&[^\\u00a0]]+<\\/p>".replace(/p/g,r),"gi");p.reNbsp2BR1=new RegExp("<p( )([^>]+)>[\\s\\u00a0]+<\\/p>|<p>[\\s\\u00a0]+<\\/p>".replace(/p/g,r),"gi");p.reNbsp2BR2=new RegExp("<%p()([^>]+)>(&nbsp;|&#160;)<\\/%p>|<%p>(&nbsp;|&#160;)<\\/%p>".replace(/%p/g,r),"gi");p.reBR2Nbsp=new RegExp("<p( )([^>]+)>\\s*<br \\/>\\s*<\\/p>|<p>\\s*<br \\/>\\s*<\\/p>".replace(/p/g,r),"gi");function n(s,t){if(b){t.content=t.content.replace(p.reOpera,"</"+r+">")}t.content=t.content.replace(p.rePadd,"<"+r+"$1$2$3$4$5$6>\u00a0</"+r+">");if(!c&&!b&&t.set){t.content=t.content.replace(p.reNbsp2BR1,"<"+r+"$1$2><br /></"+r+">");t.content=t.content.replace(p.reNbsp2BR2,"<"+r+"$1$2><br /></"+r+">")}else{t.content=t.content.replace(p.reBR2Nbsp,"<"+r+"$1$2>\u00a0</"+r+">")}}o.onBeforeSetContent.add(n);o.onPostProcess.add(n);if(q.forced_root_block){o.onInit.add(p.forceRoots,p);o.onSetContent.add(p.forceRoots,p);o.onBeforeGetContent.add(p.forceRoots,p)}},setup:function(){var o=this,n=o.editor,q=n.settings,u=n.dom,p=n.selection;if(q.forced_root_block){n.onBeforeExecCommand.add(o.forceRoots,o);n.onKeyUp.add(o.forceRoots,o);n.onPreProcess.add(o.forceRoots,o)}if(q.force_br_newlines){if(c){n.onKeyPress.add(function(s,t){var v;if(t.keyCode==13&&p.getNode().nodeName!="LI"){p.setContent('<br id="__" /> ',{format:"raw"});v=u.get("__");v.removeAttribute("id");p.select(v);p.collapse();return k.cancel(t)}})}}if(q.force_p_newlines){if(!c){n.onKeyPress.add(function(s,t){if(t.keyCode==13&&!t.shiftKey&&!o.insertPara(t)){k.cancel(t)}})}else{m.addUnload(function(){o._previousFormats=0});n.onKeyPress.add(function(s,t){o._previousFormats=0;if(t.keyCode==13&&!t.shiftKey&&s.selection.isCollapsed()&&q.keep_styles){o._previousFormats=l(s.selection.getStart())}});n.onKeyUp.add(function(t,x){if(x.keyCode==13&&!x.shiftKey){var v=t.selection.getStart(),s=o._previousFormats;if(!v.hasChildNodes()){v=u.getParent(v,u.isBlock);if(v){v.innerHTML="";if(o._previousFormats){v.appendChild(s.wrapper);s.inner.innerHTML="\uFEFF"}else{v.innerHTML="\uFEFF"}p.select(v,1);t.getDoc().execCommand("Delete",false,null)}}}})}if(a){n.onKeyDown.add(function(s,t){if((t.keyCode==8||t.keyCode==46)&&!t.shiftKey){o.backspaceDelete(t,t.keyCode==8)}})}}if(m.isWebKit){function r(t){var s=p.getRng(),v,z=u.create("div",null," "),y,x=u.getViewPort(t.getWin()).h;s.insertNode(v=u.create("br"));s.setStartAfter(v);s.setEndAfter(v);p.setRng(s);if(p.getSel().focusNode==v.previousSibling){p.select(u.insertAfter(u.doc.createTextNode("\u00a0"),v));p.collapse(d)}u.insertAfter(z,v);y=u.getPos(z).y;u.remove(z);if(y>x){t.getWin().scrollTo(0,y)}}n.onKeyPress.add(function(s,t){if(t.keyCode==13&&(t.shiftKey||(q.force_br_newlines&&!u.getParent(p.getNode(),"h1,h2,h3,h4,h5,h6,ol,ul")))){r(s);k.cancel(t)}})}if(c){if(q.element!="P"){n.onKeyPress.add(function(s,t){o.lastElm=p.getNode().nodeName});n.onKeyUp.add(function(t,v){var y,x=p.getNode(),s=t.getBody();if(s.childNodes.length===1&&x.nodeName=="P"){x=u.rename(x,q.element);p.select(x);p.collapse();t.nodeChanged()}else{if(v.keyCode==13&&!v.shiftKey&&o.lastElm!="P"){y=u.getParent(x,"p");if(y){u.rename(y,q.element);t.nodeChanged()}}}})}}},find:function(v,q,r){var p=this.editor,o=p.getDoc().createTreeWalker(v,4,null,h),u=-1;while(v=o.nextNode()){u++;if(q==0&&v==r){return u}if(q==1&&u==r){return v}}return -1},forceRoots:function(x,I){var z=this,x=z.editor,M=x.getBody(),J=x.getDoc(),P=x.selection,A=P.getSel(),B=P.getRng(),N=-2,v,G,o,p,K=-16777215;var L,q,O,F,C,u=M.childNodes,E,D,y;for(E=u.length-1;E>=0;E--){L=u[E];if(L.nodeType===1&&L.getAttribute("_mce_type")){q=null;continue}if(L.nodeType===3||(!z.dom.isBlock(L)&&L.nodeType!==8&&!/^(script|mce:script|style|mce:style)$/i.test(L.nodeName))){if(!q){if(L.nodeType!=3||/[^\s]/g.test(L.nodeValue)){if(N==-2&&B){if(!c){if(B.startContainer.nodeType==1&&(D=B.startContainer.childNodes[B.startOffset])&&D.nodeType==1){y=D.getAttribute("id");D.setAttribute("id","__mce")}else{if(x.dom.getParent(B.startContainer,function(n){return n===M})){G=B.startOffset;o=B.endOffset;N=z.find(M,0,B.startContainer);v=z.find(M,0,B.endContainer)}}}else{if(B.item){p=J.body.createTextRange();p.moveToElementText(B.item(0));B=p}p=J.body.createTextRange();p.moveToElementText(M);p.collapse(1);O=p.move("character",K)*-1;p=B.duplicate();p.collapse(1);F=p.move("character",K)*-1;p=B.duplicate();p.collapse(0);C=(p.move("character",K)*-1)-F;N=F-O;v=C}}q=x.dom.create(x.settings.forced_root_block);L.parentNode.replaceChild(q,L);q.appendChild(L)}}else{if(q.hasChildNodes()){q.insertBefore(L,q.firstChild)}else{q.appendChild(L)}}}else{q=null}}if(N!=-2){if(!c){q=M.getElementsByTagName(x.settings.element)[0];B=J.createRange();if(N!=-1){B.setStart(z.find(M,1,N),G)}else{B.setStart(q,0)}if(v!=-1){B.setEnd(z.find(M,1,v),o)}else{B.setEnd(q,0)}if(A){A.removeAllRanges();A.addRange(B)}}else{try{B=A.createRange();B.moveToElementText(M);B.collapse(1);B.moveStart("character",N);B.moveEnd("character",v);B.select()}catch(H){}}}else{if(!c&&(D=x.dom.get("__mce"))){if(y){D.setAttribute("id",y)}else{D.removeAttribute("id")}B=J.createRange();B.setStartBefore(D);B.setEndBefore(D);P.setRng(B)}}},getParentBlock:function(p){var o=this.dom;return o.getParent(p,o.isBlock)},insertPara:function(S){var G=this,x=G.editor,O=x.dom,T=x.getDoc(),X=x.settings,H=x.selection.getSel(),I=H.getRangeAt(0),W=T.body;var L,M,J,Q,P,u,p,v,A,o,E,V,q,z,K,N=O.getViewPort(x.getWin()),D,F,C;L=T.createRange();L.setStart(H.anchorNode,H.anchorOffset);L.collapse(d);M=T.createRange();M.setStart(H.focusNode,H.focusOffset);M.collapse(d);J=L.compareBoundaryPoints(L.START_TO_END,M)<0;Q=J?H.anchorNode:H.focusNode;P=J?H.anchorOffset:H.focusOffset;u=J?H.focusNode:H.anchorNode;p=J?H.focusOffset:H.anchorOffset;if(Q===u&&/^(TD|TH)$/.test(Q.nodeName)){if(Q.firstChild.nodeName=="BR"){O.remove(Q.firstChild)}if(Q.childNodes.length==0){x.dom.add(Q,X.element,null,"<br />");V=x.dom.add(Q,X.element,null,"<br />")}else{K=Q.innerHTML;Q.innerHTML="";x.dom.add(Q,X.element,null,K);V=x.dom.add(Q,X.element,null,"<br />")}I=T.createRange();I.selectNodeContents(V);I.collapse(1);x.selection.setRng(I);return h}if(Q==W&&u==W&&W.firstChild&&x.dom.isBlock(W.firstChild)){Q=u=Q.firstChild;P=p=0;L=T.createRange();L.setStart(Q,0);M=T.createRange();M.setStart(u,0)}Q=Q.nodeName=="HTML"?T.body:Q;Q=Q.nodeName=="BODY"?Q.firstChild:Q;u=u.nodeName=="HTML"?T.body:u;u=u.nodeName=="BODY"?u.firstChild:u;v=G.getParentBlock(Q);A=G.getParentBlock(u);o=v?v.nodeName:X.element;if(K=G.dom.getParent(v,"li,pre")){if(K.nodeName=="LI"){return e(x.selection,G.dom,K)}return d}if(v&&(v.nodeName=="CAPTION"||/absolute|relative|fixed/gi.test(O.getStyle(v,"position",1)))){o=X.element;v=null}if(A&&(A.nodeName=="CAPTION"||/absolute|relative|fixed/gi.test(O.getStyle(v,"position",1)))){o=X.element;A=null}if(/(TD|TABLE|TH|CAPTION)/.test(o)||(v&&o=="DIV"&&/left|right/gi.test(O.getStyle(v,"float",1)))){o=X.element;v=A=null}E=(v&&v.nodeName==o)?v.cloneNode(0):x.dom.create(o);V=(A&&A.nodeName==o)?A.cloneNode(0):x.dom.create(o);V.removeAttribute("id");if(/^(H[1-6])$/.test(o)&&g(I,v)){V=x.dom.create(X.element)}K=q=Q;do{if(K==W||K.nodeType==9||G.dom.isBlock(K)||/(TD|TABLE|TH|CAPTION)/.test(K.nodeName)){break}q=K}while((K=K.previousSibling?K.previousSibling:K.parentNode));K=z=u;do{if(K==W||K.nodeType==9||G.dom.isBlock(K)||/(TD|TABLE|TH|CAPTION)/.test(K.nodeName)){break}z=K}while((K=K.nextSibling?K.nextSibling:K.parentNode));if(q.nodeName==o){L.setStart(q,0)}else{L.setStartBefore(q)}L.setEnd(Q,P);E.appendChild(L.cloneContents()||T.createTextNode(""));try{M.setEndAfter(z)}catch(R){}M.setStart(u,p);V.appendChild(M.cloneContents()||T.createTextNode(""));I=T.createRange();if(!q.previousSibling&&q.parentNode.nodeName==o){I.setStartBefore(q.parentNode)}else{if(L.startContainer.nodeName==o&&L.startOffset==0){I.setStartBefore(L.startContainer)}else{I.setStart(L.startContainer,L.startOffset)}}if(!z.nextSibling&&z.parentNode.nodeName==o){I.setEndAfter(z.parentNode)}else{I.setEnd(M.endContainer,M.endOffset)}I.deleteContents();if(b){x.getWin().scrollTo(0,N.y)}if(E.firstChild&&E.firstChild.nodeName==o){E.innerHTML=E.firstChild.innerHTML}if(V.firstChild&&V.firstChild.nodeName==o){V.innerHTML=V.firstChild.innerHTML}if(f(E)){E.innerHTML="<br />"}function U(y,s){var r=[],Z,Y,t;y.innerHTML="";if(X.keep_styles){Y=s;do{if(/^(SPAN|STRONG|B|EM|I|FONT|STRIKE|U)$/.test(Y.nodeName)){Z=Y.cloneNode(h);O.setAttrib(Z,"id","");r.push(Z)}}while(Y=Y.parentNode)}if(r.length>0){for(t=r.length-1,Z=y;t>=0;t--){Z=Z.appendChild(r[t])}r[0].innerHTML=b?"&nbsp;":"<br />";return r[0]}else{y.innerHTML=b?"&nbsp;":"<br />"}}if(f(V)){C=U(V,u)}if(b&&parseFloat(opera.version())<9.5){I.insertNode(E);I.insertNode(V)}else{I.insertNode(V);I.insertNode(E)}V.normalize();E.normalize();function B(r){return T.createTreeWalker(r,NodeFilter.SHOW_TEXT,null,h).nextNode()||r}I=T.createRange();I.selectNodeContents(a?B(C||V):C||V);I.collapse(1);H.removeAllRanges();H.addRange(I);D=x.dom.getPos(V).y;F=V.clientHeight;if(D<N.y||D+F>N.y+N.h){x.getWin().scrollTo(0,D<N.y?D:D-N.h+25)}return h},backspaceDelete:function(v,C){var D=this,u=D.editor,z=u.getBody(),s=u.dom,q,x=u.selection,p=x.getRng(),y=p.startContainer,q,A,B,o;if(!C&&p.collapsed&&y.nodeType==1&&p.startOffset==y.childNodes.length){o=new m.dom.TreeWalker(y.lastChild,y);for(q=y.lastChild;q;q=o.prev()){if(q.nodeType==3){p.setStart(q,q.nodeValue.length);p.collapse(true);x.setRng(p);return}}}if(y&&u.dom.isBlock(y)&&!/^(TD|TH)$/.test(y.nodeName)&&C){if(y.childNodes.length==0||(y.childNodes.length==1&&y.firstChild.nodeName=="BR")){q=y;while((q=q.previousSibling)&&!u.dom.isBlock(q)){}if(q){if(y!=z.firstChild){A=u.dom.doc.createTreeWalker(q,NodeFilter.SHOW_TEXT,null,h);while(B=A.nextNode()){q=B}p=u.getDoc().createRange();p.setStart(q,q.nodeValue?q.nodeValue.length:0);p.setEnd(q,q.nodeValue?q.nodeValue.length:0);x.setRng(p);u.dom.remove(y)}return k.cancel(v)}}}}})})(tinymce);(function(c){var b=c.DOM,a=c.dom.Event,d=c.each,e=c.extend;c.create("tinymce.ControlManager",{ControlManager:function(f,j){var h=this,g;j=j||{};h.editor=f;h.controls={};h.onAdd=new c.util.Dispatcher(h);h.onPostRender=new c.util.Dispatcher(h);h.prefix=j.prefix||f.id+"_";h._cls={};h.onPostRender.add(function(){d(h.controls,function(i){i.postRender()})})},get:function(f){return this.controls[this.prefix+f]||this.controls[f]},setActive:function(h,f){var g=null;if(g=this.get(h)){g.setActive(f)}return g},setDisabled:function(h,f){var g=null;if(g=this.get(h)){g.setDisabled(f)}return g},add:function(g){var f=this;if(g){f.controls[g.id]=g;f.onAdd.dispatch(g,f)}return g},createControl:function(i){var h,g=this,f=g.editor;d(f.plugins,function(j){if(j.createControl){h=j.createControl(i,g);if(h){return false}}});switch(i){case"|":case"separator":return g.createSeparator()}if(!h&&f.buttons&&(h=f.buttons[i])){return g.createButton(i,h)}return g.add(h)},createDropMenu:function(f,n,h){var m=this,i=m.editor,j,g,k,l;n=e({"class":"mceDropDown",constrain:i.settings.constrain_menus},n);n["class"]=n["class"]+" "+i.getParam("skin")+"Skin";if(k=i.getParam("skin_variant")){n["class"]+=" "+i.getParam("skin")+"Skin"+k.substring(0,1).toUpperCase()+k.substring(1)}f=m.prefix+f;l=h||m._cls.dropmenu||c.ui.DropMenu;j=m.controls[f]=new l(f,n);j.onAddItem.add(function(r,q){var p=q.settings;p.title=i.getLang(p.title,p.title);if(!p.onclick){p.onclick=function(o){if(p.cmd){i.execCommand(p.cmd,p.ui||false,p.value)}}}});i.onRemove.add(function(){j.destroy()});if(c.isIE){j.onShowMenu.add(function(){i.focus();g=i.selection.getBookmark(1)});j.onHideMenu.add(function(){if(g){i.selection.moveToBookmark(g);g=0}})}return m.add(j)},createListBox:function(m,i,l){var h=this,g=h.editor,j,k,f;if(h.get(m)){return null}i.title=g.translate(i.title);i.scope=i.scope||g;if(!i.onselect){i.onselect=function(n){g.execCommand(i.cmd,i.ui||false,n||i.value)}}i=e({title:i.title,"class":"mce_"+m,scope:i.scope,control_manager:h},i);m=h.prefix+m;if(g.settings.use_native_selects){k=new c.ui.NativeListBox(m,i)}else{f=l||h._cls.listbox||c.ui.ListBox;k=new f(m,i)}h.controls[m]=k;if(c.isWebKit){k.onPostRender.add(function(p,o){a.add(o,"mousedown",function(){g.bookmark=g.selection.getBookmark(1)});a.add(o,"focus",function(){g.selection.moveToBookmark(g.bookmark);g.bookmark=null})})}if(k.hideMenu){g.onMouseDown.add(k.hideMenu,k)}return h.add(k)},createButton:function(m,i,l){var h=this,g=h.editor,j,k,f;if(h.get(m)){return null}i.title=g.translate(i.title);i.label=g.translate(i.label);i.scope=i.scope||g;if(!i.onclick&&!i.menu_button){i.onclick=function(){g.execCommand(i.cmd,i.ui||false,i.value)}}i=e({title:i.title,"class":"mce_"+m,unavailable_prefix:g.getLang("unavailable",""),scope:i.scope,control_manager:h},i);m=h.prefix+m;if(i.menu_button){f=l||h._cls.menubutton||c.ui.MenuButton;k=new f(m,i);g.onMouseDown.add(k.hideMenu,k)}else{f=h._cls.button||c.ui.Button;k=new f(m,i)}return h.add(k)},createMenuButton:function(h,f,g){f=f||{};f.menu_button=1;return this.createButton(h,f,g)},createSplitButton:function(m,i,l){var h=this,g=h.editor,j,k,f;if(h.get(m)){return null}i.title=g.translate(i.title);i.scope=i.scope||g;if(!i.onclick){i.onclick=function(n){g.execCommand(i.cmd,i.ui||false,n||i.value)}}if(!i.onselect){i.onselect=function(n){g.execCommand(i.cmd,i.ui||false,n||i.value)}}i=e({title:i.title,"class":"mce_"+m,scope:i.scope,control_manager:h},i);m=h.prefix+m;f=l||h._cls.splitbutton||c.ui.SplitButton;k=h.add(new f(m,i));g.onMouseDown.add(k.hideMenu,k);return k},createColorSplitButton:function(f,n,h){var l=this,j=l.editor,i,k,m,g;if(l.get(f)){return null}n.title=j.translate(n.title);n.scope=n.scope||j;if(!n.onclick){n.onclick=function(o){if(c.isIE){g=j.selection.getBookmark(1)}j.execCommand(n.cmd,n.ui||false,o||n.value)}}if(!n.onselect){n.onselect=function(o){j.execCommand(n.cmd,n.ui||false,o||n.value)}}n=e({title:n.title,"class":"mce_"+f,menu_class:j.getParam("skin")+"Skin",scope:n.scope,more_colors_title:j.getLang("more_colors")},n);f=l.prefix+f;m=h||l._cls.colorsplitbutton||c.ui.ColorSplitButton;k=new m(f,n);j.onMouseDown.add(k.hideMenu,k);j.onRemove.add(function(){k.destroy()});if(c.isIE){k.onShowMenu.add(function(){j.focus();g=j.selection.getBookmark(1)});k.onHideMenu.add(function(){if(g){j.selection.moveToBookmark(g);g=0}})}return l.add(k)},createToolbar:function(k,h,j){var i,g=this,f;k=g.prefix+k;f=j||g._cls.toolbar||c.ui.Toolbar;i=new f(k,h);if(g.get(k)){return null}return g.add(i)},createSeparator:function(g){var f=g||this._cls.separator||c.ui.Separator;return new f()},setControlType:function(g,f){return this._cls[g.toLowerCase()]=f},destroy:function(){d(this.controls,function(f){f.destroy()});this.controls=null}})})(tinymce);(function(d){var a=d.util.Dispatcher,e=d.each,c=d.isIE,b=d.isOpera;d.create("tinymce.WindowManager",{WindowManager:function(f){var g=this;g.editor=f;g.onOpen=new a(g);g.onClose=new a(g);g.params={};g.features={}},open:function(z,h){var v=this,k="",n,m,i=v.editor.settings.dialog_type=="modal",q,o,j,g=d.DOM.getViewPort(),r;z=z||{};h=h||{};o=b?g.w:screen.width;j=b?g.h:screen.height;z.name=z.name||"mc_"+new Date().getTime();z.width=parseInt(z.width||320);z.height=parseInt(z.height||240);z.resizable=true;z.left=z.left||parseInt(o/2)-(z.width/2);z.top=z.top||parseInt(j/2)-(z.height/2);h.inline=false;h.mce_width=z.width;h.mce_height=z.height;h.mce_auto_focus=z.auto_focus;if(i){if(c){z.center=true;z.help=false;z.dialogWidth=z.width+"px";z.dialogHeight=z.height+"px";z.scroll=z.scrollbars||false}}e(z,function(p,f){if(d.is(p,"boolean")){p=p?"yes":"no"}if(!/^(name|url)$/.test(f)){if(c&&i){k+=(k?";":"")+f+":"+p}else{k+=(k?",":"")+f+"="+p}}});v.features=z;v.params=h;v.onOpen.dispatch(v,z,h);r=z.url||z.file;r=d._addVer(r);try{if(c&&i){q=1;window.showModalDialog(r,window,k)}else{q=window.open(r,z.name,k)}}catch(l){}if(!q){alert(v.editor.getLang("popup_blocked"))}},close:function(f){f.close();this.onClose.dispatch(this)},createInstance:function(i,h,g,m,l,k){var j=d.resolve(i);return new j(h,g,m,l,k)},confirm:function(h,f,i,g){g=g||window;f.call(i||this,g.confirm(this._decode(this.editor.getLang(h,h))))},alert:function(h,f,j,g){var i=this;g=g||window;g.alert(i._decode(i.editor.getLang(h,h)));if(f){f.call(j||i)}},resizeBy:function(f,g,h){h.resizeBy(f,g)},_decode:function(f){return d.DOM.decode(f).replace(/\\n/g,"\n")}})}(tinymce));(function(a){function b(){var d={},c={},e={};function f(j,i,h,g){if(typeof(i)=="string"){i=[i]}a.each(i,function(k){j[k.toLowerCase()]={func:h,scope:g}})}a.extend(this,{add:function(i,h,g){f(d,i,h,g)},addQueryStateHandler:function(i,h,g){f(c,i,h,g)},addQueryValueHandler:function(i,h,g){f(e,i,h,g)},execCommand:function(h,k,j,i,g){if(k=d[k.toLowerCase()]){if(k.func.call(h||k.scope,j,i,g)!==false){return true}}},queryCommandValue:function(){if(cmd=e[cmd.toLowerCase()]){return cmd.func.call(scope||cmd.scope,ui,value,args)}},queryCommandState:function(){if(cmd=c[cmd.toLowerCase()]){return cmd.func.call(scope||cmd.scope,ui,value,args)}}})}a.GlobalCommands=new b()})(tinymce);(function(a){a.Formatter=function(U){var L={},N=a.each,c=U.dom,p=U.selection,s=a.dom.TreeWalker,J=new a.dom.RangeUtils(c),d=U.schema.isValid,F=c.isBlock,k=U.settings.forced_root_block,r=c.nodeIndex,E="\uFEFF",e=/^(src|href|style)$/,R=false,B=true,o,O={apply:[],remove:[]};function z(V){return V instanceof Array}function l(W,V){return c.getParents(W,V,c.getRoot())}function b(V){return V.nodeType===1&&(V.face==="mceinline"||V.style.fontFamily==="mceinline")}function Q(V){return V?L[V]:L}function j(V,W){if(V){if(typeof(V)!=="string"){N(V,function(Y,X){j(X,Y)})}else{W=W.length?W:[W];N(W,function(X){if(X.deep===o){X.deep=!X.selector}if(X.split===o){X.split=!X.selector||X.inline}if(X.remove===o&&X.selector&&!X.inline){X.remove="none"}if(X.selector&&X.inline){X.mixed=true;X.block_expand=true}if(typeof(X.classes)==="string"){X.classes=X.classes.split(/\s+/)}});L[V]=W}}}function S(X,ad,Z){var aa=Q(X);if(aa==null){console.log("no such format: "+X);return}var ae=aa[0],ac,W,ab;function Y(ah){var ag=ah.startContainer,ak=ah.startOffset,aj,ai;if(ag.nodeType==1||ag.nodeValue===""){ag=ag.nodeType==1?ag.childNodes[ak]:ag;if(ag){aj=new s(ag,ag.parentNode);for(ai=aj.current();ai;ai=aj.next()){if(ai.nodeType==3&&!f(ai)){ah.setStart(ai,0);break}}}}return ah}function V(ah,ag){ag=ag||ae;if(ah){N(ag.styles,function(aj,ai){c.setStyle(ah,ai,q(aj,ad))});N(ag.attributes,function(aj,ai){c.setAttrib(ah,ai,q(aj,ad))});N(ag.classes,function(ai){ai=q(ai,ad);if(!c.hasClass(ah,ai)){c.addClass(ah,ai)}})}}function af(ah){var ag=[],ak,ai;ak=ae.inline||ae.block;ai=c.create(ak);V(ai);function aj(am){var al=0;N(am.childNodes,function(an){if(!f(an)&&!H(an)){al++}});return al}J.walk(ah,function(al){var am;function an(ao){var ar=ao.nodeName.toLowerCase(),aq=ao.parentNode.nodeName.toLowerCase(),ap;if((ao.nodeType==3&&ao.nodeValue=="")||(H(ao))){return}if(g(ar,"br")){am=0;if(ae.block){c.remove(ao)}return}if(ae.wrapper&&x(ao,X,ad)){am=0;return}if(ae.block&&!ae.wrapper&&G(ar)){ao=c.rename(ao,ak);V(ao);ag.push(ao);if(aj(ao)==0){ao.appendChild(c.create("br"))}am=0;return}if(ae.selector){N(aa,function(at){if(c.is(ao,at.selector)&&!b(ao)){V(ao,at);ap=true}});if(!ae.inline||ap){am=0;return}}if(d(ak,ar)&&d(aq,ak)){if(!am){am=ai.cloneNode(R);ao.parentNode.insertBefore(am,ao);ag.push(am)}am.appendChild(ao)}else{am=0;N(a.grep(ao.childNodes),an);am=0}if(ag.length==0&&v(ao.nodeName.toLowerCase())&&aj(ao)==0){am=ai.cloneNode(R);ao.appendChild(am);ag.push(am);while(ao.firstChild!=am){am.appendChild(ao.firstChild)}}}N(al,an)});console.log("newWrappers.length: "+ag.length);N(ag,function(an){var al;function am(ao){var aq,ap;N(ao.childNodes,function(ar){if(ar.nodeType==1&&!H(ar)&&!b(ar)){aq=ar;return R}});if(aq&&h(aq,ae)){ap=aq.cloneNode(R);V(ap);c.replace(ap,ao,B);c.remove(aq,1)}return ap||ao}al=aj(an);if(al===0&&!(an.parentNode&&v(an.parentNode.nodeName.toLowerCase()))){c.remove(an,1);return}if(ae.inline||ae.wrapper){if(!ae.exact&&al===1){an=am(an)}N(aa,function(ao){N(c.select(ao.inline,an),function(ap){T(ao,ad,ap,ao.exact?ap:null)})});if(x(an.parentNode,X,ad)){c.remove(an,1);an=0;return B}if(ae.merge_with_parents){c.getParent(an.parentNode,function(ao){if(x(ao,X,ad)){c.remove(an,1);an=0;return B}})}if(an){an=t(C(an),an);an=t(an,C(an,B))}}});U.onFormatChange.dispatch(ae,true)}if(ae){if(Z){W=c.createRng();W.setStartBefore(Z);W.setEndAfter(Z);af(n(W,aa))}else{if(!p.isCollapsed()||!ae.inline){ac=p.getBookmark();af(n(p.getRng(B),aa));p.moveToBookmark(ac);U.nodeChanged()}else{P("apply",X,ad)}}}}function A(X,ag,aa){var ab=Q(X),ai=ab[0],af,ae,W;function Z(al){var ak=al.startContainer,aq=al.startOffset,ap,ao,am,an;if(ak.nodeType==3&&aq>=ak.nodeValue.length-1){ak=ak.parentNode;aq=r(ak)+1}if(ak.nodeType==1){am=ak.childNodes;ak=am[Math.min(aq,am.length-1)];ap=new s(ak);if(aq>am.length-1){ap.next()}for(ao=ap.current();ao;ao=ap.next()){if(ao.nodeType==3&&!f(ao)){an=c.create("a",null,E);ao.parentNode.insertBefore(an,ao);al.setStart(ao,0);p.setRng(al);c.remove(an);return}}}}function Y(an){var am,al,ak;am=a.grep(an.childNodes);for(al=0,ak=ab.length;al<ak;al++){if(T(ab[al],ag,an,an)){break}}if(ai.deep){for(al=0,ak=am.length;al<ak;al++){Y(am[al])}}}function ac(ak){var al;N(l(ak.parentNode).reverse(),function(am){var an;if(!al&&am.id!="_start"&&am.id!="_end"){an=x(am,X,ag);if(an&&an.split!==false){al=am}}});return al}function V(an,ak,ap,at){var au,ar,aq,am,ao,al;if(an){al=an.parentNode;for(au=ak.parentNode;au&&au!=al;au=au.parentNode){ar=au.cloneNode(R);for(ao=0;ao<ab.length;ao++){if(T(ab[ao],ag,ar,ar)){ar=0;break}}if(ar){if(aq){ar.appendChild(aq)}if(!am){am=ar}aq=ar}}if(at&&(!ai.mixed||!F(an))){ak=c.split(an,ak)}if(aq){ap.parentNode.insertBefore(aq,ap);am.appendChild(ap)}}return ak}function ah(ak){return V(ac(ak),ak,ak,true)}function ad(am){var al=c.get(am?"_start":"_end"),ak=al[am?"firstChild":"lastChild"];if(H(ak)){ak=ak[am?"firstChild":"lastChild"]}c.remove(al,true);return ak}function aj(ak){var al,am;ak=n(ak,ab,B);if(ai.split){al=I(ak,B);am=I(ak);if(al!=am){al=M(al,"span",{id:"_start",_mce_type:"bookmark"});am=M(am,"span",{id:"_end",_mce_type:"bookmark"});ah(al);ah(am);al=ad(B);am=ad()}else{al=am=ah(al)}ak.startContainer=al.parentNode;ak.startOffset=r(al);ak.endContainer=am.parentNode;ak.endOffset=r(am)+1}J.walk(ak,function(an){N(an,function(ao){Y(ao)})});U.onFormatChange.dispatch(ai,false)}if(aa){W=c.createRng();W.setStartBefore(aa);W.setEndAfter(aa);aj(W);return}if(!p.isCollapsed()||!ai.inline){af=p.getBookmark();aj(p.getRng(B));p.moveToBookmark(af);if(i(X,ag,p.getStart())){Z(p.getRng(true))}U.nodeChanged()}else{P("remove",X,ag)}}function D(V,X,W){if(i(V,X,W)){A(V,X,W)}else{S(V,X,W)}}function x(W,V,ab,Z){var X=Q(V),ac,aa,Y;function ad(ah,aj,ak){var ag,ai,ae=aj[ak],af;if(ae){if(ae.length===o){for(ag in ae){if(ae.hasOwnProperty(ag)){if(ak==="attributes"){ai=c.getAttrib(ah,ag)}else{ai=K(ah,ag)}if(Z&&!ai&&!aj.exact){return}if((!Z||aj.exact)&&!g(ai,q(ae[ag],ab))){return}}}}else{for(af=0;af<ae.length;af++){if(ak==="attributes"?c.getAttrib(ah,ae[af]):K(ah,ae[af])){return aj}}}}return aj}if(X&&W){for(aa=0;aa<X.length;aa++){ac=X[aa];if(h(W,ac)&&ad(W,ac,"attributes")&&ad(W,ac,"styles")){if(Y=ac.classes){for(aa=0;aa<Y.length;aa++){if(!c.hasClass(W,Y[aa])){return}}}return ac}}}}function i(X,aa,Z){var W,Y;function V(ab){ab=c.getParent(ab,function(ac){return !!x(ac,X,aa,true)});return x(ab,X,aa)}if(Z){return V(Z)}if(p.isCollapsed()){for(Y=O.apply.length-1;Y>=0;Y--){if(O.apply[Y].name==X){return true}}for(Y=O.remove.length-1;Y>=0;Y--){if(O.remove[Y].name==X){return false}}return V(p.getNode())}Z=p.getNode();if(V(Z)){return B}W=p.getStart();if(W!=Z){if(V(W)){return B}}return R}function u(ac,ab){var Z,aa=[],Y={},X,W,V;if(p.isCollapsed()){for(W=0;W<ac.length;W++){for(X=O.remove.length-1;X>=0;X--){V=ac[W];if(O.remove[X].name==V){Y[V]=true;break}}}for(X=O.apply.length-1;X>=0;X--){for(W=0;W<ac.length;W++){V=ac[W];if(!Y[V]&&O.apply[X].name==V){Y[V]=true;aa.push(V)}}}}Z=p.getStart();c.getParent(Z,function(af){var ae,ad;for(ae=0;ae<ac.length;ae++){ad=ac[ae];if(!Y[ad]&&x(af,ad,ab)){Y[ad]=true;aa.push(ad)}}});return aa}function y(Z){var ab=Q(Z),Y,X,aa,W,V;if(ab){Y=p.getStart();X=l(Y);for(W=ab.length-1;W>=0;W--){V=ab[W].selector;if(!V){return B}for(aa=X.length-1;aa>=0;aa--){if(c.is(X[aa],V)){return B}}}}return R}a.extend(this,{get:Q,register:j,apply:S,remove:A,toggle:D,match:i,matchAll:u,matchNode:x,canApply:y});function h(V,W){if(g(V,W.inline)){return B}if(g(V,W.block)){return B}if(W.selector){return c.is(V,W.selector)}}function g(W,V){W=W||"";V=V||"";W=""+(W.nodeName||W);V=""+(V.nodeName||V);return W.toLowerCase()==V.toLowerCase()}function K(W,V){var X=c.getStyle(W,V);if(V=="color"||V=="backgroundColor"){X=c.toHex(X)}if(V=="fontWeight"&&X==700){X="bold"}return""+X}function q(V,W){if(typeof(V)!="string"){V=V(W)}else{if(W){V=V.replace(/%(\w+)/g,function(Y,X){return W[X]||Y})}}return V}function f(V){return V&&V.nodeType===3&&/^([\s\r\n]+|)$/.test(V.nodeValue)}function M(X,W,V){var Y=c.create(W,V);X.parentNode.insertBefore(Y,X);Y.appendChild(X);return Y}function n(V,ad,Y){var X=V.startContainer,aa=V.startOffset,ag=V.endContainer,ab=V.endOffset,af,ac;function ae(aj,ak,ah,ai){var al,am;ai=ai||c.getRoot();for(;;){al=aj.parentNode;if(al==ai||(!ad[0].block_expand&&F(al))){return aj}for(af=al[ak];af&&af!=aj;af=af[ah]){if(af.nodeType==1&&!H(af)){return aj}if(af.nodeType==3&&!f(af)){return aj}}aj=aj.parentNode}return aj}if(X.nodeType==1&&X.hasChildNodes()){ac=X.childNodes.length-1;X=X.childNodes[aa>ac?ac:aa];if(X.nodeType==3){aa=0}}if(ag.nodeType==1&&ag.hasChildNodes()){ac=ag.childNodes.length-1;ag=ag.childNodes[ab>ac?ac:ab-1];if(ag.nodeType==3){ab=ag.nodeValue.length}}if(H(X.parentNode)){X=X.parentNode}if(H(X)){X=X.nextSibling||X}if(H(ag.parentNode)){ag=ag.parentNode}if(H(ag)){ag=ag.previousSibling||ag}if(ad[0].inline||ad[0].block_expand){X=ae(X,"firstChild","nextSibling");ag=ae(ag,"lastChild","previousSibling")}if(ad[0].selector&&ad[0].expand!==R&&!ad[0].inline){function Z(ai,ah){var aj,ak,al;if(ai.nodeType==3&&ai.nodeValue.length==0&&ai[ah]){ai=ai[ah]}aj=l(ai);for(ak=0;ak<aj.length;ak++){for(al=0;al<ad.length;al++){if(c.is(aj[ak],ad[al].selector)){return aj[ak]}}}return ai}X=Z(X,"previousSibling");ag=Z(ag,"nextSibling")}if(ad[0].block||ad[0].selector){function W(ai,ah,ak){var aj;if(!ad[0].wrapper){aj=c.getParent(ai,ad[0].block)}if(!aj){aj=c.getParent(ai.nodeType==3?ai.parentNode:ai,F)}if(aj&&ad[0].wrapper){aj=l(aj,"ul,ol").reverse()[0]||aj}if(!aj){aj=ai;while(aj[ah]&&!F(aj[ah])){aj=aj[ah];if(g(aj,"br")){break}}}return aj||ai}X=W(X,"previousSibling");ag=W(ag,"nextSibling");if(ad[0].block){if(!F(X)){X=ae(X,"firstChild","nextSibling")}if(!F(ag)){ag=ae(ag,"lastChild","previousSibling")}}}if(X.nodeType==1){aa=r(X);X=X.parentNode}if(ag.nodeType==1){ab=r(ag)+1;ag=ag.parentNode}return{startContainer:X,startOffset:aa,endContainer:ag,endOffset:ab}}function T(ab,aa,Y,V){var X,W,Z;if(!h(Y,ab)){return R}if(ab.remove!="all"){N(ab.styles,function(ad,ac){ad=q(ad,aa);if(typeof(ac)==="number"){ac=ad;V=0}if(!V||g(K(V,ac),ad)){c.setStyle(Y,ac,"")}Z=1});if(Z&&c.getAttrib(Y,"style")==""){Y.removeAttribute("style");Y.removeAttribute("_mce_style")}N(ab.attributes,function(ae,ac){var ad;ae=q(ae,aa);if(typeof(ac)==="number"){ac=ae;V=0}if(!V||g(c.getAttrib(V,ac),ae)){if(ac=="class"){ae=c.getAttrib(Y,ac);if(ae){ad="";N(ae.split(/\s+/),function(af){if(/mce\w+/.test(af)){ad+=(ad?" ":"")+af}});if(ad){c.setAttrib(Y,ac,ad);return}}}if(ac=="class"){Y.removeAttribute("className")}if(e.test(ac)){Y.removeAttribute("_mce_"+ac)}Y.removeAttribute(ac)}});N(ab.classes,function(ac){ac=q(ac,aa);if(!V||c.hasClass(V,ac)){c.removeClass(Y,ac)}});W=c.getAttribs(Y);for(X=0;X<W.length;X++){if(W[X].nodeName.indexOf("_")!==0){return R}}}if(ab.remove!="none"){m(Y,ab);return B}}function m(X,Y){var V=X.parentNode,W;if(Y.block){if(!k){function Z(ab,aa,ac){ab=C(ab,aa,ac);return !ab||(ab.nodeName=="BR"||F(ab))}if(F(X)&&!F(V)){if(!Z(X,R)&&!Z(X.firstChild,B,1)){X.insertBefore(c.create("br"),X.firstChild)}if(!Z(X,B)&&!Z(X.lastChild,R,1)){X.appendChild(c.create("br"))}}}else{if(V==c.getRoot()){if(!Y.list_block||!g(X,Y.list_block)){N(a.grep(X.childNodes),function(aa){if(d(k,aa.nodeName.toLowerCase())){if(!W){W=M(aa,k)}else{W.appendChild(aa)}}else{W=0}})}}}}if(Y.selector&&Y.inline&&!g(Y.inline,X)){return}c.remove(X,1)}function C(W,V,X){if(W){V=V?"nextSibling":"previousSibling";for(W=X?W:W[V];W;W=W[V]){if(W.nodeType==1||!f(W)){return W}}}}function H(V){return V&&V.nodeType==1&&V.getAttribute("_mce_type")=="bookmark"}function t(Z,Y){var V,X,W;function ab(ae,ad){if(ae.nodeName!=ad.nodeName){return R}function ac(ag){var ah={};N(c.getAttribs(ag),function(ai){var aj=ai.nodeName.toLowerCase();if(aj.indexOf("_")!==0&&aj!=="style"){ah[aj]=c.getAttrib(ag,aj)}});return ah}function af(aj,ai){var ah,ag;for(ag in aj){if(aj.hasOwnProperty(ag)){ah=ai[ag];if(ah===o){return R}if(aj[ag]!=ah){return R}delete ai[ag]}}for(ag in ai){if(ai.hasOwnProperty(ag)){return R}}return B}if(!af(ac(ae),ac(ad))){return R}if(!af(c.parseStyle(c.getAttrib(ae,"style")),c.parseStyle(c.getAttrib(ad,"style")))){return R}return B}if(Z&&Y){function aa(ad,ac){for(X=ad;X;X=X[ac]){if(X.nodeType==3&&!f(X)){return ad}if(X.nodeType==1&&!H(X)){return X}}return ad}Z=aa(Z,"previousSibling");Y=aa(Y,"nextSibling");if(ab(Z,Y)){for(X=Z.nextSibling;X&&X!=Y;){W=X;X=X.nextSibling;Z.appendChild(W)}c.remove(Y);N(a.grep(Y.childNodes),function(ac){Z.appendChild(ac)});return Z}}return Y}function G(V){return/^(h[1-6]|p|div|pre|address|dl|dt|dd)$/.test(V)}function v(V){return/^(td|th|li|body)$/.test(V)}function I(W,Z){var V,Y,X;V=W[Z?"startContainer":"endContainer"];Y=W[Z?"startOffset":"endOffset"];if(V.nodeType==1){X=V.childNodes.length-1;if(!Z&&Y){Y--}V=V.childNodes[Y>X?X:Y]}return V}function P(ab,W,Z){var X,V=O[ab],ac=O[ab=="apply"?"remove":"apply"];function ad(){return O.apply.length||O.remove.length}function Y(){O.apply=[];O.remove=[]}function ae(ag){N(O.apply.reverse(),function(ah){S(ah.name,ah.vars,ag)});N(O.remove.reverse(),function(ah){A(ah.name,ah.vars,ag)});c.remove(ag,1);Y()}for(X=V.length-1;X>=0;X--){if(V[X].name==W){return}}V.push({name:W,vars:Z});for(X=ac.length-1;X>=0;X--){if(ac[X].name==W){ac.splice(X,1)}}if(ad()){if(a.isIE){U.getDoc().execCommand("FontName",false,"mceinline")}else{var aa=c.create("span",{style:"font-family: mceinline"});var af=p.getRng(true);af.insertNode(aa);af.setStart(aa,0);af.collapse(true);p.setRng(af)}O.lastRng=p.getRng();N(c.select("font,span"),function(ah){var ag;if(b(ah)){ag=p.getBookmark();ae(ah);p.moveToBookmark(ag);U.nodeChanged()}});if(!O.isListening&&ad()){O.isListening=true;N("onKeyDown,onKeyUp,onKeyPress,onMouseUp".split(","),function(ag){U[ag].addToTop(function(ah,ai){if(ad()&&!a.dom.RangeUtils.compareRanges(O.lastRng,p.getRng())){N(c.select("font,span"),function(ak){var al,aj;if(b(ak)){al=ak.firstChild;if(al){ae(ak);aj=c.createRng();aj.setStart(al,al.nodeValue.length);aj.setEnd(al,al.nodeValue.length);p.setRng(aj);ah.nodeChanged()}else{c.remove(ak)}}});if(ai.type=="keyup"||ai.type=="mouseup"){Y()}}})})}}}}})(tinymce);tinymce.onAddEditor.add(function(e,a){var d,h,g,c=a.settings;if(c.inline_styles){h=e.explode(c.font_size_style_values);function b(j,i){g.replace(g.create("span",{style:i}),j,1)}d={font:function(j,i){b(i,{backgroundColor:i.style.backgroundColor,color:i.color,fontFamily:i.face,fontSize:h[parseInt(i.size)-1]})},u:function(j,i){b(i,{textDecoration:"underline"})},strike:function(j,i){b(i,{textDecoration:"line-through"})}};function f(i,j){g=i.dom;if(c.convert_fonts_to_spans){e.each(g.select("font,u,strike",j.node),function(k){d[k.nodeName.toLowerCase()](a.dom,k)})}}a.onPreProcess.add(f);a.onInit.add(function(){a.selection.onSetContent.add(f)})}});
;
tinyMCE.addI18n({en:{common:{edit_confirm:"Do you want to use the WYSIWYG mode for this textarea?",apply:"Apply",insert:"Insert",update:"Update",cancel:"Cancel",close:"Close",browse:"Browse",class_name:"Class",not_set:"-- Not set --",clipboard_msg:"Copy/Cut/Paste is not available in Mozilla and Firefox.\nDo you want more information about this issue?",clipboard_no_support:"Currently not supported by your browser, use keyboard shortcuts instead.",popup_blocked:"Sorry, but we have noticed that your popup-blocker has disabled a window that provides application functionality. You will need to disable popup blocking on this site in order to fully utilize this tool.",invalid_data:"Error: Invalid values entered, these are marked in red.",more_colors:"More colors"},contextmenu:{align:"Alignment",left:"Left",center:"Center",right:"Right",full:"Full"},insertdatetime:{date_fmt:"%Y-%m-%d",time_fmt:"%H:%M:%S",insertdate_desc:"Insert date",inserttime_desc:"Insert time",months_long:"January,February,March,April,May,June,July,August,September,October,November,December",months_short:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec",day_long:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday,Sunday",day_short:"Sun,Mon,Tue,Wed,Thu,Fri,Sat,Sun"},print:{print_desc:"Print"},preview:{preview_desc:"Preview"},directionality:{ltr_desc:"Direction left to right",rtl_desc:"Direction right to left"},layer:{insertlayer_desc:"Insert new layer",forward_desc:"Move forward",backward_desc:"Move backward",absolute_desc:"Toggle absolute positioning",content:"New layer..."},save:{save_desc:"Save",cancel_desc:"Cancel all changes"},nonbreaking:{nonbreaking_desc:"Insert non-breaking space character"},advhr:{advhr_desc:"Horizontal rule"},emotions:{emotions_desc:"Emotions"},searchreplace:{search_desc:"Find",replace_desc:"Find/Replace"},advimage:{image_desc:"Insert/edit image"},advlink:{link_desc:"Insert/edit link"},xhtmlxtras:{cite_desc:"Citation",abbr_desc:"Abbreviation",acronym_desc:"Acronym",del_desc:"Deletion",ins_desc:"Insertion",attribs_desc:"Insert/Edit Attributes"},style:{desc:"Edit CSS Style"},paste:{paste_text_desc:"Paste as Plain Text",paste_word_desc:"Paste from Word",selectall_desc:"Select All"},paste_dlg:{text_title:"Use CTRL+V on your keyboard to paste the text into the window.",text_linebreaks:"Keep linebreaks",word_title:"Use CTRL+V on your keyboard to paste the text into the window."},table:{desc:"Inserts a new table",row_before_desc:"Insert row before",row_after_desc:"Insert row after",delete_row_desc:"Delete row",col_before_desc:"Insert column before",col_after_desc:"Insert column after",delete_col_desc:"Remove column",split_cells_desc:"Split merged table cells",merge_cells_desc:"Merge table cells",row_desc:"Table row properties",cell_desc:"Table cell properties",props_desc:"Table properties",paste_row_before_desc:"Paste table row before",paste_row_after_desc:"Paste table row after",cut_row_desc:"Cut table row",copy_row_desc:"Copy table row",del:"Delete table",row:"Row",col:"Column",cell:"Cell"},autosave:{unload_msg:"The changes you made will be lost if you navigate away from this page."},fullscreen:{desc:"Toggle fullscreen mode"},media:{desc:"Insert / edit embedded media",edit:"Edit embedded media"},fullpage:{desc:"Document properties"},template:{desc:"Insert predefined template content"},visualchars:{desc:"Visual control characters on/off."},spellchecker:{desc:"Toggle spellchecker",menu:"Spellchecker settings",ignore_word:"Ignore word",ignore_words:"Ignore all",langs:"Languages",wait:"Please wait...",sug:"Suggestions",no_sug:"No suggestions",no_mpell:"No misspellings found."},pagebreak:{desc:"Insert page break."}}});
;
tinyMCE.addI18n('en.table',{
    desc:"Insert Table",
    row_up:"Move Row Up",
    row_down:"Move Row Down",
    col_left:"Move Column Left",
    col_right:"Move Column Right"
});
;
(function(){tinymce.create("tinymce.plugins.JiveListsPlugin",{lastList:null,lastPrevSib:null,fixLists:function(e){var b,c,a,i,h;function d(){var j=tinymce.activeEditor.dom;return j.create("br",{_moz_dirty:"",type:"_moz"})}function g(){var j=tinymce.activeEditor.dom;return j.create("p",{},"<br _moz_dirty='' type='_moz' />")}this.onBeforeFixLists.dispatch(e);var f=this;e.undoManager.transparentChange(function(){b=e.selection.getNode();var k=e.dom.getParent(b,"ol,ul");if(k!=null&&k.nodeType==1&&(k.nodeName.toLowerCase()=="ul"||k.nodeName.toLowerCase()=="ol")){h=k.parentNode;if(h.nodeName.toLowerCase()=="li"){a=h.parentNode;a.insertBefore(k,h.nextSibling);if(e.plugins.jiveselection.isEffectivelyEmpty(h)){a.removeChild(h)}e.selection.select(b);e.selection.collapse(true)}f.mergeConsecutiveLists(k)}b=e.dom.getParent(b,"li");if(b!=null&&b.nodeType==1&&b.nodeName.toLowerCase()=="li"){c=e.dom.getParent(b,"ol,ul");if(c!=null){if(tinymce.isGecko){for(var j=0;j<c.childNodes.length;j++){h=c.childNodes[j];if(h.nodeType==1&&h.nodeName.toLowerCase()=="li"&&h.childNodes.length==0){h.appendChild(d())}}}if(c.parentNode.nodeName.toLowerCase()=="p"){a=c.parentNode;e.dom.split(a,c);e.selection.select(b).collapse(true)}}}if(f.lastList!=null&&f.lastList.parentNode!=null){b=f.lastList.nextSibling;if(b!=null){if(b.nodeType==1&&b.nodeName.toLowerCase()=="br"){a=g();b.parentNode.insertBefore(a,b);b.parentNode.removeChild(b);i=a.childNodes[a.childNodes.length-1];e.selection.select(i);e.selection.collapse(true)}}}else{if(f.lastPrevSib!=null){b=f.lastPrevSib.nextSibling;if(b!=null){if(b.nodeType==1&&b.nodeName.toLowerCase()=="br"){a=g();b.parentNode.insertBefore(a,b);b.parentNode.removeChild(b);i=a.childNodes[a.childNodes.length-1];e.selection.select(i);e.selection.collapse(true)}}}}f.fixListTypes()});this.onAfterFixLists.dispatch(e)},fixListTypes:function(){var a=this.ed;$j("ul[type], ol[type]",a.getBody()).each(function(){a.plugins.jivelists.listTypeToStyle(this)})},mergeConsecutiveLists:function(c){while(true){var a=c.previousSibling;while(a!=null&&a.nodeType!=1){a=a.previousSibling}if(a!=null&&a.nodeName==c.nodeName){c=a}else{break}}var d=null;while(true){a=c.nextSibling;while(a!=null&&a.nodeType!=1){a=a.nextSibling}if(a!=null&&a.nodeName==c.nodeName){if(!d){try{d=this.ed.selection.getBookmark()}catch(b){console.log("Failed to set bookmark before reparenting.  Hopefully it doesn't matter.",b)}}this.reparentChildren(c,a);a.parentNode.removeChild(a)}else{break}}if(d){this.ed.selection.moveToBookmark(d)}return c},reparentChildren:function(b,a){while(a.firstChild){b.appendChild(a.firstChild)}return b},indentSelectedItems:function(){var a=this.getExpandedLiRange(this.ed.selection.getRng(true));if(a){var c=this.ed.selection.getBookmark();var b=this.ed.getDoc().createElement(a.commonAncestorContainer.nodeName);a.surroundContents(b);this.ed.selection.moveToBookmark(c)}else{throw new Error("Unable to indent selection; probably not a list selection.")}},getExpandedLiRange:function(a){return this.ed.plugins.jiveselection.getExpandedBlockRange(a,"li","ul,ol")},rangeSplit:function(c){var a=c.commonAncestorContainer;if(a.nodeType==3){a=a.parentNode}var e=c.extractContents();var d=[];for(var g=e.firstChild;g!=null;g=g.nextSibling){d.push(g)}var b=this.ed.getDoc().createElement("br");b.className="splitMarker";if(c.startContainer.nodeType==3){var f=c.startContainer.splitText(c.startOffset);f.parentNode.insertBefore(b,f)}else{c.insertNode(b)}this.ed.dom.split(a,b,e);return d},shimIfIE:function(a,b){if(tinymce.isIE){$j('<p class="ieShim"> </p>',a.getDoc()).insertBefore(b)}},removeIEShims:function(a){$j(a.getBody()).find(".ieShim").remove()},execCommand:function(f,o,e){var g=tinyMCE.activeEditor;var h=this;function r(s){var u=s.selection.getNode();u=s.dom.getParent(u,"ol,ul");var b=s.dom.getParent(u,"blockquote");if(b!=null){var t=s.getDoc().createElement(u.nodeName);b.parentNode.insertBefore(t,b);while(b.childNodes.length){t.appendChild(b.childNodes[0])}b.parentNode.removeChild(b);s.selection.select(u)}}var d=g.selection.getNode();var k=null;while(d!=null&&d.parentNode!=null&&(d=g.dom.getParent(d.parentNode,"ol,ul"))!=null){k=d}d=k;if(d!=null){this.lastList=d;this.lastPrevSib=d.previousSibling}else{this.lastList=null;this.lastPrevSib=null}function q(u,t){t=t||tinyMCE.activeEditor;var n=t.selection.getBookmark(),s=u();if(tinymce.isWebKit){window.focus();t.focus()}t.selection.moveToBookmark(n);return s}function p(u){u=u.toLowerCase();var b=parseInt(f.substr("mceOLListStyle".length));var v=g.plugins.jivelists[u+"_styles"];var t=v[b];var w=g.selection.getNode();var s=g.dom.getParent(w,u);g.dom.setStyle(s,"listStyleType",t[1])}function c(A,C,w){var b=g.plugins.jiveselection.getExpandedBlockRange(g.selection.getRng(true).cloneRange(),C,w);var s;try{s=g.selection.getBookmark();function u(E){var H=g.dom.create(A);E.surroundContents(H);var G=[];for(var F=0;F<H.childNodes.length;++F){var I=H.childNodes[F];if(g.plugins.jiveselection.isBookmark(I)){G.push(I)}else{var D=g.dom.create("li");if(g.dom.isBlock(I)){g.dom.replace(D,I,true);if($j(I).css("text-align")!="left"){$j(D).css("text-align",$j(I).css("text-align"))}}else{E.setStart(H,F);E.setEnd(H,H.childNodes.length);E.surroundContents(D);F=H.childNodes.length}while(G.length>0){D.insertBefore(G.pop(),D.firstChild);--F}}}if(H.childNodes.length==0){H.appendChild(g.dom.create("li"))}H=h.mergeConsecutiveLists(H);return H}function x(F,E){var D=g.dom.createRng();var G=F;while(G!=null){F=G;if(F!=E){G=F.nextSibling}else{G=null}D.selectNodeContents(F);u(D)}}function B(D,E){var F=D;while(F){x(F.firstChild,F.lastChild);if(F==E){F=null}else{F=F.nextSibling}}}if(b.collapsed){var n=u(b);g.plugins.jiveselection.removeBookmark(s);var z=g.dom.createRng();z.setStart(n.firstChild,0);z.collapse(true);g.selection.setRng(z)}else{var v=b.startContainer.childNodes[b.startOffset];var t=b.endContainer.childNodes[b.endOffset-1];if(v.nodeName.toLowerCase()=="td"){x(v,t)}else{if(v.nodeName.toLowerCase()=="tr"){B(v,t)}else{u(b)}}g.selection.moveToBookmark(s)}}catch(y){console.log("failing over to execCommand",y);if(s){g.plugins.jiveselection.removeBookmark(s)}A=A.toLowerCase();if(A=="ul"){g.execCommand("InsertUnorderedList")}else{g.execCommand("InsertOrderedList")}}h.fixLists(g)}var k=this.getSelectionParent("ol,ul");if(f.indexOf("mceOLListStyle")==0){g.undoManager.add();p("ol");g.undoManager.add();return true}else{if(f.indexOf("mceULListStyle")==0){g.undoManager.add();p("ul");g.undoManager.add();return true}else{if(f=="mceOutdent"){g.undoManager.add();var a=g.selection;q(function(){try{var b=h.getExpandedLiRange(a.getRng(true));var u=h.rangeSplit(b);h.shimIfIE(g,u[0]);for(var t=0;t<u.length;++t){var w=u[t];if(w.parentNode.nodeName.toLowerCase()!="ul"&&w.parentNode.nodeName.toLowerCase()!="ol"){if(!g.plugins.jiveselection.isBookmark(w)){var v=g.getDoc().createElement("p");w.parentNode.insertBefore(v,w);if($j(w).css("text-align")!="left"){$j(v).css("text-align",$j(w).css("text-align"))}if(w.nodeType==1){h.reparentChildren(v,w);w.parentNode.removeChild(w)}else{v.appendChild(w)}}}}}catch(s){console.log("failing over to execCommand('Outdent')");h.shimIfIE(g,a.getNode());g.execCommand("Outdent");try{g.execCommand("mceOutdentComplete")}catch(s){if(console&&console.log){console.log("Outdent Complete failed",s)}}}h.fixLists(g)},g);h.removeIEShims(g);g.undoManager.add();return true}else{if(f=="mceIndent"){g.undoManager.add();try{this.indentSelectedItems();this.fixLists(g)}catch(j){console.log("failing over to execCommand('Indent')");g.execCommand("Indent");this.fixLists(g);r(g)}g.execCommand("mceIndentComplete");g.undoManager.add();return true}else{if(f.indexOf("mceInsertUnorderedList")==0){g.undoManager.add();if($j(k).is("ul")){g.execCommand("mceOutdent")}else{if($j(k).is("ol")){var m=g.selection.getBookmark(BOOKMARKTYPE);var i=this.getSelectionParent("ol");var l=g.getDoc().createElement("ul");$j(l).append($j(i).contents());i.parentNode.insertBefore(l,i);i.parentNode.removeChild(i);g.selection.moveToBookmark(m)}else{c("ul")}}g.undoManager.add();return true}else{if(f.indexOf("mceInsertOrderedList")==0){g.undoManager.add();if($j(k).is("ol")){g.execCommand("mceOutdent")}else{if($j(k).is("ul")){var m=g.selection.getBookmark(BOOKMARKTYPE);var i=this.getSelectionParent("ul");var l=g.getDoc().createElement("ol");$j(l).append($j(i).contents());i.parentNode.insertBefore(l,i);i.parentNode.removeChild(i);g.selection.moveToBookmark(m)}else{c("ol")}}g.undoManager.add();return true}}}}}}return false},getRangeParent:function(b,a){return this.ed.dom.getParent(b.commonAncestorContainer,a)},getSelectionParent:function(a){return this.getRangeParent(this.ed.selection.getRng(true),a)},cleanList:function(a,c){var b=this;this._stripStyleAndMetaTags(a,c);this._wrapListChildren(a,c);if(c.nodeType!=1){return}$j.each(c.childNodes,function(){b.cleanList(a,this)})},_stripStyleAndMetaTags:function(a,b){if(b.nodeType!=1){return}$j.each(b.childNodes,function(){if(this.nodeType&&this.nodeType!=1&&this.nodeType!=3||this.nodeType==1&&(this.nodeName.toLowerCase()=="meta"||this.nodeName.toLowerCase()=="style")){b.removeChild(this)}})},_wrapListChildren:function(a,b){$j(b).filter("ul, ol").each(function(){var c=this;$j.each(this.childNodes,function(){var d;if(this.nodeType==3&&$j.trim(this.nodeValue)===""){c.removeChild(this)}else{if(this.nodeType==3||(this.nodeType==1&&!$j(this).is("li, ul, ol"))){d=a.getDoc().createElement("li");c.insertBefore(d,this);d.appendChild(this)}}})})},hasNoTextNodes:function(c){if(c.nodeType==3){return c.nodeValue==""}var a=true;if(c.nodeType==1){for(var b=0;a&&b<c.childNodes.length;b++){a=a&&this.hasNoTextNodes(c.childNodes[b])}}return a},listTypeToStyle:function(a){if(!a||!a.nodeName||!/[uo]l/i.test(a.nodeName)){return}var b=tinyMCE.activeEditor;var d=a.getAttribute("type");var c=null;switch(d){case"1":c="decimal";break;case"A":c="upper-alpha";break;case"a":c="lower-alpha";break;case"I":c="upper-roman";break;case"i":c="lower-roman";break;default:if(d&&typeof(d)=="string"){d=d.toLowerCase();switch(d){case"circle":case"disc":case"square":c=d;break}}break}if(c){b.dom.setStyle(a,"listStyleType",c)}a.removeAttribute("type")},init:function(a,b){this.url=b;this.ed=a;var c=this;this.index=0;this.ol_styles=new Array();this.ol_styles.push(["default","",0]);this.ol_styles.push(["d","decimal",1]);if(!tinymce.isIE){this.ol_styles.push(["dz","decimal-leading-zero",2])}this.ol_styles.push(["ur","upper-roman",3]);this.ol_styles.push(["lr","lower-roman",4]);this.ol_styles.push(["ua","upper-alpha",5]);this.ol_styles.push(["la","lower-alpha",6]);if(!tinymce.isIE){this.ol_styles.push(["lg","lower-greek",7]);this.ol_styles.push(["ki","katakana-iroha",8]);this.ol_styles.push(["k","katakana",9]);this.ol_styles.push(["hii","hiragana-iroha",10]);this.ol_styles.push(["hi","hiragana",11]);this.ol_styles.push(["ci","cjk-ideographic",12]);this.ol_styles.push(["g","georgian",13]);this.ol_styles.push(["a","armenian",14]);this.ol_styles.push(["he","hebrew",15])}this.ul_styles=new Array();this.ul_styles.push(["default","",0]);this.ul_styles.push(["di","disc",1]);this.ul_styles.push(["c","circle",2]);this.ul_styles.push(["s","square",3]);a.onBeforeSetContent.add(function(d,e){if(tinymce.isIE){e.content=e.content.replace(/<br\/><\/li>/g,"</li>")}});a.onSetContent.add(function(){c.fixListTypes()});a.onNodeChange.add(function(d){if(this.initialized){this.fixLists(d);var f=d.selection.getNode();var g=d.dom.getParent(f,"ul,ol");if(g){var e=this;d.undoManager.transparentChange(function(){e.cleanList(d,g)})}}},this);this.onBeforeFixLists=new tinymce.util.Dispatcher();this.onAfterFixLists=new tinymce.util.Dispatcher();this.initialized=false;a.onBeforeGetContent.add(function(d){if(this.initialized){this.fixLists(d)}},this);a.onInit.add(function(){this.initialized=true;if(a.plugins.paste){a.plugins.paste.onPostProcess.add(function(){this.fixLists(a)},this)}if(a.plugins.jivecontextmenu){var g=a.plugins.jivecontextmenu;function e(v,u){u=u.toUpperCase();var p,o,q,m;if(u=="UL"){p=288;o=0;q=81;m=158}else{if(u=="OL"){p=260;o=0;q=81;m=135}}var r=[];for(var n=0;n<v.length;++n){var l=v[n][0];var t=n==0?p:q+(v[n][2]-1)*28;var s=n==0?o:m;r.push(new g.MenuItem(l+"ListStyle",null,a.getLang("jivelists."+l),{url:"../../../../../../images/tiny_mce3/themes/advanced/img/iconmaster.gif",xOffset:t,yOffset:s,width:28,height:23},"mce"+u+"ListStyle"+n))}return r}var k=e(this.ul_styles,"UL");var d=new g.Menu(k,true,true,a.getLang("jivelists.list_style_hdr"));var j=new g.MenuItem("ulItem",/ul/i,null,{url:"../../../../../../images/tiny_mce3/themes/advanced/img/iconmaster.gif",xOffset:288,yOffset:0,width:28,height:23},d);g.addRootItem(j);var i=e(this.ol_styles,"OL");var h=new g.Menu(i,true,true,a.getLang("jivelists.list_style_hdr"));var f=new g.MenuItem("olItem",/ol/i,null,{url:"../../../../../../images/tiny_mce3/themes/advanced/img/iconmaster.gif",xOffset:260,yOffset:0,width:28,height:23},h);g.addRootItem(f)}if(a.plugins.contextmenu){a.plugins.contextmenu.onContextMenu.add(function(l,o,q){var n,t,u,r,p,s;if(a.dom.getParent(q,"ol")){t=a.dom.getParent(q,"ol");u=a.dom.getParent(q,function(m){return $def(m.tagName)&&m.tagName.toLowerCase()=="ol"&&m!=t});o.addSeparator();n=o.addMenu({title:"jivelists.list_style",max_height:"200","class":"mceDropDown defaultSkin mceMacroMenu mceListBoxMenu"});r=a.plugins.jivelists.ol_styles;for(p=0;p<r.length;p++){if(u!=null||u==null&&r[p][0]!="inherit"){s="";if(t.style.listStyleType==r[p][1]){s="mceMenuItemSelected"}else{s=""}n.add({title:"jivelists."+r[p][0],cmd:"mceOLListStyle"+p,"class":s})}if(p==2){n.addSeparator()}}}else{if(a.dom.getParent(q,"ul")){t=a.dom.getParent(q,"ul");u=a.dom.getParent(q,function(m){return $def(m.tagName)&&m.tagName.toLowerCase()=="ul"&&m!=t});o.addSeparator();n=o.addMenu({title:"jivelists.list_style",max_height:"200","class":"mceDropDown defaultSkin mceMacroMenu mceListBoxMenu"});r=a.plugins.jivelists.ul_styles;for(p=0;p<r.length;p++){if(u!=null||u==null&&r[p][0]!="inherit"){s="";if(t.style.listStyleType==r[p][1]){s="mceMenuItemSelected"}else{s=""}n.add({title:"jivelists."+r[p][0],cmd:"mceULListStyle"+p,"class":s})}if(p==2){n.addSeparator()}}}}})}},this);this.prepForEnter=false;this.prepForDel=false;a.onKeyDown.addToTop(function(g,v){this.prepForEnter=false;this.prepForDel=false;this.prepForDelB=false;var h=g.plugins.jiveselection.isEffectivelyEmpty;var r=g.selection;var l=g.dom.getParent(r.getNode(),"li");var u=g.dom.getParent(r.getNode(),"ul,ol");if(v.keyCode==8&&r.isCollapsed()&&l){var n=g.plugins.jiveselection.atStartOf(l)||h(l);if(l!=null&&l.nodeType==1&&u!=null&&n){this.prepForDel=true;g.execCommand("mceOutdent");if(u.parentNode&&!u.firstChild){u.parentNode.removeChild(u)}tinymce.dom.Event.cancel(v);return false}}else{if(v.keyCode==46&&r.isCollapsed()){function s(y){var p=y.nextSibling;while(p){var e=p.nodeName.toLowerCase();if(e=="ul"||e=="ol"){p=p.firstChild}else{if(e=="table"){return null}else{if(g.dom.isBlock(p)){return p}else{return null}}}}if(y.nodeName.toLowerCase()!="body"){return s(y.parentNode)}return null}function q(e){while(e.lastChild&&e.lastChild.nodeName.toLowerCase()=="br"){e.removeChild(e.lastChild)}}if(l!=null){var d=g.plugins.jiveselection.atEndOf(l)||h(l);if(l.nodeType==1&&u!=null&&d){g.undoManager.add();var k=s(l);if(k){q(l);this.reparentChildren(l,k);k.parentNode.removeChild(k)}this.prepForDel=true;g.undoManager.add();tinymce.dom.Event.cancel(v);return false}}else{var w=g.dom.getParent(r.getNode(),function(e){return g.dom.isBlock(e)});if(w){k=s(w);if(k&&(g.plugins.jiveselection.atEndOf(w)||h(w))){g.undoManager.add();q(w);this.reparentChildren(w,k);var m=k.parentNode;k.parentNode.removeChild(k);while(h(m)){var f=m;m=m.parentNode;m.removeChild(f)}this.prepForDel=true;g.undoManager.add();tinymce.dom.Event.cancel(v);return false}}}}else{if(v.keyCode==13&&!v.shiftKey){if(l!=null&&l.nodeType==1&&l.nextSibling==null&&(l.childNodes.length==1||(tinymce.isIE&&l.childNodes.length==0))&&this.hasNoTextNodes(l)){this.prepForEnter=true;g.execCommand("mceOutdent");tinymce.dom.Event.cancel(v);return false}}else{if(v.keyCode==13&&v.shiftKey){var j=l?l:g.dom.getParent(r.getNode(),function(e){return g.dom.isBlock(e)});var i=r.getRng(true);if(i.collapsed){this.prepForEnter=true;g.undoManager.add();var x=g.getDoc().createElement("br");i.insertNode(x);i.setStart(j,g.dom.nodeIndex(x)+1);i.collapse(true);r.setRng(i);if(tinymce.isWebKit&&g.plugins.jiveselection.atEndOf(j)){j.appendChild(g.getDoc().createElement("br"))}g.undoManager.add();tinymce.dom.Event.cancel(v);return false}}else{if(v.keyCode==9&&!v.ctrlKey&&!v.altKey){var o=g.dom.getParent(g.selection.getNode(),"table,ul,ol");if(o!=null&&o.nodeName.toLowerCase()!="table"){try{if(v.shiftKey){g.execCommand("mceOutdent")}else{g.execCommand("mceIndent")}}catch(t){}return tinymce.dom.Event.cancel(v)}}}}}}},this);a.onKeyPress.add(function(d,g){if((g.keyCode==8||g.keyCode==46)&&this.prepForDel){tinymce.dom.Event.cancel(g);return false}if(g.keyCode==13&&this.prepForEnter){tinymce.dom.Event.cancel(g);return false}if(g.keyCode==9&&!g.ctrlKey&&!g.altKey){var f=d.dom.getParent(d.selection.getNode(),"table,ul,ol");if(f!=null&&f.nodeName.toLowerCase()!="table"){tinymce.dom.Event.cancel(g);return false}}},this);a.onKeyUp.add(function(d,f){if((f.keyCode==8||f.keyCode==46)&&this.prepForDel){tinymce.dom.Event.cancel(f);return false}if(f.keyCode==13&&this.prepForEnter){tinymce.dom.Event.cancel(f);return false}},this)},getInfo:function(){return{longname:"Jive Lists",author:"Jive Software",authorurl:"http://jivesoftware.com",infourl:"http://jivesoftware.com",version:tinyMCE.majorVersion+"."+tinyMCE.minorVersion}},createControl:function(b,a){return null}});tinymce.PluginManager.add("jivelists",tinymce.plugins.JiveListsPlugin)})();
;
tinyMCE.addI18n('en.jivelists',{
    list_style : 'List Style',
    inherit : "Inherit",
    none : "None",
    'default' : "Default",
    ur : "Upper Roman",
    lr : "Lower Roman",
    dz : "Decimal with Leading Zero",
    d  : "Decimal",
    ua : "Upper Alpha",
    la : "Lower Alpha",
    lg : "Lower Greek",
    ki : "Katakana-Iroha",
    hii: "Hiragana-Iroha",
    k  : "Katakana",
    hi : "Hiragana",
    ci : "Cjk-Ideographic",
    g  : "Georgian",
    a  : "Armenian",
    he : "Hebrew",
    s  : "Squares",
    c  : "Circles",
    di : "Discs"
});
;
(function(){tinymce.create("tinymce.plugins.JiveStylePlugin",{getInfo:function(){return{longname:"Image Picker",author:"Jive Software",authorurl:"http://www.jivesoftware.com",infourl:"http://www.jivesoftware.com/",version:"1.0"}},init:function(a,b){a.onInit.add(function(d){var c=document.getElementById(d.id+"_jivestyle_action");if(c){var e=c.childNodes[0];while(e.childNodes.length>0){e.removeChild(e.childNodes[0])}e.appendChild(document.createTextNode(d.getLang("jivestyle.title")))}d.plugins.jivebuttons.initToolbar(d.id);setTimeout(function(g,f){return function(){g.plugins.jivebuttons.initToolbar(f)}}(d,d.id),300)});a.onNodeChange.add(function(c){return function(j,m,f){var d=j.dom.getParent(f,j.dom.isBlock);if(d){if(c.buttons.length>0){var e=j.selection;for(var h=0;h<c.buttons.length;h++){var l=window.document;var g=new tinymce.dom.DOMUtils(l);var k=$def(d.tagName)&&d.tagName.toLowerCase()==c.tagNames[h];var q=l.getElementById(c.buttons[h].id);var o=q.cells[0];if(k&&(e.isCollapsed()||e.getStart()==e.getEnd())){g.addClass(o,"mceMenuItemSelected")}else{g.removeClass(o,"mceMenuItemSelected")}}}}}}(this));this.buttons=new Array();this.tagNames=["p","h1","h2","h3","h4","h5","h6"]},execCommand:function(d,c,e){if(d=="mceJiveStyle"){var a=tinyMCE.activeEditor.controlManager;var b=a.get("jivestyle");b.showMenu();return true}return false},isTag:function(b){var c=tinyMCE.activeEditor;var e=c.selection;if(e.isCollapsed()){var f=e.getNode();var d=c.dom.getParent(f,b);var a=$def(d)&&d!=null&&$def(d.tagName)&&d.tagName.toLowerCase()==b;if(a){return"mceMenuItemSelected"}else{return""}}else{return""}},addButton:function(a){this.buttons.push(a)},createControl:function(d,a){switch(d){case"jivestyle":var b=a.createSplitButton("jivestyle",{title:"jivestyle.title",cmd:"mceJiveStyle"});b.onRenderMenu.add(function(j,e){var f=tinyMCE.activeEditor;var h=f.plugins.jivestyle;h.addButton(e.add({title:"jivestyle.paragraph",cmd:"FormatBlock",ui:false,value:"p","class":"mce_formatPreview mce_p "+h.isTag("p")}));for(var g=1;f.settings.max_header_count>=g&&g<=6;++g){h.addButton(e.add({title:f.getLang("jivestyle.header")+" "+g,cmd:"FormatBlock",ui:false,value:"h"+g,"class":"mce_formatPreview mce_h"+g+" "+h.isTag("h"+g)}))}});return b}return null}});tinymce.PluginManager.add("jivestyle",tinymce.plugins.JiveStylePlugin)})();
;
tinyMCE.addI18n('en.jivestyle',{
    title : 'Style',
    paragraph : 'Paragraph',
    header : 'Header'
});

;
(function(){var a=new RegExp(/^[\s\f\n\r\t\v\u00A0\u2028\u2029\u0240]$/);tinymce.create("tinymce.plugins.JiveMacrosPlugin",{_cache:new jive.ext.y.HashTable(),cache:function(f,b,d,c){var e=this._cache.get(c);if(!e){e=new jive.ext.y.HashTable();this._cache.put(c,e)}e.put(f,[d,b])},getTitleFor:function(b,d){var c=this._cache.get(b);if(!c){return false}return c.get(d)},deleteMacro:function(h,d){if(window.jiveRTE&&window.jiveRTE.macroEle){d=window.jiveRTE.macroEle;window.jiveRTE.macroEle=null}if($def(h)&&$def(d)){if(d==h.getBody()){return}var f=new tinymce.dom.DOMUtils(h.getBody());var i=f.getParent(d,function(k){return k==h.getBody()||k!=d});if(this.isExactMacro(d)){var e=this.getMacroFor(d);if(e.getMacroType()=="INLINE"){while(d.childNodes.length>0){var g=d.removeChild(d.childNodes[0]);i.insertBefore(g,d)}}else{if(e.getMacroType()=="TEXT"||e.getMacroType()=="INLINE"){while(d.childNodes.length>0){var g=d.removeChild(d.childNodes[0]);if(g.nodeType==3){var j=g.nodeValue;while(j.indexOf("\n")>=0){var b=h.getDoc().createElement("P");b.appendChild(h.getDoc().createTextNode(j.substr(0,j.indexOf("\n"))));i.insertBefore(b,d);if(j.length>j.indexOf("\n")+1){j=j.substr(j.indexOf("\n")+1)}else{j=""}}if(j.length>0){var b=h.getDoc().createElement("P");b.appendChild(h.getDoc().createTextNode(j));i.insertBefore(b,d)}}else{i.insertBefore(g,d)}}}}i.removeChild(d)}else{this.deleteMacro(h,i)}return}var h=tinyMCE.activeEditor;var c=h.selection;this.deleteMacro(h,c.getNode())},getNextSibling:function(b,c){if(c==null){return c}if(c.nextSibling!=null){return c.nextSibling}if(c==b.getBody()&&c.nextSibling==null){return null}return this.getNextSibling(b,this.getParentNode(b,c))},getParentNode:function(b,c){return(new tinymce.dom.DOMUtils(b.getDoc())).getParent(c,function(d){return d==b.getBody()||d!=c})},ageTheNodes:function(g,c,e){function b(h,i){return $j(i).parents().andSelf().filter(function(){var k=$j(this).parent().has(h).length>0,j=$j(this).has(h).length>0;return k&&!j}).get(0)}var d=b(c,g),f=b(g,c);return[d,f]},shouldEndLine:function(b){if(b.nodeType!=3&&(b.tagName.toLowerCase()=="div"||b.tagName.toLowerCase()=="p"||b.tagName.toLowerCase()=="pre"||b.tagName.toLowerCase()=="br")){return true}return false},applyParameterSet:function(d,c,e){if(this.isMacro(d)){if(e.deleteAll){var f=c.getAllowedParameters();for(var b=0;b<f.length;b++){d.removeAttribute("_"+f[b].name)}}for(var b=0;b<e.params.length;b++){d.setAttribute("_"+e.params[b].name,e.params[b].value)}this.removeDuplicateMacros(tinyMCE.activeEditor,false)}},buildMacro:function(f,j,n){if(!$def(j)){j=0}var k=tinyMCE.activeEditor;var e=k.selection;var m=k.getDoc();var d=f.getName();var g;var h=e.isCollapsed();if(f.getMacroType()=="TEXT"){g=m.createElement("pre");g.setAttribute("class","jive_text_macro jive_macro_"+d);g.className="jive_text_macro jive_macro_"+d}else{if(f.getMacroType()=="INLINE"){g=m.createElement("span");g.appendChild(m.createTextNode(d));g.setAttribute("class","jive_macro jive_macro_"+d);g.className="jive_macro jive_macro_"+d}else{g=m.createElement("img");g.setAttribute("class","jive_macro jive_macro_"+d);g.className="jive_macro jive_macro_"+d;var c=window.parent.CS_RESOURCE_BASE_URL+"/images/tiny_mce3/plugins/jiveemoticons/images/spacer.gif";if(!n){g.setAttribute("src",c);g.setAttribute("_mce_src",c)}else{g.setAttribute("src",n);g.setAttribute("_mce_src",n)}}}g.setAttribute("jivemacro",d);var l;var i=null;if(!h&&f.getMacroType()=="TEXT"){var b=e.getRng(true);b=k.plugins.jiveselection.splitAtEndpoints(b);b.surroundContents(g)}else{h=true;l=this.getParentNode(k,e.getNode());i=e.getNode();if(l==i){i=null}}if(f.getMacroType()=="TEXT"&&g.childNodes.length==0){g.appendChild(this.createEmptyPara(k.getDoc()))}if(j!=null&&j>=0){var o=f.getParameterSets();if(j<o.length){var j=o[j];this.applyParameterSet(g,f,j)}}return g},insertMacro:function(i,e,h,k){var g=i.selection.isCollapsed();var f=this.buildMacro(e,h,k);var l=i.selection.getNode();if(g){if(e.getMacroType().toLowerCase()=="text"){if(l.nodeName.toLowerCase()=="body"||l.nodeName.toLowerCase()=="td"){l.appendChild(f)}else{this.insertAfter(l.parentNode,f,l)}if(f.childNodes.length){var d=f.childNodes[0];var j=true;if(d.childNodes.length==0){d.appendChild(i.getDoc().createElement("BR"));j=true}}var b=i.dom.createRng();b.setStart(f,0);b.collapse(true);i.selection.setRng(b)}else{f.setAttribute("id","__sel_me__");i.selection.setNode(f);f=i.getDoc().getElementById("__sel_me__");f.removeAttribute("id")}}this.removeDuplicateMacros(i,false);this.fixBodyParagraphs();if(f.childNodes.length&&f.parentNode&&e.getMacroType().toLowerCase()=="text"){b=i.dom.createRng();var c=f;do{c=c.childNodes[c.childNodes.length-1]}while(c.nodeType==1&&c.childNodes.length);b.setStart(c.parentNode,c.childNodes.length);b.collapse(true);i.selection.setRng(b);i.plugins.jiveselection.normalizeSelection();window.focus();i.focus()}return f},execCommand:function(f,o,d){var l=tinyMCE.activeEditor;if(f.indexOf("mceMacroParamSet")==0){l.undoManager.add();var k=f.substr("mceMacroParamSet".length);var g=parseInt(k.substr(0,k.indexOf("_")));var e=parseInt(k.substr(k.indexOf("_")+1));var j=jive.rte.macros[g].getParameterSets()[e];var c=l.selection.getNode();var i=l.dom.getParent(c,function(n){return $def(n.attributes.jivemacro)});if(i!=null){this.applyParameterSet(i,jive.rte.macros[g],j);l.selection.select(i)}return true}else{if(f.indexOf("mceAddJiveMacro")==0){l.undoManager.add();var m=f.substr("mceAddJiveMacro".length);var j=0;var p=m.indexOf("_");if(p>=0){j=parseInt(m.substr(p+1));m=parseInt(m.substr(0,p))}else{m=parseInt(m)}var b=l.selection;var r=l.getDoc();var g=jive.rte.macros[m];if(g.getUrl().length>0){window.jiveRTE={macro:g,paramSet:j};var q=l.windowManager.open({url:CS_BASE_URL+g.getUrl(),width:500,height:400,inline:1},window.jiveRTE)}else{var h=l.plugins.jivemacros.insertMacro(l,g,j)}return true}}return false},isFirst:function(b,c){if(b.childNodes.length==0){return false}return(b.childNodes[0]==c||this.isFirst(b.childNodes[0],c))},isLink:function(b){if(b==null||b.nodeName.toLowerCase()=="body"){return false}if($def(b)&&$obj(b)&&b!=null&&$def(b.nodeType)&&b.nodeType!=3){if(b.nodeName.toLowerCase()=="a"){return b}else{return this.isLink(b.parentNode)}}return false},isMacro:function(b){while(b!=null&&$obj(b)){if(b.nodeName.toLowerCase()=="body"){return false}if($def(b.nodeType)&&b.nodeType==1&&$def(b.attributes.jivemacro)){return b}b=b.parentNode}return false},isExactMacro:function(b){if(b==null||b.nodeName.toLowerCase()=="body"){return false}if(b!=null&&$obj(b)&&$def(b.nodeType)&&b.nodeType==1){if(b.nodeName.toLowerCase()=="pre"){return b}else{if($def(b.attributes.jivemacro)){return b}else{return false}}}return false},getMacroFor:function(c){var d=this.isMacro(c);if(d){var b=d.attributes.jivemacro.nodeValue;return tinymce.activeEditor.plugins.jiveutil.findMacro(b)}if(c.nodeName.toLowerCase()=="pre"){return tinymce.activeEditor.plugins.jiveutil.findMacro("quote")}return null},createMozBR:function(){var b=tinymce.activeEditor.dom;return b.create("br",{_moz_dirty:"",type:"_moz"})},createEmptyPara:function(){var b=tinymce.activeEditor.dom;return b.create("p",{},tinymce.isIE?"":"<br _moz_dirty='' type='_moz' />")},findLastKid:function(b){if(b.nodeType==3){return null}if(b.childNodes.length==0){return null}if(this.isMacro(b)||$def(b.tagName)&&b.tagName.toLowerCase()=="table"||$def(b.tagName)&&b.tagName.toLowerCase()=="pre"){return b}return this.findLastKid(b.childNodes[b.childNodes.length-1])},isBR:function(b){if(b.nodeType==3){return false}return b.nodeName.toLowerCase()=="br"},convertDoubleLineBreaksToParagraphs:function(e,l){if(l.nodeType!=1){return}if(!e.dom.isBlock(l)&&l.nodeName.toLowerCase()!="body"){return}if(l.nodeName.toLowerCase()=="pre"){return}if(this.isExactMacro(l)){return}var c;if(l.childNodes.length>0){c=l.childNodes[l.childNodes.length-1]}for(var b=0;b<l.childNodes.length-1;b++){var d=l.childNodes[b];c=l.childNodes[b+1];if(d.nodeType==1&&(d.nodeName.toLowerCase()=="title"||d.nodeName.toLowerCase()=="meta"||d.nodeName.toLowerCase()=="colgroup")){l.removeChild(d);b--}else{if(d.nodeType==1&&(d.nodeName.toLowerCase()=="ol"||d.nodeName.toLowerCase()=="ul")){if(d.childNodes.length==0){l.removeChild(d);b--}}else{if(c.nodeType==1&&(c.nodeName.toLowerCase()=="ol"||c.nodeName.toLowerCase()=="ul")){if(c.childNodes.length==0){l.removeChild(c);b--}}else{if(this.isBR(d)&&this.isBR(c)){var j=e.dom.getParent(d,"li");if(j==null){var h=d.parentNode;var f=h.parentNode;b--;if(h.nodeName.toLowerCase()!="p"){h=d;f=h.parentNode;var g=this.createEmptyPara(e.getDoc());this.insertAfter(f,g,h);d.parentNode.removeChild(d);c.parentNode.removeChild(c);c=g}else{var k=e.getDoc().createElement("p");while(c.nextSibling!=null){k.appendChild(c.nextSibling)}this.insertAfter(f,k,h);this.insertAfter(f,this.createEmptyPara(e.getDoc()),h);d.parentNode.removeChild(d);c.parentNode.removeChild(c);c=k}}}else{this.convertDoubleLineBreaksToParagraphs(e,d)}}}}}if($def(c)){this.convertDoubleLineBreaksToParagraphs(e,c)}},toXML:function(g,c){if(g.nodeType==3){return g.nodeValue+"\n"}var e="";if(g.nodeName.toLowerCase()=="br"){for(var d=0;d<c;d++){e+="  "}return e+"<BR>\n"}for(var d=0;d<c;d++){e+="  "}e+="<"+g.nodeName+">\n";for(var f=0;f<g.childNodes.length;f++){var b=(g!=g.childNodes[f].parentNode);if(b){e+="<error>\n"}e+=this.toXML(g.childNodes[f],c+1);if(b){e+="</error>\n"}}for(var d=0;d<c;d++){e+="  "}e+="</"+g.nodeName+">\n";return e},cloneNodeWithoutKids:function(e){var d=e.ownerDocument;var b=d.createElement(e.nodeName);for(var c=0;c<e.attributes.length;c++){if(e.attributes[c].value!=null){b.setAttribute(e.attributes[c].name,e.attributes[c].value)}}return b},sanitizeXML:function(h){if(h.nodeType!=1){return}var b=false;var d=[];for(var f=0;f<h.childNodes.length;f++){if(h!=h.childNodes[f].parentNode){b=true}else{d.push(h.childNodes[f]);this.sanitizeXML(h.childNodes[f])}}if(h.nodeName.toLowerCase()!="body"){try{var c=this.cloneNodeWithoutKids(h);for(var f=0;f<d.length;f++){c.appendChild(d[f])}h.parentNode.insertBefore(c,h);h.parentNode.removeChild(h)}catch(g){console.log("error in fixIt: "+g.message)}}},fixBodyParagraphs:function(){var k=tinyMCE.activeEditor;var l=k.getBody();var o=k.selection;var r=k.getDoc();if(tinymce.isIE&&l.innerHTML.toLowerCase()=="<p>&nbsp;</p>"){var m=this;k.undoManager.transparentChange(function(){l.appendChild(m.createEmptyPara(r));l.removeChild(l.firstChild)});return}this.convertDoubleLineBreaksToParagraphs(k,l);var h=this.findLastKid(l);if(l.childNodes.length>0&&h||l.childNodes.length==0){l.appendChild(this.createEmptyPara(r))}$j("p .Apple-style-span:only-child",r).filter(function(){return this.nextSibling==null&&this.previousSibling==null}).removeClass("Apple-style-span");var e=$j(".Apple-style-span",r);if(e.length>0){var f=o.getBookmark();e.contents().unwrap();o.moveToBookmark(f)}for(var j=0;j<l.childNodes.length;j++){var s=l.childNodes[j];var g=s.tagName;if(s.nodeType>=5){s.parentNode.removeChild(s);continue}if(typeof(g)!="undefined"){g=g.toLowerCase();if(g=="img"){var d=k.getDoc().createElement("p");l.insertBefore(d,s);d.appendChild(s)}if(!tinymce.isIE){if(s.nodeType==1&&g=="p"){if(s.childNodes.length==0){s.appendChild(this.createMozBR(k.getDoc()))}}}}if(s.nodeType==3||$j(s).css("display")=="inline"){if(s.nodeType==3&&(s.nodeValue.length==0||a.test(s.nodeValue))){s.parentNode.removeChild(s);j--}else{if((s.nodeType==3&&!a.test(s.nodeValue))||(s.nodeType!=3&&!k.plugins.jiveselection.isBookmark(s))){var q=null;var n=null;var c=false;if(this.typingInBody){var b=o.getRng(true);if(b.collapsed){q=b.startContainer;if(q==l&&b.startOffset>0){q=l.childNodes[b.startOffset-1]}else{n=b.startOffset}}}var d=k.getDoc().createElement("p");k.getBody().insertBefore(d,s);j++;do{if(this.typingInBody&&s==q){c=true}d.appendChild(s);if(s.nodeType==1&&s.nodeName.toLowerCase()=="br"){break}s=null;if(j<l.childNodes.length){s=l.childNodes[j]}j--}while(s!=null&&(s.nodeType==3||$j(s).css("display")=="inline"));if(c){b=o.getRng(true);if(n!=null){b.setStart(q,n);b.collapse(true)}else{b.selectNode(q);b.collapse(false)}o.setRng(b)}}}}}if(typeof(this.typingInBody)!="undefined"&&this.typingInBody){this.typingInBody=false}},lastNodeChanged:null,lastScrollY:0,ensureParaEndsWithBr:function(c,e){if(tinymce.isIE){return}if(e.childNodes.length==0){e.appendChild(this.createMozBR(c.getDoc()))}else{var d=false;var b=e;while(!d&&b.nodeType==1&&b.childNodes.length>0){var f=b.childNodes[b.childNodes.length-1];if(f.nodeType==1&&f.nodeName.toLowerCase()=="br"){d=true}else{b=f}}if(!d){e.appendChild(this.createMozBR(c.getDoc()))}}},nodeChanged:function(c,b,e,f){if(e.nodeType==1&&e.nodeName.toLowerCase()=="p"){this.ensureParaEndsWithBr(c,e)}var d=this.getMacroFor(e);if(b.get("justifyleft")){if(d!=null){b.get("justifyleft").setDisabled(true);b.get("justifycenter").setDisabled(true);b.get("justifyright").setDisabled(true);b.get("justifyfull").setDisabled(true)}else{b.get("justifyleft").setDisabled(false);b.get("justifycenter").setDisabled(false);b.get("justifyright").setDisabled(false);b.get("justifyfull").setDisabled(false)}}c.plugins.jivemacros.removeDuplicateMacros(c,true)},validateMacroElements:function(d,b){b=$j(b);var e=d.getHiddenContainer();var c=d.getUIDForElement(b);while(c==null||d.getRTEElementFor(c).length>1){b=b.filter(":first");if(c!=null){b.removeClass("_jivemacro_uid"+c)}c=d.generateUID();b.addClass("_jivemacro_uid"+c);b.attr("_jivemacro_uid",c)}var f=null;e.children().each(function(){if($j(this).attr("id")==c){f=$j(this)}});if(f==null){f=$j("<div id='"+c+"' class='richContent'></div>");e.append(f)}return f},removeDeletedMacros:function(b){var g=this.rte;if(g!=null&&typeof(g)=="object"){var h=g.getHiddenContainer();var f=h.children(".richContent");for(var e=0;e<f.length;e++){var j=$j(f[e]);var d=j.attr("id");var c=$j(g.getBody()).find("._jivemacro_uid"+d);if(c.length==0){g.removeMacroWithUID(d)}}}},removeDuplicateMacros:function(h,f){this.removeDeletedMacros(h);if(!tinymce.isIE){var d=h.getDoc().getElementsByTagName("td");for(var g=0;g<d.length;g++){var k=d[g];if(k.childNodes.length==0){k.appendChild(this.createMozBR(h.getDoc()))}}var d=h.getDoc().getElementsByTagName("th");for(var g=0;g<d.length;g++){var k=d[g];if(k.childNodes.length==0){k.appendChild(this.createMozBR(h.getDoc()))}}}var d=h.getDoc().getElementsByTagName("p");for(var g=0;g<d.length;g++){d[g].style.height=""}var b=this.rte;if(b!=null&&typeof(b)=="object"){var c=$j(h.getBody()).find(".jive_text_macro, .jive_macro");for(var g=0;g<c.length;g++){var k=c[g];if(this.isExactMacro(k)){var e=this.getMacroFor(k);if(e!=null&&e.usesCustomBackground()){var j=h.plugins.jivemacros.validateMacroElements(b,k);e.refreshPosition(b,k,j)}if(e!=null&&!f){e.refresh(b,k)}}}}},collapseToStart:null,insertAfter:function(d,c,b){if(b.nextSibling){return d.insertBefore(c,b.nextSibling)}else{return d.appendChild(c)}},putCursorAfter:function(b,f){var g=b.selection;var e;if(f.nextSibling==null||f.nextSibling.nodeName.toLowerCase()=="br"){var c=b.dom.getParent(f,function(i){return function(j){return j==b.getBody()||j!=i}}(f));if(tinymce.isWebKit){var h=b.getDoc().createElement("span");h.innerHTML="&nbsp;"}else{var h=b.getDoc().createTextNode(" ")}this.insertAfter(c,h,f);e=h}else{e=f.nextSibling}g.select(e);if(e.nodeType==3&&e.nodeValue.length<=1){g.collapse(true)}else{if(e.nodeType==3&&e.nodeValue.length>1){var d=g.getRng(true);d.setStart(e,tinymce.isWebKit?1:0);d.setEnd(e,tinymce.isWebKit?1:0);g.setRng(d)}else{if(e.nodeType==1&&e.childNodes.length>0){var d=g.getRng(true);d.setStart(e,tinymce.isWebKit?1:0);d.setEnd(e,tinymce.isWebKit?1:0);g.setRng(d)}else{g.collapse(true)}}}},putCursorBefore:function(c,e){if(e.previousSibling!=null){var g=e.previousSibling;var f=c.selection;var b;if(f.getSel().getRangeAt){b=f.getSel().getRangeAt(0)}else{b=document.createRange();b.setStart(f.getSel().anchorNode,f.getSel().anchorOffset);b.setEnd(f.getSel().focusNode,f.getSel().focusOffset)}var d=0;while(g.nodeType!=3&&g.nodeType==1&&g.childNodes&&g.childNodes.length!=0){g=g.childNodes[g.childNodes.length-1]}if(g.nodeType==3){d=g.nodeValue.length;b.setStart(g,d);b.setEnd(g,d);c.selection.setRng(b)}else{c.selection.select(g);c.selection.collapse(true)}return}},isLastNodeOf:function(d,c,b){if(c.childNodes.length>0&&c.childNodes[c.childNodes.length-1].nodeType==3&&d.getRng(true).startContainer!=c.childNodes[c.childNodes.length-1]){return false}if(c==b){return true}if(c.nextSibling!=null){return false}return this.isLastNodeOf(c.parentNode,b)},isFirstNodeOf:function(d,c,b){if(c.childNodes.length>0&&c.childNodes[0].nodeType==3&&d.getRng(true).startContainer!=c.childNodes[0]){return false}if(c==b){return true}if(c.previousSibling!=null){return false}return this.isLastNodeOf(c.parentNode,b)},killYourself:function(){clearInterval(this.intervalId)},setRTE:function(b){this.rte=b;this.completeInit()},completeInit:function(){if(this.ed&&this.rte&&!this.initialized){this.initialized=true;var f=this;var c=this.ed;var e=this.rte;if(c.plugins.jivelists){c.plugins.jivelists.onBeforeFixLists.add(function(){f.fixBodyParagraphs()})}setTimeout(function(){f.intervalId=setInterval(function(){try{if(c.destroyed){clearInterval(f.intervalId);return}var i=c.selection.getNode();var k=c.getWin().scrollY;if(i!=c.plugins.jivemacros.lastNodeChanged||c.plugins.jivemacros.isMacro(i)){c.plugins.jivemacros.removeDuplicateMacros(c,false)}else{if(k!=c.plugins.jivemacros.lastScrollY){c.plugins.jivemacros.removeDuplicateMacros(c,true)}}c.plugins.jivemacros.lastNodeChanged=i;c.plugins.jivemacros.lastScrollY=k}catch(j){console.log("error in setInterval");console.log(j)}},300)},333);c.onMouseUp.add(function(j,l){var k=l.target;if(j.selection.isCollapsed()&&k.nodeName.toLowerCase()=="html"){var i=j.getBody();if(i){if(i.childNodes.length==0){j.plugins.jivemacros.fixBodyParagraphs()}while(i.nodeType==1&&i.childNodes.length){i=i.childNodes[i.childNodes.length-1]}}j.selection.select(i);if(i.nodeType==1&&i.nodeName.toLowerCase()=="br"){j.selection.collapse(true)}else{j.selection.collapse()}}});if(c.plugins.jivecontextmenu){var d=c.plugins.jivecontextmenu;var h=new d.MenuItem("removeTextMacro",null,c.getLang("jivemacros.unquote"),{url:"../../../../../../images/tiny_mce3/themes/advanced/img/iconmaster.gif",xOffset:12,yOffset:86,width:13,height:11},"mceDeleteJiveMacro");var b=new d.Menu([h],true,false,c.getLang("jivemacros.macro.quote"));var g=new d.MenuItem("textMacroItem",/pre/i,null,{url:"../../../../../../images/tiny_mce3/themes/advanced/img/iconmaster.gif",xOffset:58,yOffset:0,width:25,height:22},b);d.addRootItem(g)}if(c.plugins.contextmenu){c.plugins.contextmenu.onContextMenu.add(function(j,p,u){var n,v=c.selection,k=v.getNode()||c.getBody();var r=c.dom.getParent(k,function(i){return i==c.getBody()||c.plugins.jivemacros.isExactMacro(i)});if(!c.plugins.jivemacros.isExactMacro(r)){r=null}var o=null;var s=-1;var t=false;if(r!=null){for(var q=0;q<jive.rte.macros.length;q++){if(jive.rte.macros[q].getName()==r.attributes.jivemacro.value){o=jive.rte.macros[q];s=q;if(o.getName()=="code"){if(r.attributes.___default_attr.value=="html"){t=true}}}}}window.jiveRTE=new Object();window.jiveRTE.macroEle=r;if(o!=null){c.plugins.jivemacros.macro=o;p.removeAll();if(r.nodeName.toLowerCase()=="a"&&(o.getName()=="document"||o.getName()=="blogpost"||o.getName()=="thread"||o.getName()=="message"||o.getName()=="blog"||o.getName()=="community"||o.getName()=="space"||o.getName()=="user"||o.getName()=="project"||o.getName()=="task"||o.getName()=="group")){p.add({title:"jivemacros.unlink",cmd:"mceDeleteJiveMacro"})}else{var x=o.getParameterSets();if(x.length>1){if(o.getName()!="code"||!t){var l=c.getLang("jivemacros.macro."+o.getName()+".presets","jivemacros.presets");n=p.addMenu({title:l,max_height:"200","class":"mceDropDown defaultSkin mceMacroMenu mceListBoxMenu",icon:"jiveMacroPreset"});for(var q=0;q<x.length;q++){if(o.getName()!="code"||x[q].name!="html"){var w=c.getLang("jivemacros.macro."+o.getName()+".preset."+x[q].name,x[q].name);n.add({title:w,cmd:"mceMacroParamSet"+s+"_"+q,icon:"jiveMacro_"+o.getName()+"_"+x[q].name})}}}}if(o.getAllowedParameters().length>0&&o.isShowSettings()){p.add({title:"jivemacros.properties",icon:"jiveMacroProperties",cmd:"mceEditJiveMacro",ui:true})}p.add({title:"jivemacros.remove",icon:"jiveMacroDelete",cmd:"mceDeleteJiveMacro",ui:true})}}else{this.macro=null}})}}},init:function(b,c){this.url=c;this.ed=b;var e=b.plugins.jiveutil.findMacro("emoticon");this.emoticon=e;var d=this;var f=false;b.onKeyUp.addToTop(function(g,h){f=!g.selection.isCollapsed()},this);b.onMouseUp.addToTop(function(g,h){f=!g.selection.isCollapsed()},this);b.onKeyUp.addToTop(function(g,h){if(f&&(h.keyCode==8||h.keyCode==46)){g.undoManager.add(false,true)}},this);b.addCommand("mceJiveMacros",function(){var g=this.controlManager;var h=g.get("jivemacros");h.showMenu()});if(b.onScroll){b.onScroll.addToTop(function(h,g){d.rte.getPopOverContainer().css("top",(-1*g)-this.rte.getContentAreaHeight());d.rte.getPopOverContainer().css("left",(-1*h));d.rte.getHiddenContainer().css("top",(-1*g));d.rte.getHiddenContainer().css("left",(-1*h))},this)}b.addCommand("mceEditJiveMacro",function(){var i=tinyMCE.activeEditor;var j=i.plugins.jivemacros.macro;var g=j.getAllowedParameters().length*28+88;if(j.getUrl().length>0){window.jiveRTE=new Object();window.jiveRTE.macro=j;window.jiveRTE.node=i.dom.getParent(i.selection.getNode(),i.plugins.jivemacros.isExactMacro);var h=i.windowManager.open({url:CS_BASE_URL+j.getUrl(),width:500,height:400,inline:1},{macro:j})}else{i.windowManager.open({url:CS_BASE_URL+"/resources/scripts/tiny_mce3/plugins/jivemacros/macro.htm",width:400,height:g,inline:1},{plugin_url:c,macro:j,cs_resource_base_url:CS_RESOURCE_BASE_URL})}});b.addCommand("mceDeleteJiveMacro",function(){var g=tinyMCE.activeEditor;this.deleteMacro(g,g.selection.getNode())},this);this.initialized=false;b.onBeforeGetContent.add(function(g){if(this.initialized){this.fixBodyParagraphs()}},this);b.onInit.add(this.completeInit,this);b.onEvent.add(function(g){return function(){g.plugins.jivemacros.removeDeletedMacros(g)}}(b));b.onNodeChange.add(this.nodeChanged,this);b.onExecCommand.add(function(g,i,h,j){switch(i){case"mceTableSplitCells":case"mceTableMergeCells":case"mceTableInsertRowBefore":case"mceTableInsertRowAfter":case"mceTableDeleteRow":case"mceTableInsertColBefore":case"mceTableInsertColAfter":case"mceTableDeleteCol":case"mceTableCutRow":case"mceTablePasteRowBefore":case"mceTablePasteRowAfter":case"mceTableRowUp":case"mceTableRowDown":case"mceTableColLeft":case"mceTableColRight":g.plugins.jivemacros.lastNodeChanged=null}});b.onKeyPress.addToTop(function(h,g){if(this.collapseToEnd!=null||this.collapseToStart!=null){tinymce.dom.Event.cancel(g)}if(g.which==null||g.which!=0||g.keyCode==8||g.keyCode==46){var i=this.isMacro(h.selection.getNode());if(h.dom.hasClass(i,"default_title")){h.dom.removeClass(i,"default_title")}}h.selection.lastSelected=h.selection.getNode()},this);b.onKeyDown.addToTop(function(q,s){if((s.keyCode==8||s.keyCode==46)&&!q.selection.isCollapsed()){q.undoManager.add(false,true)}var m=q.selection;var n=q.dom.getParent(m.getNode(),"pre");if(s.keyCode==8&&m.isCollapsed()&&n){var g=q.plugins.jiveselection.atStartOf(n)||q.plugins.jiveselection.isEffectivelyEmpty(n);if(g){q.undoManager.add(false,true);var l=m.getBookmark();q.dom.remove(n,true);m.moveToBookmark(l);q.undoManager.add(false,true);tinymce.dom.Event.cancel(s)}}m.lastSelected=m.getNode();var r=q.getBody();if(r.childNodes.length>0){this.before=m.getNode();if(s.keyCode==13&&n){if(tinymce.isIE){tinymce.dom.Event.cancel(s);var h=m.getSel().createRange();h.text="\n ";h.select()}else{if(tinymce.isWebKit){var o=m.getRng(true);var i=o.commonAncestorContainer;while(i&&!q.dom.isBlock(i)){i=i.parentNode}if(i&&i.nodeName.toLowerCase()=="pre"){var l=m.getBookmark();var k=q.dom.createRng();k.selectNodeContents(i);var j=q.dom.create("p");k.surroundContents(j);m.moveToBookmark(l)}}}}}},this);b.onKeyUp.add(function(n,s){var q=n.selection.getNode();if(q&&q.nodeName.toLowerCase()=="body"&&!s.ctrlKey&&!s.altKey&&!s.shiftKey&&!s.metaKey&&s.keyCode!=91&&s.keyCode!=92&&s.keyCode!=17&&s.keyCode!=18){this.typingInBody=true;this.fixBodyParagraphs()}if(s.keyCode==13){n.plugins.jivemacros.removeDuplicateMacros(n,false)}if(s.keyCode==90&&(s.ctrlKey||s.metaKey)&&(q&&q.nodeName.toLowerCase()=="body"&&n.selection.lastSelected&&n.selection.lastSelected.nodeName.toLowerCase()!="body")){var o=n.selection.lastSelected;if(o.childNodes.length){o=o.childNodes[o.childNodes.length-1];n.selection.select(o);n.selection.collapse(true)}else{n.selection.select(o);n.selection.collapse()}}var k=n.selection;if(this.collapseToStart!=null){this.putCursorBefore(n,this.collapseToStart);tinymce.dom.Event.cancel(s);this.collapseToStart=null;return}if(this.collapseToEnd!=null){this.putCursorAfter(n,this.collapseToEnd);tinymce.dom.Event.cancel(s);this.collapseToEnd=null;return}if(this.before!=null&&(s.keyCode==39||s.keyCode==40)){var h=n.dom.getParent(q,"PRE");if(this.before.tagName!="PRE"&&h){if(this.before.childNodes.length==1&&this.before.childNodes[0].tagName=="BR"){var r=n.dom.getParent(this.before,function(p){return function(u){return u==n.getBody()||u!=p}}(this.before));if(r.childNodes[0]==this.before){r.removeChild(this.before);this.before=h;n.nodeChanged(false,true)}}}}n.plugins.jiveemoticons.encodeSmileys(n,q);if(s.keyCode==37||s.keyCode==38){var k=n.selection;var l=n.dom.getParent(k.getNode(),function(p){return p==n.getBody()||n.plugins.jivemacros.isExactMacro(p)});if(!n.plugins.jivemacros.isExactMacro(l)){l=null}if(l==null){return}var m=this.isFirst(n.getBody(),l);var j=this.isMacro(l);var g=k.getBookmark(BOOKMARKTYPE).start==0||k.getRng(true).startOffset==0;if(m&&j&&g&&k.isCollapsed()){var i=n.getDoc().createElement("P");var t=n.getDoc().createElement("BR");i.appendChild(t);n.getBody().insertBefore(i,n.getBody().childNodes[0]);n.nodeChanged(false,true);return true}}},this)},getInfo:function(){return{longname:"Jive Macros",author:"Jive Software",authorurl:"http://jivesoftware.com",infourl:"http://jivesoftware.com",version:tinyMCE.majorVersion+"."+tinyMCE.minorVersion}},generateMacroMenu:function(d,g){var f=tinyMCE.activeEditor;var c=jive.rte.macros[g];var k=c.getParameterSets();var h=f.getLang("jivemacros.macro."+c.getName(),c.getName());if(k.length>1){var b=d.addMenu({title:h,max_height:"200","class":"mceDropDown defaultSkin mceMacroMenu mceListBoxMenu",icon:"jiveMacro_"+c.getName()});for(var e=0;e<k.length;e++){var j=f.getLang("jivemacros.macro."+c.getName()+".preset."+k[e].name,k[e].name);if(k[e].name=="html"&&c.getName()=="code"){d.add({cmd:"mceAddJiveMacro"+g+"_"+e,title:j,max_height:"200",icon:"jiveMacro_"+c.getName()})}else{b.add({title:j,cmd:"mceAddJiveMacro"+g+"_"+e,icon:c.getName()+"_"+k[e].name})}}}else{if(k.length==1){var j=f.getLang("jivemacros.macro."+c.getName()+".preset."+k[0].name,k[0].name);d.add({cmd:"mceAddJiveMacro"+g,title:j,max_height:"200",icon:"jiveMacro_"+c.getName()})}else{d.add({cmd:"mceAddJiveMacro"+g,title:h,max_height:"200",icon:"jiveMacro_"+c.getName()})}}},createControl:function(k,b){switch(k){case"jivemacros":var i=b.createSplitButton("jivemacros",{title:"jivemacros.add",cmd:"mceJiveMacros"});for(var f=0;f<jive.rte.macros.length;f++){if(jive.rte.macros[f].isShowInMacroList()&&jive.rte.macros[f].getName()!="emoticon"&&!jive.rte.macros[f].isButton()){i.onRenderMenu.add(function(c){return function(n,j){var l=tinyMCE.activeEditor;l.plugins.jivemacros.generateMacroMenu(j,c)}}(f))}}return i;case"extra":var e=tinyMCE.activeEditor;for(var f=0;f<jive.rte.macros.length;f++){if(jive.rte.macros[f].isShowInMacroList()&&jive.rte.macros[f].getName()!="emoticon"&&jive.rte.macros[f].isButton()){var g=jive.rte.macros[f];var h=g.getParameterSets();var d=e.getLang("jivemacros.macro."+g.getName(),g.getName());if(h.length>1){var i=b.createSplitButton("extra",{title:d,image:"../jscripts/tiny_mce/plugins/example/img/example.gif",icon:"jiveMacro_"+g.getName(),cmd:"mceAddJiveMacro"+f});i.onRenderMenu.add(function(c){return function(o,j){for(var l=0;l<h.length;l++){var n=e.getLang("jivemacros.macro."+g.getName()+".preset."+h[l].name,h[l].name);j.add({title:n,cmd:"mceAddJiveMacro"+c+"_"+l,icon:g.getName()+"_"+h[l].name})}}}(f));return i}else{var i=b.createButton("extra",{title:d,cmd:"mceAddJiveMacro"+f,icon:"jiveMacro_"+g.getName()});return i}}}}return null}});tinymce.PluginManager.add("jivemacros",tinymce.plugins.JiveMacrosPlugin)})();
;
tinyMCE.addI18n('en.jivemacros',{
    unlink : "Unlink",
    add : 'Insert',
    remove : 'Remove',
    properties : 'Settings',
    title : 'Settings',
    presets : 'Presets',
    save: "Save",
    params : 'Parameters',
    'macro.toc': "Table of Contents",
    'macro.quote': "Quote",
    'macro.user': "User",
    'macro.youtube': "YouTube",
    'macro.youtube.attr.__default_attr': "URL or Video ID",
    'macro.youtube.attr.width': "Width",
    'macro.youtube.attr.height': "Height",
    'macro.emoticon.presets': "Emoticons",
    'macro.code': "Syntax Highlighting",
    'macro.code.presets': "Format",
    'macro.code.attr.__default_attr': "Format",
    'macro.code.preset.plain': "Plain",
    'macro.code.preset.sql': "SQL",
    'macro.code.preset.java': "Java",
    'macro.code.preset.html': "Insert Raw HTML",
    'macro.code.preset.xml': "XML",
    'macro.emoticon.preset.angry': "Angry",
    'macro.emoticon.preset.blush': "Blush",
    'macro.emoticon.preset.confused': "Confused",
    'macro.emoticon.preset.cool': "Cool",
    'macro.emoticon.preset.cry': "Cry",
    'macro.emoticon.preset.devil': "Devil",
    'macro.emoticon.preset.grin': "Grin",
    'macro.emoticon.preset.happy': "Happy",
    'macro.emoticon.preset.laugh': "Laugh",
    'macro.emoticon.preset.love': "Love",
    'macro.emoticon.preset.mischief': "Mischief",
    'macro.emoticon.preset.plain': "Plain",
    'macro.emoticon.preset.sad': "Sad",
    'macro.emoticon.preset.shocked': "Shocked",
    'macro.emoticon.preset.silly': "Silly",
    'macro.emoticon.preset.wink': "Wink",
    'macro.emoticon.preset.info': "Info",
    'macro.emoticon.preset.plus': "Plus",
    'macro.emoticon.preset.minus': "Minus",
    'macro.emoticon.preset.alert': "Alert"
});

;
tinyMCE.addI18n('en.jivemacros',{
    add : 'Insert',
    remove : 'Remove',
    properties : 'Settings',
    title : 'Settings',
    params : 'Parameters',
    presets : 'Presets',
    save: "Save"
});

;
(function(){tinymce.create("tinymce.plugins.JiveEmoticonsPlugin",{before:null,macro:null,encodeSmileys:function(c,b){var d=this;var h=c.getDoc();var e=null;function g(m){var n=h.createElement("IMG");n.setAttribute("class","jive_macro jive_emote");n.setAttribute("jivemacro","emoticon");n.setAttribute("___jive_emoticon_name",m);n.setAttribute("src",window.CS_RESOURCE_BASE_URL+"/images/emoticons/"+m+".gif");n.setAttribute("_mce_src",window.CS_RESOURCE_BASE_URL+"/images/emoticons/"+m+".gif");n.removeAttribute("width");n.removeAttribute("height");return n}var j=new RegExp("^(?:[^\\S]|\\xA0)?$");function l(n){function m(u,t,p){var o=u.length;if(j.test(p.substring(t-1,t))&&j.test(p.substring(t+o,t+o+1))){var q=d.emoticonMap[u];var r=p.substring(m.lastIndex,t);m.lastIndex=t+o;n.appendChild(h.createTextNode(r));n.appendChild(g(q[1]));return""}return u}m.lastIndex=0;return m}var k=false;function a(s){if(s.nodeType==1){for(var p=0;p<s.childNodes.length;){p+=a(s.childNodes[p])}}else{if(s.nodeType==3){var r=h.createDocumentFragment();d.testForAnyEmoticon.lastIndex=0;var o=l(r);s.nodeValue.replace(d.testForAnyEmoticon,o);if(r.childNodes.length>0){var q=s.nodeValue.substr(o.lastIndex);r.appendChild(h.createTextNode(q));var m=r.childNodes.length;s.parentNode.replaceChild(r,s);k=true;return m}}}return 1}if(b!=null&&this.testForAnyEmoticon.test(b.innerHTML)){var i=true;try{if(!tinymce.isIE||c.selection.isCollapsed()){i=c.plugins.jiveselection.isForwardSelection();e=c.selection.getBookmark()}}catch(f){console.log("could not bookmark selection for emoticon",f)}c.selection.setRng(c.plugins.jiveselection.safeNormalize(c.selection.getRng(true),b));a(b);if(e!=null){c.selection.moveToBookmark(e);if(!i){c.plugins.jiveselection.setSelection(c.selection.getRng(true),i)}}}},nodeChanged:function(a){if(this.before==null){this.before=a.selection.getNode()}this.encodeSmileys(a,this.before);this.before=a.selection.getNode()},init:function(a,b){var e=a.plugins.jiveutil.findMacro("emoticon");if(e!=null){this.macro=e}var d=[[":D","grin",":D"],[":x","love",":x"],[";\\","mischief",";\\\\"],["B-)","cool","B-\\)"],["]:)","devil","\\]:\\)"],[":p","silly",":p"],[":P","silly",":P"],["X-(","angry","X\\-\\("],[":^0","laugh",":^0"],[";)","wink",";\\)"],[":8}","blush",":8}"],[":0","laugh",":0"],[":o","shocked",":o"],[":)","happy",":\\)"],[":(","sad",":\\("],["(+)","plus","\\(\\+\\)"],["(-)","minus","\\(\\-\\)"],["(!)","alert","\\(!\\)"],["(i)","info","\\(i\\)"]];var f={};d.forEach(function(g){f[g[0]]=g});this.emoticonMap=f;var c=d.map(function(g){return g[g.length-1]}).join("|");this.testForAnyEmoticon=new RegExp("(?:"+c+")","g");if(tinymce.isOpera||/Firefox\/2/.test(navigator.userAgent)){a.onKeyDown.add(function(g,h){if(((tinymce.isMac?h.metaKey:h.ctrlKey)&&h.keyCode==86)||(h.shiftKey&&h.keyCode==45)){setTimeout(function(j,i){return function(){j.encodeSmileys(i,i.getBody())}}(this,g),33)}},this)}else{a.onPaste.addToTop(function(g,h){setTimeout(function(j,i){return function(){j.encodeSmileys(i,i.getBody())}}(this,g),33)},this)}},execCommand:function(e,d,f){if(e=="mceJiveEmoticon"){var a=tinyMCE.activeEditor.controlManager;var c=a.get("jiveemoticons");c.showMenu();return true}if(e=="insertHTML"||e=="mceInsertContent"){var b=tinyMCE.activeEditor;setTimeout(function(h,g){return function(){h.encodeSmileys(g,g.getBody())}}(this,b),0)}return false},getInfo:function(){return{longname:"Emoticons",author:"Jive Software",authorurl:"http://jivesoftware.com",infourl:"http://jivesoftware.com",version:tinyMCE.majorVersion+"."+tinyMCE.minorVersion}},createControl:function(d,a){switch(d){case"jiveemoticons":var b=a.createSplitButton("jiveemoticons",{title:"jiveemoticons.desc",cmd:"mceJiveEmoticon"});b.onRenderMenu.add(function(o,e){var f=tinyMCE.activeEditor;for(var g=0;g<jive.rte.macros.length;g++){var l=jive.rte.macros[g];if(l.isShowInMacroList()&&l.getName()=="emoticon"){var n=l.getParameterSets();for(var h=0;h<n.length;h++){var k=f.getLang("jivemacros.macro."+l.getName()+".preset."+n[h].name,n[h].name);e.add({title:k,cmd:"mceAddJiveMacro"+g+"_"+h,icon:"jiveMacro_"+l.getName()+"_"+n[h].name})}break}}});return b}return null}});tinymce.PluginManager.add("jiveemoticons",tinymce.plugins.JiveEmoticonsPlugin)})();
;
(function(){tinymce.create("tinymce.plugins.JiveTablePlugin",{fullPopOverWidth:230,fullPopOverHeight:400,editTableProperties:null,$table:null,$column:null,$row:null,$cell:null,propertyChooserMenu:null,resetTableProperties:null,resetColumnProperties:null,resetRowProperties:null,resetCellProperties:null,minY:0,minX:0,resetMinMaxY:function(a){this.minY=a.plugins.jivescroll.lastScrollY;this.minX=a.plugins.jivescroll.lastScrollX},defaultHeaderStyle:function(){return{color:"#FFFFFF",backgroundColor:"#6690BC",textAlign:"center",padding:"2"}},parseStyleAttr:function(c,a){var d=false;if(!c.attr("style")){return}var b=c.attr("style").toLowerCase();b=b.replace(new RegExp("-"+a,"gi"),"nomatch");if(b.indexOf(a+":")>=0){b=b.substr(b.indexOf(a+":"));if(b.indexOf(";")){b=b.substr(0,b.indexOf(";"))}d=$j.trim(b.substr(a.length+1))}return d},defaultCellStyle:function(){return{color:"#000000",textAlign:"left",padding:"2"}},forceCellType:function(a,e,c){if(!e.is(c)){var d=$j("<"+c+"></"+c+">",a.getDoc());d.append(e.contents());if(e.get(0)==this.$cell.get(0)){this.$cell=d}e.before(d);e.remove();var b=this.parseStyleAttr(e,"width");if(b){d.css("width",b)}return d}return e},styleAsTH:function(a,b){var c=parseInt(b.padding);if(isNaN(c)){c=0}var d=b.textAlign;a.css($j.extend({},this.defaultHeaderStyle(),b,{padding:c+"px",textAlign:(d=="full"?"justify":d),backgroundColor:(b.backgroundColor?b.backgroundColor:"transparent")}));a.removeAttr("_mce_style");a.removeAttr("align")},styleAsTD:function(a,b){var c=parseInt(b.padding);if(isNaN(c)){c=0}var d=b.textAlign;a.css($j.extend({},this.defaultCellStyle(),b,{padding:c+"px",textAlign:(d=="full"?"justify":d),backgroundColor:(b.backgroundColor?b.backgroundColor:"transparent")}));a.removeAttr("_mce_style");a.removeAttr("align")},createSpinnerInput:function(e,b,a,d,c){if(e.SpinButton){e.SpinButton({min:b,max:a,step:d,spinClass:"spin-button",upClass:"up",downClass:"down"})}e.keyup(c).change(c).mouseup(c)},defaultFont:function(d){var b=this.ed.settings.theme_advanced_fonts;var c="";var e=b.split(";");var a=e[1].split("=");return a[1]},parseFontNameFromStyle:function(a){return a.replace(/'/g,"").replace(/, /g,",")},fontName:function(c){var a=this.ed.settings.theme_advanced_fonts;var b="";$j.each(a.split(";"),function(f,e){var d=e.split("=");if(d[1]==c){b=d[0]}});return b},createFontInput:function(c,d){var b=this.ed.settings.theme_advanced_fonts;var a=$j("<div class='fontPicker'></div>");$j.each(b.split(";"),function(g,f){var e=f.split("=");a.append($j("<a href='javascript:;'></a>").text(e[0]).css({fontFamily:e[1]}).click(function(){c.text(e[0]).css("font-family",e[1]).data("font-family",e[1]);d();a.hide()}))});c.click(function(){a.show();return false}).change(d).keyup(d);c.after(a);c.parents(".properties").click(function(){a.hide()})},createColorInput:function(e,c){var b="000000,993300,333300,003300,003366,000080,333399,333333,800000,FF6600,808000,008000,008080,0000FF,666699,808080,FF0000,FF9900,99CC00,339966,33CCCC,3366FF,800080,999999,FF00FF,FFCC00,FFFF00,00FF00,00FFFF,00CCFF,993366,C0C0C0,FF99CC,FFCC99,FFFF99,CCFFCC,CCFFFF,99CCFF,CC99FF,FFFFFF";var a=$j("<span style='position:relative;line-height:18px;position: absolute;'></span>");var f=$j("<div class='colorSample'></div>");var d=$j("<div class='colorPicker'></div>");$j.each(b.split(","),function(g,h){d.append($j("<a href='javascript:;'></a>").css({backgroundColor:"#"+h}).click(function(){e.val("#"+h);c();d.hide();return false}))});e.click(function(){d.show();return false}).change(c).keyup(c);f.click(function(){d.show();return false});e.after(d).after(f).after(a);a.append(e).append(f);e.parents(".properties").click(function(){d.hide()})},changeHeaderStyle:function(e,d,c,f){var g=this;var a=e.selection.getBookmark(BOOKMARKTYPE);if(c){d.find(c).each(function(b,h){g.forceCellType(e,$j(h),"th")})}if(f){d.find(f).each(function(b,h){g.forceCellType(e,$j(h),"td")})}e.selection.moveToBookmark(a)},resetPropertiesTabs:function(a){a.find("li:not(:first)").removeClass("j-tab-selected");a.find("li:first").addClass("j-tab-selected");a.children("div:not(:first)").hide();a.children("div:first").show();a.find("a:nth(0)").click(function(){a.find("li:not(:nth(0))").removeClass("j-tab-selected");a.find("li:nth(0)").addClass("j-tab-selected");a.find("form").children("div:not(.tableStyle)").hide();a.find("form").children("div:nth(0)").show();return false}).click();a.find("a:nth(1)").click(function(){a.find("li:not(:nth(1))").removeClass("j-tab-selected");a.find("li:nth(1)").addClass("j-tab-selected");a.find("form").children("div:not(.tableHeader)").hide();a.find("form").children("div:nth(1)").show();return false});a.find("a:nth(2)").click(function(){a.find("li:not(:nth(2))").removeClass("j-tab-selected");a.find("li:nth(2)").addClass("j-tab-selected");a.find("form").children("div:not(.tableCell)").hide();a.find("form").children("div:nth(2)").show();return false})},buildTableProperties:function(g){var i=this;var m=null;var e=null;var k=0;var a="";var n="";var b=null;var h=0;var o=null;var d=0;function c(){m=i.$table.attr("jive-data-header");e=i.$table.attr("jive-data-cell");k=0;a=i.$table.attr("align");a=a?a.toLowerCase():"none";n=i.$table.css("border-color");if(n&&n.indexOf("rgb")===0){n=g.plugins.jiveutil.convertRGBToHex(n)}b=null;h=0;o=null;d=0;(function(){var w=i.$table.attr("style");var C=i.$table.attr("border");var y=i.$table.css("border");var v=i.$table.get(0).style.borderWidth;var s=i.$table.attr("height");var p=w?w.indexOf("height")>=0:false;var t=i.$table.attr("width");var r=i.parseStyleAttr(i.$table,"width");var B=i.$table.attr("bgColor");if(y&&y.indexOf(" ")){y.split(" ");y=parseFloat(y[0])}if(v){v=parseFloat(v)}if(C){k=C}if(y){k=y}if(v){k=v}if(t){h=parseInt(t);b=t.substr((h+"").length);b=b=="%"?"per":"px"}if(r){h=parseInt(r);b=r.substr((h+"").length);b=b=="%"?"per":"px"}if(!b||!h){h=i.$table.width();b="px"}if(s){o="px";d=s}if(p){d=i.$table.height();o="px"}if(!o||!d){d=i.$table.height();o="auto"}if(!B){B=i.$cell.attr("bgColor")}if(!B){B=i.$cell.css("background-color")}if(B&&B.indexOf("rgb")===0){B=g.plugins.jiveutil.convertRGBToHex(B)}var A="2";try{A=parseInt(i.$cell.get(0).style.padding)+""}catch(x){}var z=i.parseFontNameFromStyle(i.$cell.css("fontFamily"));var u=i.$cell.css("color");if(u&&u.indexOf("rgb")===0){u=g.plugins.jiveutil.convertRGBToHex(u)}var q=i.$cell.css("textAlign");if(m){try{m=$j.JSON.decode(jive.util.unescapeHTML(m))}catch(x){m=$j.extend({},i.defaultHeaderStyle())}}else{m=$j.extend({},i.defaultHeaderStyle())}if(e){try{e=$j.JSON.decode(jive.util.unescapeHTML(e))}catch(x){e=$j.extend({},i.defaultCellStyle())}}else{e=$j.extend({},i.defaultCellStyle())}if(i.$cell.is("th")){m.backgroundColor=B}if(i.$cell.is("td")){e.backgroundColor=B}if(i.$cell.is("th")){m.padding=A}if(i.$cell.is("td")){e.padding=A}if(z){if(i.$cell.is("th")){m.fontFamily=z}if(i.$cell.is("td")){e.fontFamily=z}}if(u){if(i.$cell.is("th")){m.color=u}if(i.$cell.is("td")){e.color=u}}if(q){if(q=="justify"){q="full"}if(i.$cell.is("th")){m.textAlign=q}if(i.$cell.is("td")){e.textAlign=q}}})()}function l(){if(!$j.JSON||!$j.JSON.encode){return}i.$table.attr("jive-data-header",$j.JSON.encode(m));i.$table.attr("jive-data-cell",$j.JSON.encode(e))}function f(){var q=0;if(i.editTableProperties.find(".tableStyle input.borderWidth").val()){q=parseFloat(i.editTableProperties.find(".tableStyle input.borderWidth").val());if(isNaN(q)){q=0}}i.$table.removeAttr("_mce_style");i.$table.removeAttr("bgcolor");i.$table.attr("border",q);i.$table.css("border-width",q+"px");i.$table.css("border-color",n);i.$table.css("border-style","solid");i.$table.find("td,th").css("border-width","").css("border-style","").css("border-color","");if(b=="px"){var r=i.editTableProperties.find(".tableStyle .formFields .widthPx").val();r=parseInt(r);if(!isNaN(r)){i.$table.removeAttr("width");i.$table.css("width",r+"px")}}else{var p=i.editTableProperties.find(".tableStyle .formFields .widthPer").val();p=parseInt(p);if(!isNaN(p)){i.$table.removeAttr("width");i.$table.css("width",p+"%")}}if(o=="px"){var r=i.editTableProperties.find(".tableStyle .formFields .heightPx").val();r=parseInt(r);if(!isNaN(r)){i.$table.removeAttr("height");i.$table.css("height",r+"px")}}else{i.$table.removeAttr("height");i.$table.css("height","");i.editTableProperties.find(".tableStyle .formFields .heightPx").val(i.$table.height())}i.$table.removeAttr("_mce_style");i.$table.find("th").each(function(){i.styleAsTH($j(this),m)});i.$table.find("td").each(function(){i.styleAsTD($j(this),e)});g.nodeChanged()}function j(){l();if(b=="px"){i.editTableProperties.find(".tableStyle .formFields .widthPer").hide();i.editTableProperties.find(".tableStyle .formFields .widthPx").show().val(h);i.editTableProperties.find(".tableStyle .formFields .chooseWidthPer").removeAttr("checked");i.editTableProperties.find(".tableStyle .formFields .chooseWidthPx").attr("checked","checked")}else{i.editTableProperties.find(".tableStyle .formFields .widthPer").show().val(h);i.editTableProperties.find(".tableStyle .formFields .widthPx").hide();i.editTableProperties.find(".tableStyle .formFields .chooseWidthPx").removeAttr("checked");i.editTableProperties.find(".tableStyle .formFields .chooseWidthPer").attr("checked","checked")}i.editTableProperties.find(".tableStyle .formFields .heightPx").val(d);if(o=="px"){i.editTableProperties.find(".tableStyle .formFields .chooseHeightAuto").removeAttr("checked");i.editTableProperties.find(".tableStyle .formFields .chooseHeightPx").attr("checked","checked")}else{i.editTableProperties.find(".tableStyle .formFields .chooseHeightPx").removeAttr("checked");i.editTableProperties.find(".tableStyle .formFields .chooseHeightAuto").attr("checked","checked")}i.editTableProperties.find(".tableStyle input.borderWidth").val(k);i.editTableProperties.find(".tableStyle .formFields .borderColor").val(n);i.editTableProperties.find(".tableStyle .formFields .colorSample").css("background-color",n);i.editTableProperties.find(".tableStyle .formFields:last a.mceButton.mce_justifytable"+a).addClass("mceButtonSelected");i.editTableProperties.find(".tableStyle .formFields:last a.mceButton:not(.mce_justifytable"+a+")").removeClass("mceButtonSelected");i.updateCellInputs(i.editTableProperties.find(".tableHeader"),m,k,n,i.styleAsTH);i.updateCellInputs(i.editTableProperties.find(".tableCell"),e,k,n,i.styleAsTD)}this.resetPropertiesTabs(this.editTableProperties);(function(){i.editTableProperties.find(".tableStyle .formFields:first a.th-t").click(function(){i.changeHeaderStyle(g,i.$table,"tr:first td","tr:not(:first) th");j();f();return false});i.editTableProperties.find(".tableStyle .formFields:first a.th-tb").click(function(){i.changeHeaderStyle(g,i.$table,"tr:first td, tr:last td","tr:not(:first,:last) th");j();f();return false});i.editTableProperties.find(".tableStyle .formFields:first a.th-tl").click(function(){i.changeHeaderStyle(g,i.$table,"tr:first td, tr td:first-child","tr:not(:first) th:not(:first-child)");j();f();return false});i.editTableProperties.find(".tableStyle .formFields:first a.th-n").click(function(){i.changeHeaderStyle(g,i.$table,false,"th");j();f();return false});var q=i.editTableProperties.find(".tableStyle input.borderWidth");i.createSpinnerInput(q,0,100,1,function(){var u=q.val();if(k!=u){k=u;j();f()}});var p=i.editTableProperties.find(".tableStyle input.borderColor");i.createColorInput(p,function(){var u=p.val();if(n!=u){n=u;j();f()}});i.editTableProperties.find(".tableStyle .formFields:last a.mceButton").click(function(){if($j(this).hasClass("mce_justifytablenone")){i.$table.removeAttr("align");a="none"}if($j(this).hasClass("mce_justifytableleft")){i.$table.attr("align","left");a="left"}if($j(this).hasClass("mce_justifytableright")){i.$table.attr("align","right");a="right"}i.editTableProperties.find(".tableStyle .formFields:last a.mceButton").not(this).removeClass("mceButtonSelected");$j(this).addClass("mceButtonSelected");g.nodeChanged();return false});var t=i.editTableProperties.find(".tableStyle .formFields .widthPer");i.createSpinnerInput(t,0,100,1,function(){var u=t.val();if(h!=u){h=u;j();f()}});var s=i.editTableProperties.find(".tableStyle .formFields .widthPx");i.createSpinnerInput(s,0,9999,10,function(){var u=s.val();if(h!=u){h=u;j();f()}});i.editTableProperties.find(".tableStyle .formFields .chooseWidthPer").click(function(u){if(b=="px"){h=Math.round(i.$table.width()/i.$table.parents("body").width()*100);b="per";j();f();u.stopPropagation()}});i.editTableProperties.find(".tableStyle .formFields .chooseWidthPx").click(function(u){if(b=="per"){h=i.$table.width();b="px";j();f();u.stopPropagation()}});var r=i.editTableProperties.find(".tableStyle .formFields .heightPx");i.createSpinnerInput(r,0,9999,10,function(){i.editTableProperties.find(".tableStyle .formFields .chooseHeightAuto").removeAttr("checked");i.editTableProperties.find(".tableStyle .formFields .chooseHeightPx").attr("checked","checked").click();var u=r.val();if(d!=u){d=u;j();f()}});i.editTableProperties.find(".tableStyle .formFields .chooseHeightAuto").click(function(u){if(o=="px"){o="auto";d=i.$table.height();j();f();u.stopPropagation()}});i.editTableProperties.find(".tableStyle .formFields .chooseHeightPx").click(function(u){if(o=="auto"){d=i.$table.height();o="px";j();f();u.stopPropagation()}})}());this.setupHeaderCellForm(this.editTableProperties.find(".tableHeader"),function(){return m},function(){j();f()});this.setupTableCellForm(this.editTableProperties.find(".tableCell"),function(){return e},function(){j();f()});return function(){c();j()}},buildColumnProperties:function(f){var g=this;var k=null;var d=null;var i=0;var l="";var b=0;var a="";function c(){k=g.$column.first().attr("jive-data-header");d=g.$column.first().attr("jive-data-cell");i=0;l=g.$table.css("border-color");if(l&&l.indexOf("rgb")===0){l=f.plugins.jiveutil.convertRGBToHex(l)}b=0;a="auto";var v=g.$table.attr("border");var r=g.$table.css("border");var o=g.$table.css("border-width");if(r&&r.indexOf(" ")){r.split(" ");r=parseFloat(r[0])}if(o){o=parseFloat(o)}if(v){i=v}if(r){i=r}if(o){i=o}var u=g.$column.attr("bgColor");if(!u){u=g.$cell.attr("bgColor")}if(!u){u=g.$cell.css("background-color")}if(u&&u.indexOf("rgb")===0){u=f.plugins.jiveutil.convertRGBToHex(u)}var t="2";try{t=parseInt(g.$cell.get(0).style.padding)+""}catch(q){}var s=g.parseFontNameFromStyle(g.$cell.css("fontFamily"));var p=g.$cell.css("color");if(p&&p.indexOf("rgb")===0){p=f.plugins.jiveutil.convertRGBToHex(p)}var n=g.$cell.css("textAlign");var m=g.parseStyleAttr(g.$column,"width");if(m){b=parseInt(m);a=m.substr((b+"").length);a=a=="%"?"per":"px"}else{}if(k){try{k=$j.JSON.decode(jive.util.unescapeHTML(k))}catch(q){k=$j.extend({},g.defaultHeaderStyle())}}else{k=$j.extend({},g.defaultHeaderStyle())}if(d){try{d=$j.JSON.decode(jive.util.unescapeHTML(d))}catch(q){d=$j.extend({},g.defaultCellStyle())}}else{d=$j.extend({},g.defaultCellStyle())}if(g.$cell.is("th")){k.backgroundColor=u}if(g.$cell.is("td")){d.backgroundColor=u}if(g.$cell.is("th")){k.padding=t}if(g.$cell.is("td")){d.padding=t}if(s){if(g.$cell.is("th")){k.fontFamily=s}if(g.$cell.is("td")){d.fontFamily=s}}if(p){if(g.$cell.is("th")){k.color=p}if(g.$cell.is("td")){d.color=p}}if(n){if(n=="justify"){n="full"}if(g.$cell.is("th")){k.textAlign=n}if(g.$cell.is("td")){d.textAlign=n}}}function j(){if(!$j.JSON||!$j.JSON.encode){return}g.$column.first().attr("jive-data-header",$j.JSON.encode(k));g.$column.first().attr("jive-data-cell",$j.JSON.encode(d))}function e(){g.$column.filter("th").each(function(m){var n=$j(this);n.removeAttr("_mce_style");n.removeAttr("bgcolor");g.styleAsTH(n,k);if(this!=g.$column.first().get(0)){n.css("width","")}});g.$column.filter("td").each(function(m){var n=$j(this);n.removeAttr("_mce_style");n.removeAttr("bgcolor");g.styleAsTD($j(this),d);if(this!=g.$column.first().get(0)){n.css("width","")}});if(a=="px"){g.$column.first().css("width",b+"px")}else{if(a=="per"){g.$column.first().css("width",b+"%")}else{g.$column.first().css("width","")}}f.nodeChanged()}function h(){j();if(a=="px"){g.editColumnProperties.find(".columnStyle .formFields .widthPx").val(b);g.editColumnProperties.find(".columnStyle .formFields .widthPer").val(Math.round(g.$column.outerWidth()/g.$table.outerWidth()*100));g.editColumnProperties.find(".columnStyle .formFields .chooseWidthAuto").removeAttr("checked");g.editColumnProperties.find(".columnStyle .formFields .chooseWidthPer").removeAttr("checked");g.editColumnProperties.find(".columnStyle .formFields .chooseWidthPx").attr("checked","checked")}else{if(a=="per"){g.editColumnProperties.find(".columnStyle .formFields .widthPx").val(g.$column.width());g.editColumnProperties.find(".columnStyle .formFields .widthPer").val(b);g.editColumnProperties.find(".columnStyle .formFields .chooseWidthAuto").removeAttr("checked");g.editColumnProperties.find(".columnStyle .formFields .chooseWidthPx").removeAttr("checked");g.editColumnProperties.find(".columnStyle .formFields .chooseWidthPer").attr("checked","checked")}else{g.editColumnProperties.find(".columnStyle .formFields .widthPx").val(g.$column.width());g.editColumnProperties.find(".columnStyle .formFields .widthPer").val(Math.round(g.$column.outerWidth()/g.$table.outerWidth()*100));g.editColumnProperties.find(".columnStyle .formFields .chooseWidthPer").removeAttr("checked");g.editColumnProperties.find(".columnStyle .formFields .chooseWidthPx").removeAttr("checked");g.editColumnProperties.find(".columnStyle .formFields .chooseWidthAuto").attr("checked","checked")}}g.updateCellInputs(g.editColumnProperties.find(".columnHeader"),k,i,l,g.styleAsTH);g.updateCellInputs(g.editColumnProperties.find(".columnCell"),d,i,l,g.styleAsTD)}this.resetPropertiesTabs(this.editColumnProperties);(function(){function m(q,p){return function(){var s=f.selection.getBookmark(BOOKMARKTYPE);var u=g.$column.filter(q);var v=g.$column.filter(p);u.each(function(w,x){g.forceCellType(f,$j(x),"th")});v.each(function(w,x){g.forceCellType(f,$j(x),"td")});g.$column=f.plugins.jiveutil.findColumnBoundsForCell(g.$cell);var t=g.$column.first();var r=g.$column.last();if(t.length&&r.length){f.plugins.jiveblackout.showBlackout(f,t,r)}f.selection.moveToBookmark(s);h();e();return false}}g.editColumnProperties.find(".columnStyle .formFields:first a.th-t").click(m(":first",":not(:first)"));g.editColumnProperties.find(".columnStyle .formFields:first a.th-tb").click(m(":first, :last",":not(:first, :last)"));g.editColumnProperties.find(".columnStyle .formFields:first a.th-tl").click(m("td, th",false));g.editColumnProperties.find(".columnStyle .formFields:first a.th-n").click(m(false,"td, th"));var o=g.editColumnProperties.find(".columnStyle .formFields .widthPer");g.createSpinnerInput(o,0,100,1,function(){var p=o.val();a="per";if(b!=p){b=p;e();h()}});var n=g.editColumnProperties.find(".columnStyle .formFields .widthPx");g.createSpinnerInput(n,0,9999,10,function(){var p=n.val();a="px";if(b!=p){b=p;e();h()}});g.editColumnProperties.find(".columnStyle .formFields .chooseWidthAuto").click(function(p){if(a!="auto"){b=0;a="auto";e();h();p.stopPropagation()}});g.editColumnProperties.find(".columnStyle .formFields .chooseWidthPer").click(function(p){if(a!="per"){b=o.val();a="per";e();h();p.stopPropagation()}});g.editColumnProperties.find(".columnStyle .formFields .chooseWidthPx").click(function(p){if(a!="px"){b=n.val();a="px";e();h();p.stopPropagation()}})}());this.setupHeaderCellForm(this.editColumnProperties.find(".columnHeader"),function(){return k},function(){h();e()});this.setupTableCellForm(this.editColumnProperties.find(".columnCell"),function(){return d},function(){h();e()});return function(){c();h()}},buildRowProperties:function(e){var f=this;var k=null;var c=null;var h=0;var l="";var a=0;var i="auto";function b(){k=f.$row.attr("jive-data-header");c=f.$row.attr("jive-data-cell");h=0;l=f.$table.css("border-color");if(l&&l.indexOf("rgb")===0){l=e.plugins.jiveutil.convertRGBToHex(l)}a=0;i="auto";var u=f.$row.attr("bgColor");if(!u){u=f.$cell.attr("bgColor")}if(!u){u=f.$cell.css("background-color")}if(u&&u.indexOf("rgb")===0){u=e.plugins.jiveutil.convertRGBToHex(u)}var t="2";try{t=parseInt(f.$cell.get(0).style.padding)+""}catch(q){}var s=f.parseFontNameFromStyle(f.$cell.css("fontFamily"));var p=f.$cell.css("color");if(p&&p.indexOf("rgb")===0){p=e.plugins.jiveutil.convertRGBToHex(p)}var n=f.$cell.css("textAlign");var v=f.$table.attr("border");var r=f.$table.css("border");var o=f.$table.css("border-width");if(r&&r.indexOf(" ")){r.split(" ");r=parseFloat(r[0])}if(o){o=parseFloat(o)}if(v){h=v}if(r){h=r}if(o){h=o}var m=f.parseStyleAttr(f.$row,"height");if(m){a=parseInt(m);i=m.substr((a+"").length);i=i=="%"?"per":"px"}else{}if(k){try{k=$j.JSON.decode(jive.util.unescapeHTML(k))}catch(q){k=$j.extend({},f.defaultHeaderStyle())}}else{k=$j.extend({},f.defaultHeaderStyle())}if(c){try{c=$j.JSON.decode(jive.util.unescapeHTML(c))}catch(q){c=$j.extend({},f.defaultCellStyle())}}else{c=$j.extend({},f.defaultCellStyle())}if(f.$cell.is("th")){k.backgroundColor=u}if(f.$cell.is("td")){c.backgroundColor=u}if(f.$cell.is("th")){k.padding=t}if(f.$cell.is("td")){c.padding=t}if(s){if(f.$cell.is("th")){k.fontFamily=s}if(f.$cell.is("td")){c.fontFamily=s}}if(p){if(f.$cell.is("th")){k.color=p}if(f.$cell.is("td")){c.color=p}}if(n){if(n=="justify"){n="full"}if(f.$cell.is("th")){k.textAlign=n}if(f.$cell.is("td")){c.textAlign=n}}}function j(){if(!$j.JSON||!$j.JSON.encode){return}f.$row.attr("jive-data-header",$j.JSON.encode(k));f.$row.attr("jive-data-cell",$j.JSON.encode(c))}function d(){f.$table.removeAttr("_mce_style");f.$row.removeAttr("_mce_style");f.$row.removeAttr("bgcolor");f.$row.find("th").each(function(){f.styleAsTH($j(this),k)});f.$row.find("td").each(function(){f.styleAsTD($j(this),c)});if(i=="px"){f.$row.css("height",a+"px")}else{f.$row.css("height","")}e.nodeChanged()}function g(){j();if(i=="px"){f.editRowProperties.find(".rowStyle .formFields .heightPx").val(a);f.editRowProperties.find(".rowStyle .formFields .chooseHeightAuto").removeAttr("checked");f.editRowProperties.find(".rowStyle .formFields .chooseHeightPx").attr("checked","checked")}else{f.editRowProperties.find(".rowStyle .formFields .heightPx").val(f.$row.outerHeight());f.editRowProperties.find(".rowStyle .formFields .chooseHeightPx").removeAttr("checked");f.editRowProperties.find(".rowStyle .formFields .chooseHeightAuto").attr("checked","checked")}f.updateCellInputs(f.editRowProperties.find(".rowHeader"),k,h,l,f.styleAsTH);f.updateCellInputs(f.editRowProperties.find(".rowCell"),c,h,l,f.styleAsTD)}this.resetPropertiesTabs(this.editRowProperties);(function(){f.editRowProperties.find(".rowStyle .formFields:first a.th-a").click(function(){f.changeHeaderStyle(e,f.$row,"td","tr:not(:first) th");g();d();return false});f.editRowProperties.find(".rowStyle .formFields:first a.th-l").click(function(){f.changeHeaderStyle(e,f.$row,"td:first-child","th:not(:first-child)");g();d();return false});f.editRowProperties.find(".rowStyle .formFields:first a.th-n").click(function(){f.changeHeaderStyle(e,f.$row,false,"th");g();d();return false});var m=f.editRowProperties.find(".rowStyle .formFields .heightPx");f.createSpinnerInput(m,0,9999,10,function(){var n=m.val();i="px";if(a!=n){a=n;d();g()}});f.editRowProperties.find(".rowStyle .formFields .chooseHeightAuto").click(function(n){if(i!="auto"){a=0;i="auto";d();g();n.stopPropagation()}});f.editRowProperties.find(".rowStyle .formFields .chooseHeightPx").click(function(o){var n=m.val();if(i!="px"){a=n;i="px";d();g();o.stopPropagation()}})}());this.setupHeaderCellForm(this.editRowProperties.find(".rowHeader"),function(){return k},function(){g();d()});this.setupTableCellForm(this.editRowProperties.find(".rowCell"),function(){return c},function(){g();d()});return function(){b();g()}},buildCellProperties:function(e){var f=this;var j=null;var b=null;var h=0;var k="";function c(){j=f.$cell.attr("jive-data-header");b=f.$cell.attr("jive-data-cell");h=0;k=f.$table.css("border-color");if(k&&k.indexOf("rgb")===0){k=e.plugins.jiveutil.convertRGBToHex(k)}var s=f.$cell.attr("bgColor");if(!s){s=f.$cell.css("background-color")}if(s&&s.indexOf("rgb")===0){s=e.plugins.jiveutil.convertRGBToHex(s)}var r="2";try{r=parseInt(f.$cell.get(0).style.padding)+""}catch(o){}var q=f.parseFontNameFromStyle(f.$cell.css("fontFamily"));var n=f.$cell.css("color");if(n&&n.indexOf("rgb")===0){n=e.plugins.jiveutil.convertRGBToHex(n)}var l=f.$cell.css("textAlign");var t=f.$table.attr("border");var p=f.$table.css("border");var m=f.$table.css("border-width");if(p&&p.indexOf(" ")){p.split(" ");p=parseFloat(p[0])}if(m){m=parseFloat(m)}if(t){h=t}if(p){h=p}if(m){h=m}if(j){try{j=$j.JSON.decode(jive.util.unescapeHTML(j))}catch(o){if(s&&s.length&&f.$cell.is("th")){j=$j.extend({},f.defaultHeaderStyle(),{backgroundColor:s})}else{j=$j.extend({},f.defaultHeaderStyle())}}}else{if(s&&s.length&&f.$cell.is("th")){j=$j.extend({},f.defaultHeaderStyle(),{backgroundColor:s})}else{j=$j.extend({},f.defaultHeaderStyle())}}if(b){try{b=$j.JSON.decode(jive.util.unescapeHTML(b))}catch(o){if(s&&s.length&&f.$cell.is("td")){b=$j.extend({},f.defaultCellStyle(),{backgroundColor:s})}else{b=$j.extend({},f.defaultCellStyle())}}}else{if(s&&s.length&&f.$cell.is("td")){b=$j.extend({},f.defaultCellStyle(),{backgroundColor:s})}else{b=$j.extend({},f.defaultCellStyle())}}if(f.$cell.is("th")){j.padding=r}if(f.$cell.is("td")){b.padding=r}if(q){if(f.$cell.is("th")){j.fontFamily=q}if(f.$cell.is("td")){b.fontFamily=q}}if(n){if(f.$cell.is("th")){j.color=n}if(f.$cell.is("td")){b.color=n}}if(l){if(l=="justify"){l="full"}if(f.$cell.is("th")){j.textAlign=l}if(f.$cell.is("td")){b.textAlign=l}}}function i(){if(!$j.JSON||!$j.JSON.encode){return}f.$cell.attr("jive-data-header",$j.JSON.encode(j));f.$cell.attr("jive-data-cell",$j.JSON.encode(b))}function d(){f.$table.removeAttr("_mce_style");f.$cell.removeAttr("_mce_style");f.$cell.removeAttr("bgcolor");if(f.$cell.is("th")){f.styleAsTH(f.$cell,j)}if(f.$cell.is("td")){f.styleAsTD(f.$cell,b)}e.nodeChanged()}function g(){i();f.updateCellInputs(f.editCellProperties.find(".cellHeader"),j,h,k,f.styleAsTH);f.updateCellInputs(f.editCellProperties.find(".cellCell"),b,h,k,f.styleAsTD)}function a(){f.editCellProperties.children("div").hide();f.editCellProperties.children("div:first").show();f.editCellProperties.children("div:nth(1)").show();f.editCellProperties.find("div:first input:first").click(function(m){f.editCellProperties.find("form").children("div:not(nth(1))").hide();f.editCellProperties.find("form").children("div:nth(1)").show();f.editCellProperties.find("form").children("div:first").show();f.editCellProperties.find("div:first input:last").removeAttr("checked");f.editCellProperties.find("div:first input:first").attr("checked","checked");if(!f.$cell.is("th")){var l=e.selection.getBookmark(BOOKMARKTYPE);f.$cell=f.forceCellType(e,f.$cell,"th");e.plugins.jiveblackout.showBlackout(e,f.$cell);e.selection.moveToBookmark(l);g();d();m.stopPropagation()}});f.editCellProperties.find("div:first input:last").click(function(m){f.editCellProperties.find("form").children("div:not(nth(2))").hide();f.editCellProperties.find("form").children("div:nth(2)").show();f.editCellProperties.find("form").children("div:first").show();f.editCellProperties.find("div:first input:first").removeAttr("checked");f.editCellProperties.find("div:first input:last").attr("checked","checked");if(!f.$cell.is("td")){var l=e.selection.getBookmark(BOOKMARKTYPE);f.$cell=f.forceCellType(e,f.$cell,"td");e.plugins.jiveblackout.showBlackout(e,f.$cell);e.selection.moveToBookmark(l);g();d();m.stopPropagation()}});if(f.editCellProperties.parents("body").length){if(f.$cell.is("th")){f.editCellProperties.find("div:first input:first").click()}else{f.editCellProperties.find("div:first input:last").click()}}}this.setupHeaderCellForm(this.editCellProperties.find(".cellHeader"),function(){return j},function(){g();d()});this.setupTableCellForm(this.editCellProperties.find(".cellCell"),function(){return b},function(){g();d()});return function(){c();a();g()}},updateCellInputs:function(b,d,g,e,c){var f=parseInt(d.padding);f=isNaN(f)?0:f;b.find(".formFields .padding").val(f);b.find(".formFields:nth(1) .backgroundColor").val(d.backgroundColor);b.find(".formFields:nth(1) .colorSample").css("background-color",d.backgroundColor?d.backgroundColor:"white");b.find(".formFields:last a.mceButton.mce_justify"+d.textAlign).addClass("mceButtonSelected");b.find(".formFields:last a.mceButton:not(.mce_justify"+d.textAlign+")").removeClass("mceButtonSelected");c.call(this,b.find(".sampleHeader th"),d);b.find(".sampleHeader th").css("padding",Math.min(f,5)+"px");b.find(".sampleHeader").css("border-width",Math.min(g,5)+"px");b.find(".sampleHeader").css("border-color",e);b.find(".sampleHeader").css("border-style","solid");b.find(".sampleHeader").attr("border",Math.min(g,10));var a=d.fontFamily?d.fontFamily:this.defaultFont();b.find(".formFields:nth(2) .family").css("font-family",d.fontFamily).text(this.fontName(a));b.find(".formFields:nth(2) .fontColor").val(d.color);b.find(".formFields:nth(2) .colorSample").css("background-color",d.color)},setupHeaderCellForm:function(c,a,b){var d=this;d.createSpinnerInput(c.find("input.padding"),0,100,1,function(){var f=a();var e=c.find("input.padding").val();if(f.padding!=e){f.padding=e;b()}});d.createColorInput(c.find("input.backgroundColor"),function(){var f=a();var e=c.find("input.backgroundColor").val();if(f.backgroundColor!=e){f.backgroundColor=e;b()}});d.createFontInput(c.find("a.family"),function(){var f=a();var e=c.find("a.family").data("font-family");if(f.fontFamily!=e){f.fontFamily=e;b()}});c.find(".formFields:last a.mceButton").click(function(){var e=a();if($j(this).hasClass("mce_justifyleft")){e.textAlign="left"}if($j(this).hasClass("mce_justifycenter")){e.textAlign="center"}if($j(this).hasClass("mce_justifyright")){e.textAlign="right"}if($j(this).hasClass("mce_justifyfull")){e.textAlign="full"}c.find(".formFields:last a.mceButton").not(this).removeClass("mceButtonSelected");$j(this).addClass("mceButtonSelected");b();return false});d.createColorInput(c.find("input.fontColor"),function(){var f=a();var e=c.find("input.fontColor").val();if(f.color!=e){f.color=e;b()}})},setupTableCellForm:function(b,d,a){var c=this;this.createSpinnerInput(b.find("input.padding"),0,100,1,function(){var f=d();var e=b.find("input.padding").val();if(f.padding!=e){f.padding=e;a()}});this.createColorInput(b.find("input.backgroundColor"),function(){var f=d();var e=b.find("input.backgroundColor").val();if(f.backgroundColor!=e){f.backgroundColor=e;a()}});b.find(".formFields:last a.mceButton").click(function(){var e=d();if($j(this).hasClass("mce_justifyleft")){e.textAlign="left"}if($j(this).hasClass("mce_justifycenter")){e.textAlign="center"}if($j(this).hasClass("mce_justifyright")){e.textAlign="right"}if($j(this).hasClass("mce_justifyfull")){e.textAlign="full"}b.find(".formFields:last a.mceButton").not(this).removeClass("mceButtonSelected");$j(this).addClass("mceButtonSelected");a();return false});c.createFontInput(b.find("a.family"),function(){var f=d();var e=b.find("a.family").data("font-family");if(f.fontFamily!=e){f.fontFamily=e;a()}});this.createColorInput(b.find("input.fontColor"),function(){var f=d();var e=b.find("input.fontColor").val();if(f.color!=e){f.color=e;a()}})},buildPopover:function(f){var g=this;var h=f.plugins.jivecontextmenu;this.editTableProperties=$j(jive.rte.table.allTableProperties());this.editColumnProperties=$j(jive.rte.table.allColumnProperties());this.editRowProperties=$j(jive.rte.table.allRowProperties());this.editCellProperties=$j(jive.rte.table.allCellProperties());this.resetTableProperties=this.buildTableProperties(f);this.resetColumnProperties=this.buildColumnProperties(f);this.resetRowProperties=this.buildRowProperties(f);this.resetCellProperties=this.buildCellProperties(f);function j(){f.plugins.jiveblackout.hideBlackout()}function l(){h.hideMenu()}function d(p){var r=$j(p);g.$table=r.parents("table");g.$row=r.parents("tr");g.$column=f.plugins.jiveutil.findColumnBoundsForCell(r);g.$cell=r;g.resetTableProperties(f);g.resetColumnProperties(f);g.resetRowProperties(f);g.resetCellProperties(f);function o(){h.onHideMenu.remove(q);l()}function q(){f.onHideBlackout.remove(o);j()}if(h){h.onHideMenu.add(q)}if(f.onHideBlackout){f.onHideBlackout.add(o)}}this.displayCallback=d;var c=/^td|th$/i;if(h){function e(r,o){function p(){return o.get(0)}var q=new h.MenuItem(r,c,null,p,$j.noop,{width:226,height:356},null,null,d);return new h.Menu([q],true,true)}function n(){var o=this.findContextNode(f.selection.getRng(true));f.plugins.jiveblackout.showBlackout(f,$j(o).parents("table"))}var k=new h.MenuItem("tableItem",c,jive.rte.table.propertiesChooserTable(),{url:"../../../../../../images/tiny_mce3/themes/advanced/img/icons.gif",xOffset:580,yOffset:20,width:20,height:20},e("tableProps",this.editTableProperties),null,n);var b=new h.MenuItem("columnItem",c,jive.rte.table.propertiesChooserColumn(),{url:"../../../../../../images/tiny_mce3/themes/advanced/img/icons.gif",xOffset:600,yOffset:40,width:20,height:20},e("columnProps",this.editColumnProperties),null,function(){var q=$j(this.findContextNode(f.selection.getRng(true)));var p=f.plugins.jiveutil.findColumnFirstCell(q);var o=f.plugins.jiveutil.findColumnLastCell(q);if(p.length&&o.length){f.plugins.jiveblackout.showBlackout(f,p,o)}});var m=new h.MenuItem("rowItem",c,jive.rte.table.propertiesChooserRow(),{url:"../../../../../../images/tiny_mce3/themes/advanced/img/icons.gif",xOffset:780,yOffset:20,width:20,height:20},e("rowProps",this.editRowProperties),null,function(){var o=this.findContextNode(f.selection.getRng(true));f.plugins.jiveblackout.showBlackout(f,$j(o).parents("tr"))});var a=new h.MenuItem("cellItem",c,jive.rte.table.propertiesChooserCell(),{url:"../../../../../../images/tiny_mce3/themes/advanced/img/icons.gif",xOffset:600,yOffset:20,width:20,height:20},e("cellProps",this.editCellProperties),null,function(){var o=this.findContextNode(f.selection.getRng(true));f.plugins.jiveblackout.showBlackout(f,$j(o))});var i=new h.MenuItem("deleteTableItem",c,jive.rte.table.deleteText(),{url:"../../../../../../images/tiny_mce3/themes/advanced/img/icons.gif",xOffset:620,yOffset:20,width:20,height:20},function(o){var p=$j(o).closest("table");if(p.length){p.remove();f.execCommand("mceRepaint");f.nodeChanged()}return true},null,n);this.propertyChooserMenu=new h.Menu([k,b,m,a,i],true,false,jive.rte.table.editText(),null,j);return new h.MenuItem("tablePropsItem",c,null,{url:"../../../../../../images/tiny_mce3/themes/advanced/img/icons.gif",xOffset:580,yOffset:20,width:20,height:20},this.propertyChooserMenu)}return null},init:function(a){this.ed=a;a.onInit.add(function(){this.popOverMenu=this.buildPopover(a);if(a.plugins.jivecontextmenu){a.plugins.jivecontextmenu.addRootItem(this.popOverMenu)}},this)},getInfo:function(){return{longname:"Jive Table",author:"Jive Software",authorurl:"http://jivesoftware.com",infourl:"http://jivesoftware.com",version:tinyMCE.majorVersion+"."+tinyMCE.minorVersion}}});tinymce.PluginManager.add("jivetable",tinymce.plugins.JiveTablePlugin)})();
;
tinyMCE.addI18n('en.jiveemoticons',{
    title : 'Insert emoticon',
    desc : 'Emoticons'
});
;
(function(){tinymce.create("tinymce.plugins.JiveButtonsPlugin",{execCommand:function(b,a,c){if(b=="mceNull"){return true}return false},initToolbar:function(j){var h,f,n;if(!j||typeof(j)!="string"){var e=window.editor.toArray();for(f=0;f<e.length;f++){if(e[f]&&e[f].getID){this.initToolbar(e[f].getID())}}return}else{h=tinyMCE.get(j)}var l=document.getElementById(j+"_magicspacer0");var g=document.getElementById(j+"_magicspacer1");var m=document.getElementById(j+"_toolbar1");if(l){var o=m.rows[0].cells;var d=0;for(f=1;f<3;f++){n=o[f];d+=jive.ext.x.xWidth(n)}d+=26;m=document.getElementById(j+"_toolbar2");o=m.rows[0].cells;var c=0;for(f=6;f<7;f++){n=o[f];c+=jive.ext.x.xWidth(n)}c+=133;c+=6;var b=d-c;if(b<-100){return}else{if(b<-30){var k=this;setTimeout(function(){k.initToolbar(j)},33);return}else{if(b<0){jive.ext.x.xDisplayNone(g);jive.ext.x.xDisplayBlock(l);jive.ext.x.xWidth(l,(b*-1)-1)}else{jive.ext.x.xDisplayNone(l);jive.ext.x.xDisplayBlock(g);if(b<=0){jive.ext.x.xDisplayNone(g)}else{jive.ext.x.xWidth(g,b-5)}}}}}var a=document.getElementById(j+"_spellchecker");if(a!==null){n=h.dom.getParent(a,function(i){return i!=a});n.style.width="100%"}if(tinymce.isIE){if(document.documentMode&&document.documentMode>7){}else{$j("#wysiwygtext_magicspacer1").closest("td").css("padding",0)}}},init:function(a,b){this.url=b;var c=this;this.index=0;this.mindex=0;a.onInit.add(function(d){var e=$j('[id="'+d.id+'_toolbar1"]').get(0);var f=e.parentNode;if(tinymce.isIE){f.style.height=this.settings.default_height+"px"}else{f.style.height=(this.settings.default_height-1)+"px"}f.style.bottom="0px"})},getInfo:function(){return{longname:"Jive Buttons",author:"Jive Software",authorurl:"http://jivesoftware.com",infourl:"http://jivesoftware.com",version:tinyMCE.majorVersion+"."+tinyMCE.minorVersion}},createControl:function(d,a){var b;if(d=="spacerbutton"){b=a.createButton("spacerbutton"+this.index,{"class":"jive_spacer_button jive_spacer_button"+this.index,cmd:"mceNull"});this.index++;return b}if(d=="magicspacer"){b=a.createButton("magicspacer"+this.mindex,{"class":"jive_spacer_button jive_magicspacer_button",cmd:"mceNull"});this.mindex++;return b}return null}});tinymce.PluginManager.add("jivebuttons",tinymce.plugins.JiveButtonsPlugin)})();
;
(function(){function a(b){return(b.shiftKey?"Shift":"")+(b.ctrlKey||b.metaKey?"Ctrl":"")+(b.altKey?"Alt":"")}tinymce.create("tinymce.plugins.JiveKeyboardPlugin",{init:function(b){var d={};function c(h){var k=d[h.type];if(!k){return null}var i=h.keyCode;if(h.type=="keypress"){if(h.which!=null&&h.which!=0&&h.charCode!=0){i=h.which}}var j=k[i];if(!j){return null}var g=a(h);return j[g]}function e(i,h,k,j){if(k==null){k={}}if(!d[i]){d[i]={}}if(!d[i][h]){d[i][h]={}}var g=a(k);d[i][h][g]=j}function f(h,g){var i=c(g);if(i){return i(h,g)}}b.onKeyDown.add(f);b.onKeyPress.add(f);b.onKeyUp.add(f);e("keydown",27,{},function(h,g){$j("input:submit:visible",h.getContentAreaContainer().ownerDocument).get(0).focus();return tinymce.dom.Event.cancel(g)});e("keydown",27,{shiftKey:true},function(h,g){$j("input:text[name=subject]:visible",h.getContentAreaContainer().ownerDocument).get(0).focus();return tinymce.dom.Event.cancel(g)});this.addHandler=e},getInfo:function(){return{longname:"Jive Keyboard",author:"Jive Software",authorurl:"http://jivesoftware.com",infourl:"http://jivesoftware.com",version:tinyMCE.majorVersion+"."+tinyMCE.minorVersion}}});tinymce.PluginManager.add("jivekeyboard",tinymce.plugins.JiveKeyboardPlugin)})();
;
(function(){tinymce.create("tinymce.plugins.JiveLinkPlugin",{getInfo:function(){return{longname:"Content Picker",author:"Jive Software",authorurl:"http://www.jivesoftware.com",infourl:"http://www.jivesoftware.com/",version:"1.0"}},init:function(a,b){a.onBeforeGetContent.add(function(){if(this.lastActive!=null){a.dom.removeClass(this.lastActive,"active_link");this.lastActive=null}},this);a.onNodeChange.add(this.nodeChanged,this)},createControl:function(d,a){switch(d){case"jivelink":var b=a.createButton("jivelink",{title:"jivelink.link_desc",cmd:"mceJiveLink"});return b}return""},execCommand:function(e,d,f){switch(e){case"mceJiveLink":var h=false;var a=tinyMCE.activeEditor;var g=a.selection.getContent();var c=a.selection.getNode();var b=a.dom.getParent(c,"a");if(b!=null){a.dom.removeClass(b,"active_link");if(a.plugins.jivemacros.isExactMacro(b)){a.plugins.jivemacros.deleteMacro(a,b)}else{a.execCommand("unlink")}return true}else{if(a.selection.getNode()){h=(a.selection.getNode().nodeName.toLowerCase()=="img")||(g&&g.length>0)}a.windowManager.open({url:CS_BASE_URL+"/content-picker!input.jspa?name="+escape(g)+"&instantiatedFromGUIEditor=true",width:700+a.getLang("jivelink.delta_width",0),height:555+a.getLang("jivelink.delta_height",0),inline:"yes"},{editor_id:a.id});return true}}return false},lastActive:null,nodeChanged:function(b,a,g,h){if(g==null){return}var f=b.dom.getParent(g,"a");if(f!=null){b.controlManager.get("jivelink").setActive(true)}else{b.controlManager.get("jivelink").setActive(false)}var d=this.lastActive==null||this.lastActive!=g;if(this.lastActive!=null&&this.lastActive!=g){b.dom.removeClass(this.lastActive,"active_link");this.lastActive=null}var c=b.dom.getParent(g,"a");if(c&&c.nodeName.toLowerCase()=="a"&&this.lastActive==null){this.lastActive=c;b.dom.addClass(this.lastActive,"active_link")}var e=b.plugins.jivemacros.getMacroFor(g);if(e!=null&&e.getMacroType()=="INLINE"){if(this.lastActive==null||this.lastActive!=g){this.lastActive=this.isMacro(g);b.dom.addClass(this.lastActive,"active_link")}if(d&&this.lastActive.childNodes.length>0&&b.dom.hasClass(this.lastActive,"default_title")){b.selection.select(this.lastActive.childNodes[0])}}}});tinymce.PluginManager.add("jivelink",tinymce.plugins.JiveLinkPlugin)})();
;
tinyMCE.addI18n('en.jivelink',{
    link_desc : 'Insert Link'
});
;
(function(){tinymce.create("tinymce.plugins.JiveImagePlugin",{getInfo:function(){return{longname:"Image Picker",author:"Jive Software",authorurl:"http://www.jivesoftware.com",infourl:"http://www.jivesoftware.com/",version:"1.0"}},init:function(a,b){a.onInit.add(function(){if(!a.settings.images_enabled){a.controlManager.get("jiveimage").setDisabled(true)}else{if(a.plugins.jivecontextmenu){var f=a.plugins.jivecontextmenu;var d=new f.MenuItem("floatLeftItem",null,a.getLang("jiveimage.float_left"),{url:"../../../../../../images/tiny_mce3/themes/advanced/img/iconmaster.gif",xOffset:172,yOffset:90,width:28,height:21},"jiveImgFloatLeft");var h=new f.MenuItem("inlineItem",null,a.getLang("jiveimage.inline"),{url:"../../../../../../images/tiny_mce3/themes/advanced/img/iconmaster.gif",xOffset:144,yOffset:90,width:28,height:21},"jiveImgInline");var e=new f.MenuItem("floatRightItem",null,a.getLang("jiveimage.float_right"),{url:"../../../../../../images/tiny_mce3/themes/advanced/img/iconmaster.gif",xOffset:200,yOffset:90,width:28,height:21},"jiveImgFloatRight");var c=new f.MenuItem("originalSizeItem",null,a.getLang("jiveimage.original_size"),{url:"../../../../../../images/tiny_mce3/themes/advanced/img/iconmaster.gif",xOffset:165,yOffset:158,width:28,height:21},"jiveImgOriginalSize");var i=new f.Menu([d,h,e,c],true,false,a.getLang("jiveimage.menu_hdr"));var g=new f.MenuItem("jiveImageItem",/img/i,null,{url:"../../../../../../images/tiny_mce3/themes/advanced/img/iconmaster.gif",xOffset:155,yOffset:0,width:24,height:22},i);f.addRootItem(g)}}},this)},createControl:function(d,a){switch(d){case"jiveimage":var b=a.createButton("jiveimage",{title:"jiveimage.link_desc",cmd:"mceJiveImage"});return b}return""},execCommand:function(c,b,d){var a=tinyMCE.activeEditor,e;switch(c){case"mceJiveImage":if(tinyMCE.settings.jive_image_picker_url){a.windowManager.open({url:CS_BASE_URL+tinyMCE.settings.jive_image_picker_url+"&instantiatedFromGUIEditor=true",width:580+a.getLang("jiveimage.delta_width",0),height:425+a.getLang("jiveimage.delta_height",0),inline:"yes"},{editor_id:a.id})}else{a.execCommand("mceAdvImage")}return true;case"jiveImgFloatLeft":e=a.selection.getNode();if(/^img$/i.test(e.nodeName)){a.dom.setStyle(e,"float","left")}break;case"jiveImgFloatRight":e=a.selection.getNode();if(/^img$/i.test(e.nodeName)){a.dom.setStyle(e,"float","right")}break;case"jiveImgInline":e=a.selection.getNode();if(/^img$/i.test(e.nodeName)){a.dom.setStyle(e,"float","none")}break;case"jiveImgOriginalSize":e=a.selection.getNode();if(/^img$/i.test(e.nodeName)){a.dom.setStyle(e,"width","");a.dom.setStyle(e,"height","");a.dom.setAttrib(e,"width",null);a.dom.setAttrib(e,"height",null)}break}return false},handleNodeChange:function(f,d,e,c,a,b){if(d==null){return}do{if(d.nodeName=="IMG"&&tinyMCE.getAttrib(d,"src")!=""){tinyMCE.switchClass(f+"_jiveimage","mceButtonSelected");return true}}while((d=d.parentNode));if(b){tinyMCE.switchClass(f+"_jiveimage","mceButtonNormal");return true}tinyMCE.switchClass(f+"_jiveimage","mceButtonDisabled");return true}});tinymce.PluginManager.add("jiveimage",tinymce.plugins.JiveImagePlugin)})();
;
tinyMCE.addI18n('en.jiveimage',{
    link_desc : 'Insert Image'
});
;
(function(){tinymce.create("tinymce.plugins.JiveQuotePlugin",{getInfo:function(){return{longname:"Jive Quote Button",author:"Jive Software",authorurl:"http://www.jivesoftware.com",infourl:"http://www.jivesoftware.com/",version:"1.0"}},createControl:function(d,a){switch(d){case"jivequote":var b=a.createButton("jivequote",{title:"jivequote.link_desc",cmd:"mceJiveQuote"});return b}return""},execCommand:function(d,l,c){switch(d){case"mceJiveQuote":var j=tinyMCE.activeEditor;var b=j.selection;var f=null;var h=b.isCollapsed();j.undoManager.add();var e=j.plugins.jiveutil.findMacro("quote");f=j.plugins.jivemacros.insertMacro(j,e);if(f&&h){while(f.childNodes.length>0){f.removeChild(f.childNodes[0])}if($def(window._jive_gui_quote_text)){var a=j.getDoc().createElement("DIV");a.innerHTML=_jive_gui_quote_text;if(a.childNodes.length>0){for(i=0;i<a.childNodes.length;i++){if(a.childNodes[i].nodeType==1){var m=a.childNodes[i];var g=m.childNodes[0];while(g.childNodes.length>0){if(g.childNodes[0].className=="jive-quote-header"){var k=j.getDoc().createElement("P");k.appendChild(g.childNodes[0].childNodes[0]);f.appendChild(k);f.appendChild(j.plugins.jivemacros.createEmptyPara(j.getDoc()));g.removeChild(g.childNodes[0]);g.removeChild(g.childNodes[0]);g.removeChild(g.childNodes[0])}else{f.appendChild(g.childNodes[0])}}}}}if(f.childNodes.length==0){f.appendChild(j.plugins.jivemacros.createEmptyPara(j.getDoc()))}}else{f.appendChild(j.plugins.jivemacros.createEmptyPara(j.getDoc()))}}else{}j.undoManager.add();return true}return false}});tinymce.PluginManager.add("jivequote",tinymce.plugins.JiveQuotePlugin)})();
;
tinyMCE.addI18n('en.jivequote',{
    link_desc : 'Quote Previous Message'
});

;
(function(){tinymce.create("tinymce.plugins.JiveUtilPlugin",{getInfo:function(){return{longname:"Jive Utility Plugin",author:"Jive Software",authorurl:"http://www.jivesoftware.com",infourl:"http://www.jivesoftware.com/",version:"1.0"}},findMacro:function(d){var c=jive.rte.macros;var b=this.findMacroIndex(d);if(b!=null){return c[b]}return null},findMacroIndex:function(d){var c=jive.rte.macros;for(var b=0;b<c.length;++b){if(c[b].getName()==d){return b}}return null},findColumnBoundsForCell:function(e){var h=$j();var b=null;var d=null;var g=0;var c=e.closest("table");var f=e.prevAll("td,th").andSelf().each(function(i,j){g+=$j(j).attr("colspan")?$j(j).attr("colspan"):1});c.find("tr").each(function(){var i=0;$j(this).find("td, th").each(function(j,k){i+=$j(k).attr("colspan")?$j(k).attr("colspan"):1;if(i>=g){h=h.add($j(k));return false}})});return h},findColumnFirstCell:function(b){return this.findColumnCellInRow(b,"tr:first")},findColumnLastCell:function(b){return this.findColumnCellInRow(b,"tr:last")},findColumnCellInRow:function(e,b){var f=$j();var i=null;var g=null;var c=0;var h=e.closest("table");var d=e.prevAll("td,th").andSelf().each(function(k,l){c+=$j(l).attr("colspan")?$j(l).attr("colspan"):1});var j=0;h.find(b).find("td, th").each(function(k,l){j+=$j(l).attr("colspan")?$j(l).attr("colspan"):1;if(j>=c){f=f.add($j(l));return false}});return f},convertRGBToHex:function(b){b=b.substr(b.indexOf("(")+1);b=b.substr(0,b.length-1);b=b.split(",");b[0]=parseInt($j.trim(b[0])).toString(16);b[1]=parseInt($j.trim(b[1])).toString(16);b[2]=parseInt($j.trim(b[2])).toString(16);if(b[0].length==1){b[0]="0"+b[0]}if(b[1].length==1){b[1]="0"+b[1]}if(b[2].length==1){b[2]="0"+b[2]}if(b.length==3||b[3]>0){return("#"+b[0]+b[1]+b[2]).toUpperCase()}return""},shouldEncodeHuh:function(b,e){var c=b.dom.getParent(e,function(f){return f==b.getBody()||b.plugins.jivemacros.isMacro(f)});if(!b.plugins.jivemacros.isMacro(c)){c=null}if(c!=null){var d=b.plugins.jivemacros.getMacroFor(c);if(d&&d.getName()=="code"){return false}}return true},walkDOMTreeKids:function(b,d,e){e(b);if(b==d){return true}for(var c=0;c<b.childNodes.length;c++){if(this.walkDOMTreeKids(b.childNodes[c],d,e)){return true}}return false},walkDOMTree:function(b,c,d){if(this.walkDOMTreeKids(b,c,d)){return true}while(b.nextSibling!=null){b=b.nextSibling;if(this.walkDOMTreeKids(b,c,d)){return true}}function f(g){if(g.nodeType==1&&g.nodeName.toLowerCase()=="body"){return g}if(g.parentNode.nextSibling==null){return f(g.parentNode)}return g.parentNode.nextSibling}var e=f(b);if(e.nodeType==1&&e.nodeName.toLowerCase()=="body"){return true}return this.walkDOMTree(e,c,d)},textLengthIn:function(c){var b=0;this.walkDOMTreeKids(c,null,function(d){if(d.nodeType==3){b+=d.nodeValue.length}});return b},getNodeAt:function(d,e){if(e==0){return d}if(d.nodeType!=1){return null}for(var c=0;c<d.childNodes.length;c++){var b=this.textLengthIn(d.childNodes[c]);if(e==0){return d.childNodes[c]}else{if(b>e){var f=this.getNodeAt(d.childNodes[c],e);if(f==null){return d}return f}else{e-=b}}}return null},arrayEquals:function a(d,c){if(d===c){return true}if(d==null||c==null||d.length!==c.length){return false}for(var b=0;b<d.length;++b){if(d[b]!==c[b]){return false}}return true},clone:function(b,k){var e=/ jQuery\d+="(?:\d+|null)"/g,h=/^\s+/;var d=b.map(function(i){return function(){if(!jQuery.support.noCloneEvent&&!jQuery.isXMLDoc(this)){var l=this.outerHTML;if(!l){var m=i.createElement("div");m.appendChild(this.cloneNode(true));l=m.innerHTML}return jQuery.clean([l.replace(e,"").replace(h,"")],i)[0]}else{return this.cloneNode(true)}}}(k));var j=["font-family","font-size","font-weight","font-style","text-transform","text-decoration","letter-spacing","word-spacing","line-height","text-align","vertical-align","direction","width","height","margin-top","margin-right","margin-bottom","margin-left","padding-top","padding-right","padding-bottom","padding-left","border-top-width","border-right-width","border-bottom-width","border-left-width","border-top-style","border-right-style","border-bottom-style","border-left-style","overflow-x","overflow-y","white-space","clip","list-style-image","list-style-position","list-style-type","marker-offset"];for(var f=0;f<j.length;f++){var g=j[f];var c=b.css(g);if(c&&(g!="width"||c!="0px")){d.css(g,b.css(g))}}return d}});tinymce.PluginManager.add("jiveutil",tinymce.plugins.JiveUtilPlugin)})();
;
(function(){function a(r){return r&&r.nodeType==3}function k(r){return a(r.c)}function b(r){return r&&r.c&&r.c.nodeType==1&&r.c.nodeName.toLowerCase()=="body"}function h(r){if(k(r)){return r.off==r.c.nodeValue.length}else{return r.off==r.c.childNodes.length}}function d(r){return k(r)&&r.c.nodeValue.length==0}function q(r){var s=g(r);return(k(r)&&!h(r))||(s&&s.nodeName.toLowerCase()=="br")}function p(r){r=r.toLowerCase();return function(s){var t=g(s);return t&&t.nodeName&&t.nodeName.toLowerCase()==r}}function e(r){r=r.toLowerCase();return function(s){return s&&s.c.nodeType==1&&s.c.nodeName.toLowerCase()==r}}function m(s){return function r(t){return t.c==s}}function g(r){if(r.c&&r.off>=0&&r.c.childNodes&&r.c.childNodes.length>r.off){return r.c.childNodes[r.off]}return null}function l(r){if(r&&q(r)){return r.c.nodeValue.charAt(r.off)}return null}function i(r){var s=tinymce.activeEditor.dom;return{c:r.parentNode,off:s.nodeIndex(r)}}function f(r){var s=tinymce.activeEditor.dom;return{c:r.parentNode,off:s.nodeIndex(r)+1}}function o(r,s){r.setStart(s.c,s.off)}function j(r,s){r.setEnd(s.c,s.off)}function n(r){return{c:r.startContainer,off:r.startOffset}}function c(r){return{c:r.endContainer,off:r.endOffset}}tinymce.create("tinymce.plugins.JiveSelectionPlugin",{init:function(x,u){this.ed=x;this.isSelectionFrozen=false;var z=this;function A(C){if(C>65535){C-=65536;return String.fromCharCode(55296+(C>>10),56320+(C&1023))}else{return String.fromCharCode(C)}}function v(D){var C=D.c.parentNode;return D.c.nodeType==3&&D.c.nodeValue.length==D.off&&C.nodeName.toLowerCase()=="a"&&D.c==C.lastChild}function B(C){return function(F,E){var D=F.selection.getRng();var J=n(D);if(D.collapsed&&E.charCode>31&&!E.ctrlKey&&!E.altKey&&!E.metaKey&&C(J)){var H=A(E.charCode);do{J=z.dfsNext(J,false)}while(J&&!q(J));if(H==" "&&/[ \xa0]/.test(l(J))){H="\xa0"}var I=F.getDoc().createTextNode(H);var G=n(D);while(k(G)){G=z.dfsNext(G,true)}G.c.insertBefore(I,g(G));D.setStart(I,H.length);D.collapse(true);z.setSelection(D,true);E.preventDefault()}}}if(!tinymce.isIE){x.onFormatChange.add(function(D,C){if(D.inline&&!C){z.isSelectionFrozen=true}});x.onNodeChange.addToTop(function(D,C,E){if(!z.isSelectionFrozen){z.normalizeSelection()}});function w(D,C){z.isSelectionFrozen=false}x.onKeyDown.add(w);x.onMouseDown.add(w);if(tinymce.isWebKit){function t(C){return C.c.nodeType==1}x.onKeyPress.add(B(t))}var r=p("a");var y=function(C){if(C.off>0){return r({c:C.c,off:C.off-1})}return false};var s=e("a");x.onKeyPress.add(B(v));x.onKeyDown.add(function(G,L){var O=L.keyCode;if(G.selection.isCollapsed()&&(O==37||O==39||O==8||O==46)){var C=G.selection.getRng(true);var J=n(C);var I=z.dfsNext(J,true);var M=z.dfsNext(J,false);var N=null;if(r(J)||(k(J)&&h(J)&&r(I))){var E=r(J)?J:I;if(O==39){N={c:g(E),off:0};L.preventDefault()}else{if(O==46){N={c:g(E),off:0}}}}else{if((s(J)&&J.off==0)||(J.off==0&&M.off==0&&s(M))){var H=s(J)?J:M;if(O==37){N=i(H.c);L.preventDefault()}else{if(O==8){N=i(H.c)}}}else{if((s(J)&&h(J))||(h(I)&&s(I))){var D=s(J)?J:I;if(O==39){N=i(D.c);N.off+=1;L.preventDefault()}else{if(O==46){N=i(D.c);N.off+=1}}}else{if(y(J)||(y(M))){var K=y(J)?J:M;if(O==37){var F=g({c:K.c,off:K.off-1});N={c:F,off:F.childNodes.length};L.preventDefault()}else{if(O==8){F=g({c:K.c,off:K.off-1});N={c:F,off:F.childNodes.length}}}}}}}if(N){o(C,N);C.collapse(true);G.selection.setRng(C)}}})}},logSelection:function(u){var r=this.ed.selection.getRng(true).cloneRange();if(!u){u=""}function v(x){var w=x.nodeName;if(w=="#text"){w="#"+x.nodeValue}return w}var s=this.ed.selection.getSel();if(s.rangeCount==0){console.log(u+"No selection.")}else{var t=this.isForwardSelection()?"->":"<-";console.log(u+"current selection range: "+v(r.startContainer)+"["+r.startOffset+"] - "+v(r.endContainer)+"["+r.endOffset+"] Direction "+t,r);if(s.anchorNode){console.log("Anchor-focus"+(s.baseNode!=null?", base-extent: ":": ")+v(s.anchorNode)+"["+s.anchorOffset+"] - "+v(s.focusNode)+"["+s.focusOffset+"]"+(s.baseNode!=null?", "+v(s.baseNode)+"["+s.baseOffset+"] - "+v(s.extentNode)+"["+s.extentOffset+"]":""))}}},logRange:function(s,r){if(!s){s=""}function t(v){var u=v.nodeName;if(u=="#text"){u="#"+v.nodeValue}return u}console.log(s+": range: "+t(r.startContainer)+"["+r.startOffset+"] - "+t(r.endContainer)+"["+r.endOffset+"]",r)},normalizeSelection:function(){if(!tinymce.isIE){var t=this.ed.selection;var w=t.getSel();if(!w){return}if(w.rangeCount==0){console.log("range count was 0 when attempting to normalize selection");return}var v=this.isForwardSelection(w);var r=t.getRng(true);var y=r;if(y.startContainer==y.endContainer&&y.startOffset==y.endOffset&&y.startContainer.nodeName.toLowerCase()=="body"){var x=y.startOffset;if(x<y.startContainer.childNodes.length){var s=y.startContainer.childNodes[x];y=this.ed.dom.createRng();y.setStart(s,0);y.setEnd(s,0)}}var u=this.normalizeRange(y);if(u.compareBoundaryPoints(u.START_TO_START,r)!=0||u.compareBoundaryPoints(u.END_TO_END,r)!=0){this.setSelection(u,v)}}},isForwardSelection:function(r){if(!r){r=this.ed.selection.getSel()}if(r.anchorNode==null||r.focusNode==null){return true}var t=this.ed.dom.createRng();t.setStart(r.anchorNode,r.anchorOffset);t.collapse(true);var s=this.ed.dom.createRng();s.setStart(r.focusNode,r.focusOffset);s.collapse(true);return t.compareBoundaryPoints(t.START_TO_START,s)<=0},setSelection:function(r,t){var s=this.ed.selection.getSel();if(s.collapse!=null&&s.extend!=null){if(t){s.collapse(r.startContainer,r.startOffset);s.extend(r.endContainer,r.endOffset)}else{s.collapse(r.endContainer,r.endOffset);s.extend(r.startContainer,r.startOffset)}}else{this.ed.selection.setRng(r)}},getInfo:function(){return{longname:"Jive Selection",author:"Jive Software",authorurl:"http://jivesoftware.com",infourl:"http://jivesoftware.com",version:tinyMCE.majorVersion+"."+tinyMCE.minorVersion}},isBookmark:function(r){var s=this.ed.dom.get(r);return s&&s.nodeName.toLowerCase()=="span"&&this.ed.dom.getAttrib(s,"_mce_type")=="bookmark"},removeBookmark:function(s){if(s.id!=null){var t=this.ed.dom;function r(v){var u;while(u=t.get(v)){tinymce.each(tinymce.grep(u.childNodes),function(w){if(w.nodeType==3){w.nodeValue=w.nodeValue.replace(/\uFEFF/g,"")}});t.remove(u,1)}}r(s.id+"_start");r(s.id+"_end")}},adjustForBookmark:function(r,t){if(t==null){t=true}var s=this;function v(y){var x=g(y);if(s.isBookmark(x)){return x}x=y.c;if(s.isBookmark(x)){return x}x=y.c.parentNode;if(s.isBookmark(x)){return x}return null}var u=false;var w=v(n(r));if(w){if(t){o(r,i(w))}else{o(r,f(w))}u=true}w=v(c(r));if(w){if(t){j(r,f(w))}else{j(r,i(w))}u=true}return u},isEffectivelyEmpty:function(s){if(s.childNodes&&s.childNodes.length>0){var r=s.firstChild;while(r){if(r.nodeType!=3&&r.nodeName.toLowerCase()!="br"||r.nodeType==3&&tinymce.trim(r.nodeValue).length>0){return false}r=r.nextSibling}}return true},isEffectivelyEmptyList:function(t){var r=/^(?:ul|ol|li)$/i;if(r.test(t.nodeName)){var s=t.firstChild;while(s){if(r.test(s.nodeName)){if(!this.isEffectivelyEmptyList(s)){return false}}else{if(s.nodeType!=3&&s.nodeName.toLowerCase()!="br"||s.nodeType==3&&tinymce.trim(s.nodeValue).length>0){return false}}s=s.nextSibling}return true}return false},splitAtEndpoints:function(r,x){var w=this.ed,u=w.dom,y=this;function D(G){if(k(G)){if(G.off==0){G=i(G.c)}else{if(G.off==G.c.nodeValue.length){G=i(G.c);G.off+=1}else{G=i(G.c.splitText(G.off))}}}var E=u.create("br",{id:u.uniqueId()});var F=g(G);G.c.insertBefore(E,F);return E}var B=D(c(r));var z=D(n(r));r=u.createRng();r.setStartBefore(z);r.setEndAfter(B);if(!x){var t=/^(?:body|pre|td)$/i;x=function v(E){return t.test(E.nodeName)}}function C(F,E){while(E.parentNode!=F&&!x(E.parentNode)){u.split(E.parentNode,E)}if(E.nextSibling&&E.nextSibling.nodeType==1&&(y.isEffectivelyEmpty(E.nextSibling)||y.isEffectivelyEmptyList(E.nextSibling))){u.remove(E.nextSibling)}}var s=null;if(r.commonAncestorContainer.nodeName.toLowerCase()=="li"){s=r.commonAncestorContainer}else{if(r.commonAncestorContainer.parentNode.nodeName.toLowerCase()=="ul"||r.commonAncestorContainer.parentNode.nodeName.toLowerCase()=="ol"){s=r.commonAncestorContainer.parentNode.parentNode}else{s=r.commonAncestorContainer.parentNode}}C(s,B);C(s,z);var A=i(z);u.remove(z);o(r,A);A=i(B);u.remove(B);j(r,A);return r},getExpandedBlockRange:function(r,z,u){var t=this.ed.dom;var w=t.createRng();r=this.normalizeRange(r);this.adjustForBookmark(r,true);if(z==null){z=function(B){return t.isBlock(B)}}if(u==null){u="body, td, pre"}var A=t.getParent(r.startContainer,u);var v=t.getParent(r.endContainer,u);if(!A||!v||A!=v){return null}try{var y;if(A==r.startContainer){y=r.startContainer.childNodes[r.startOffset]}else{y=t.getParent(r.startContainer,z)}var s;if(v==r.endContainer){s=r.endContainer.childNodes[Math.max(0,r.endOffset-1)]}else{s=t.getParent(r.endContainer,z)}if(y==null&&s==null&&r.collapsed){w.setStart(r.startContainer,r.startOffset);w.setEnd(r.endContainer,r.endOffset);return w}if(y.parentNode!=s.parentNode){return null}w.setStart(y.parentNode,t.nodeIndex(y));w.setEnd(s.parentNode,t.nodeIndex(s)+1);return w}catch(x){console.log("error expanding range: ",x,r);return null}},dfsNext:function(u,y,s){var t=this.ed.dom;function w(A){return A.c.parentNode==null}if(!s){s=w}function r(A){if(k(A)){return null}if(y){var B=g(A);if(!B){return null}}else{A=x(A);if(!A){return null}B=g(A);if(!B){return null}}if(a(B)){return{c:B,off:y?0:B.nodeValue.length}}else{return{c:B,off:y?0:B.childNodes.length}}}function x(B){var A;if(k(B)){A={c:B.c,off:y?B.off+1:B.off-1};if(0<=A.off&&A.off<=A.c.nodeValue.length){return A}return null}else{A={c:B.c,off:y?B.off+1:B.off-1};if(0<=A.off&&A.off<=A.c.childNodes.length){return A}return null}}function z(A){if(s(A)||!A.c||!A.c.parentNode){return null}var B=A.c.parentNode;return{c:B,off:t.nodeIndex(A.c)+(y?1:0)}}var v=r(u);if(v){return v}v=x(u);if(v){return v}return z(u)},atStartOf:function(v,u){var s=this;if(u==null){var r=this.ed.selection.getRng(true);u=n(r)}function t(y,w){var x=null;while(y&&y.off==0&&(!x||x.c.parentNode==y.c)){x=y;if(w(y)){return y}y=s.dfsNext(y,false,b)}return null}return !!t(u,m(v))},atEndOf:function(v,u){var t=this;if(u==null){var s=this.ed.selection.getRng(true);u=n(s)}function r(z,x){var y=null;function w(A){var B=g(A);return A.c.nodeName.toLowerCase()=="br"||(B&&B.nodeName.toLowerCase()=="br")}while(w(z)||d(z)){z=t.dfsNext(z,true,b)}while(z&&h(z)&&(!y||y.c.parentNode==z.c)){y=z;if(x(z)){return z}do{z=t.dfsNext(z,true,b)}while(w(z)||d(z))}return null}return !!r(u,m(v))},safeNormalize:function(r,t){var z=this;if(t==null){t=r.commonAncestorContainer}if(t.nodeType==3){return r}r=r.cloneRange();if(!tinymce.isGecko){var w=this.ed.selection.getRng(true);var y=this.isForwardSelection();if(t.normalize){t.normalize()}if(this.ed.selection.getSel().rangeCount===0){this.setSelection(w,y)}}else{function x(B){var A=g(B);if(!A){if(k(B)){var D=B.c;var C=B.off;while(D.previousSibling&&D.previousSibling.nodeType==3){D=D.previousSibling;C+=D.nodeValue.length}A={c:D,off:C,cPrevSib:D.previousSibling,cParent:D.parentNode}}else{A={c:B.c,off:-1}}}else{if(a(A)){if(B.off==0){return B}else{if(A.nodeValue.length==0){return x({c:B.c,off:B.off+1})}else{if(A.previousSibling&&A.previousSibling.nodeType==3){return x({c:A,off:0})}}}}}return A}function v(A){var C,B;if(A.c!=null&&A.off!=null){if(A.c.parentNode!=null){C=A.c}else{if(A.cPrevSib!=null){C=A.cPrevSib.nextSibling;if(C==null){C=A.cParent;A.off=-1}else{if(C.nodeType!=3){return v(C)}}}else{C=A.cParent.firstChild;if(C==null){C=A.cParent;A.off=-1}else{if(C.nodeType!=3){return v(C)}}}}if(A.off==-1){B=C.childNodes.length}else{B=A.off}return{c:C,off:B}}else{C=A.parentNode;B=z.ed.dom.nodeIndex(A);return{c:C,off:B}}}var s=x({c:r.startContainer,off:r.startOffset});var u=x({c:r.endContainer,off:r.endOffset});if(t!=r.commonAncestorContainer){r.commonAncestorContainer.normalize()}t.normalize();s=v(s);u=v(u);o(r,s);j(r,u)}return r},normalizeRange:function(w){var K=this.ed.dom,r=w.collapsed,G=this;w=w.cloneRange();function L(Q){if(Q&&Q.nodeType==1){var P=K.getStyle(Q,"display",true);return P!="inline"&&P!="none"}return false}function x(P){var Q=g(P);return L(Q)||C(P)}function N(P){return L(P.c)}function C(P){return L(P.c)&&!g(P)}function I(P){return P==null||x(P)}function t(T,Q,S,R,P){while(T&&!R(T)){if(Q(T)){return T}T=G.dfsNext(T,S,P)}return null}function v(V,P,W,S,U,R){var Q=S?P:W;var T=t(V,Q,S,U,R);if(!T){Q=!S?P:W;T=t(V,Q,!S,U,R)}return T}function O(P){return k(P)&&P.off>0}function u(){var Q=Array.prototype.slice.apply(arguments);return function P(T){var R=true;for(var S=0;R&&S<Q.length;++S){R=R&&Q[S](T)}return R}}function A(){var Q=Array.prototype.slice.apply(arguments);return function P(T){var R=false;for(var S=0;!R&&S<Q.length;++S){R=R||Q[S](T)}return R}}function z(P){return function Q(R){return !P(R)}}var M=e("a");var s=A(b,M);var H=A(I,M);var E=e("br");var F=e("img");function J(R,Q){var P=v({c:R,off:Q},q,O,false,A(H,E,F),s);if(P){return P}else{P=v({c:R,off:Q},A(N,x),A(N,C),false,A(s,F),s);if(P){return P}return{c:R,off:Q}}}w=this.safeNormalize(w);if(r){var D=w.startContainer;if(D.nodeType==1&&!L(w.startContainer)&&w.startContainer.childNodes.length==0){return w}else{var B=J(w.startContainer,w.startOffset);o(w,B);w.collapse(true)}}else{function y(Q){var P=A(u(k,z(h)),F,p("img"),E,p("br"));function R(U,T){while(true){var S=G.dfsNext(U,T,b);if((S==null)||(S.c==U.c.parentNode&&K.isBlock(U.c))||(T&&P(U))||(!T&&P(S))){return U}U=S}}o(Q,R(n(Q),true));j(Q,R(c(Q),false))}y(w)}return w}});tinymce.PluginManager.add("jiveselection",tinymce.plugins.JiveSelectionPlugin)})();
;
(function(){tinymce.create("tinymce.plugins.JiveMousePlugin",{rte:null,$mouseCatch:$j("<div></div>"),init:function(a){var b=this;b.ed=a;this.reset=(function(d,c){return function(f,e){if(d.$mouseCatch.parent().length){d.$mouseCatch.css("top",c.plugins.jivescroll.lastScrollY);d.$mouseCatch.css("left",c.plugins.jivescroll.lastScrollX);d.$mouseCatch.css("width",d.rte.getContentAreaWidth());d.$mouseCatch.css("height",d.rte.getContentAreaHeight())}}})(this,a);a.onInit.add(function(c){b.$mouseCatch.css("position","absolute")},this);a.onScroll.add(this.reset,this);a.theme.onResize.add(function(){b.reset(a.plugins.jivescroll.lastScrollX,a.plugins.jivescroll.lastScrollY)},this);$j(window).resize(function(){b.reset(a.plugins.jivescroll.lastScrollX,a.plugins.jivescroll.lastScrollY)})},hideMouseCatch:function(){this.$mouseCatch.remove()},showMouseCatch:function(){var a=this.rte.getPopOverContainer();a.append(this.$mouseCatch);this.reset(this.ed.plugins.jivescroll.lastScrollX,this.ed.plugins.jivescroll.lastScrollY)},getInfo:function(){return{longname:"Jive Mouse",author:"Jive Software",authorurl:"http://jivesoftware.com",infourl:"http://jivesoftware.com",version:tinyMCE.majorVersion+"."+tinyMCE.minorVersion}}});tinymce.PluginManager.add("jivemouse",tinymce.plugins.JiveMousePlugin)})();
;
(function(){tinymce.create("tinymce.plugins.JiveVideoPlugin",{getInfo:function(){return{longname:"Video Picker",author:"Jive Software",authorurl:"http://www.jivesoftware.com",infourl:"http://www.jivesoftware.com/",version:"1.0"}},enabled:[],init:function(a,b){a.onInit.add(function(){var e=["youtube","dailymotion","vimeo","google","videomacro"],d=0,c=this;this.enabled=[];jive.rte.macros.forEach(function(f){if(e.some(function(g){return g===f.getName()})&&f.isEnabled&&f.isEnabled()){d+=1;c.enabled.push(f)}});if(d==0){a.controlManager.get("jivevideo").setDisabled(true)}},this)},createControl:function(d,a){switch(d){case"jivevideo":var b=a.createButton("jivevideo",{title:"jivevideo.link_desc",cmd:"mceJiveVideo"});return b}return""},execCommand:function(c,b,d){switch(c){case"mceJiveVideo":var a=tinyMCE.activeEditor;a.windowManager.open({url:CS_BASE_URL+"/upload-video!input.jspa"+_jive_video_picker__url,width:550+parseInt(a.getLang("jivevideo.delta_width",0)),height:430+parseInt(a.getLang("jivevideo.delta_height",0)),inline:1});return true}return false}});tinymce.PluginManager.add("jivevideo",tinymce.plugins.JiveVideoPlugin)})();
;
tinyMCE.addI18n('en.jivevideo',{
    link_desc : 'Insert Video'
});


;
tinyMCE.addI18n('en.jivevideo',{
    num1: "1. ",
    num2: "2. ",
    title_new:"Insert Video",
    general_props:"Video Properties",
    site_title:"Select a Video Site",
    embed_title: "Enter Video Information",
    embed: "Video URL or Embed Code (example: http://youtube.com/watch?v=videoIdHere)",
    embed_error : "Please enter a valid URL or embed code",
    name_youtube: "YouTube",
    name_vimeo: "Vimeo",
    name_veoh: "Veoh",
    name_dailymotion: "Dailymotion",
    name_google: "Google"
});
;
(function(){tinymce.create("tinymce.plugins.TableToolbarPlugin",{init:function(a,b){var c=this;a.onPostRender.add(function(){var h=tinymce.DOM.get(a.id+"_toolbar3");if($def(h)&&h!=null){var e=h.rows[0].cells[h.rows[0].cells.length-1];var j=h.rows[0].cells[0];h.rows[0].insertBefore(j,e);for(var g=0;g<h.rows[0].cells.length;g++){var d=h.rows[0].cells[g];var f=d.childNodes[0];if(f.nodeName.toLowerCase()=="a"){$j(d).mouseover(function(){$j(e).text(f.title)})}}$j(h).mouseout(function(){$j(e).html(" ")})}tinymce.DOM.hide(a.id+"_toolbar3")});a.onNodeChange.add(function(d){return function(f,e,j){var g=f.dom.getParent(j,"table");if($def(g)&&g!=null&&$def(g.tagName)){d._showToolbar()}else{d._hideToolbar()}var e=f.controlManager;var j=f.selection.getNode();var h=f.dom.getParent(j,"tr");var i=f.dom.getParent(j,"td,th");if(h!=null&&i!=null){if(h.nextSibling==null){e.get("row_down").setDisabled(true)}else{e.get("row_down").setDisabled(false)}if(h.previousSibling==null){e.get("row_up").setDisabled(true)}else{e.get("row_up").setDisabled(false)}if(i.previousSibling==null){e.get("col_left").setDisabled(true)}else{e.get("col_left").setDisabled(false)}if(i.nextSibling==null){e.get("col_right").setDisabled(true)}else{e.get("col_right").setDisabled(false)}}}}(this))},_hidden:true,settings:new Object(),_showToolbar:function(){var b=tinyMCE.activeEditor;var a=b.controlManager;var d=$j('[id="'+b.id+'_toolbar3"]').get(0);if(d){if(this._hidden){tinymce.DOM.show(b.id+"_toolbar3");var e=d.parentNode;if(tinymce.isIE){e.style.height=b.settings.default_height+"px"}else{e.style.height=(b.settings.default_height-1)+"px"}tinymce.DOM.show(b.id+"_toolbar3");this._hidden=false;var c=new jive.ext.y.ySlider(300,this.settings);c.addTicker(new jive.ext.y.SlideBottomToTicker(e,31));c.go()}}},_hideToolbar:function(){var b=tinyMCE.activeEditor;var a=b.controlManager;var d=$j('[id="'+b.id+'_toolbar3"]').get(0);if(d){if(!this._hidden){var e=d.parentNode;if(tinymce.isIE){e.style.height=b.settings.default_height+"px"}else{e.style.height=(b.settings.default_height-1)+"px"}tinymce.DOM.hide(b.id+"_toolbar3");this._hidden=true;var c=new jive.ext.y.ySlider(300,this.settings);c.addTicker(new jive.ext.y.SlideBottomToTicker(e,0));c.go()}}},_resizeIframe:function(b,a){var c=b.getContentAreaContainer().firstChild;tinymce.DOM.setStyle(c,"height",c.clientHeight+a);b.theme.deltaHeight+=a},createControl:function(d,a){switch(d){case"tabletoolbar":var b=a.createButton("tabletoolbar",{title:"tabletoolbar.title",cmd:"mceInsertTable",ui:true,value:{action:"insert"}});return b}return null},getInfo:function(){return{longname:"Table Toolbar Button",author:"Adam Wulf",authorurl:"http://www.jivesoftware.com",infourl:"",version:"1.0"}}});tinymce.PluginManager.add("tabletoolbar",tinymce.plugins.TableToolbarPlugin)})();
;
tinyMCE.addI18n('en.tabletoolbar',{
    title : 'Insert Table'
});

;
(function(){tinymce.create("tinymce.plugins.AlignmentPlugin",{init:function(a,b){a.addCommand("mceAlignment",function(){var c=this.controlManager;var d=c.get("mysplitbutton");d.showMenu()});a.addCommand("mceNoFloatImage",function(){var c=tinyMCE.activeEditor;var d=c.selection;var f=d.getNode();var e=c.dom;e.setStyle(f,"float","")});a.addCommand("MyJustifyLeft",function(){var c=this.selection.getNode();if(c.style.textAlign=="left"){return}c.style.textAlign="left"});a.addCommand("MyJustifyRight",function(){var c=this.selection.getNode();if(c.style.textAlign=="right"){return}c.style.textAlign="right"});a.addCommand("MyJustifyCenter",function(){var c=this.selection.getNode();if(c.style.textAlign=="center"){return}c.style.textAlign="center"});a.addCommand("MyJustifyFull",function(){var c=this.selection.getNode();if(c.style.textAlign=="justify"){return}c.style.textAlign="justify"});a.onNodeChange.add(function(c){return function(e,d,g){var f=d.get("mysplitbutton");if($def(f)){if(typeof(f.lastClass)!="undefined"&&f.lastClass!=null){f.setState(f.lastClass,false)}if(g.style.textAlign=="right"){f.lastClass="_justifyright";f.lastExec="MyJustifyRight"}else{if(g.style.textAlign=="center"){f.lastClass="_justifycenter";f.lastExec="MyJustifyCenter"}else{if(g.style.textAlign=="justify"){f.lastClass="_justifyfull";f.lastExec="MyJustifyFull"}else{if(g.style.textAlign=="left"){f.lastClass="_justifyleft";f.lastExec="MyJustifyLeft"}else{f.lastClass="_justifyleft";f.lastExec="MyJustifyLeft"}}}}if(f.lastClass!=null){f.setState(f.lastClass,true)}}}}(this));this.url=b;this.that=this},createControl:function(d,a){switch(d){case"alignment":var b=a.createSplitButton("mysplitbutton",{title:"Alignment",cmd:"mceAlignment"});b.onRenderMenu.add(function(f,e){e.add({cmd:"MyJustifyLeft","class":"mceSplitButton_justifyleft",title:"alignament.left"})});b.onRenderMenu.add(function(f,e){e.add({cmd:"MyJustifyCenter","class":"mceSplitButton_justifycenter",title:"alignment.center"})});b.onRenderMenu.add(function(f,e){e.add({cmd:"MyJustifyRight","class":"mceSplitButton_justifyright",title:"alignment.right"})});b.onRenderMenu.add(function(f,e){e.add({cmd:"MyJustifyFull","class":"mceSplitButton_justifyfull",title:"alignment.full"})});return b}return null},getInfo:function(){return{longname:"Fancy Justify Button",author:"Adam Wulf",authorurl:"http://www.jivesoftware.com",infourl:"",version:"1.0"}}});tinymce.PluginManager.add("alignment",tinymce.plugins.AlignmentPlugin)})();
;
(function(){var a=tinymce.util.JSONRequest,c=tinymce.each,b=tinymce.DOM;tinymce.create("tinymce.plugins.SpellcheckerPlugin",{getInfo:function(){return{longname:"Spellchecker",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/spellchecker",version:tinymce.majorVersion+"."+tinymce.minorVersion}},init:function(e,f){var g=this,d;g.url=f;g.editor=e;e.onBeginSpelling=new tinymce.util.Dispatcher(e);e.onEndSpelling=new tinymce.util.Dispatcher(e);e.onSpellCheckFinished=new tinymce.util.Dispatcher(e);e.addCommand("mceSpellCheck",function(){if(!g.active){e.onBeginSpelling.dispatch();e.setProgressState(1);g._cleanBody();g._sendRPC("checkWords",[g.selectedLang,g._getWords()],function(h){if(h.length>0){g.active=1;g._markWords(h);e.setProgressState(0);e.nodeChanged();e.onSpellCheckFinished.dispatch()}else{e.setProgressState(0);e.windowManager.alert("spellchecker.no_mpell");e.onEndSpelling.dispatch()}})}else{g._done()}});e.onInit.add(function(){if(e.settings.content_css!==false){e.dom.loadCSS(window.CS_RESOURCE_BASE_URL+"/styles/tiny_mce3/plugins/spellchecker/css/content.css")}});e.onClick.add(g._showMenu,g);if(e&&e.plugins.contextmenu){e.onContextMenu.add(g._showMenu,g)}e.onBeforeGetContent.add(function(){if(g.active){g._removeWords()}});e.onNodeChange.add(function(i,h){h.setActive("spellchecker",g.active)});e.onSetContent.add(function(){g._done()});e.onBeforeGetContent.add(function(){g._done()});e.onBeforeExecCommand.add(function(h,i){if(i=="mceFullScreen"){g._done()}});g.languages={};c(e.getParam("spellchecker_languages","+English=en,Danish=da,Dutch=nl,Finnish=fi,French=fr,German=de,Italian=it,Polish=pl,Portuguese=pt,Spanish=es,Swedish=sv","hash"),function(i,h){if(h.indexOf("+")===0){h=h.substring(1);g.selectedLang=i}g.languages[h]=i})},createControl:function(h,d){var f=this,g,e=f.editor;if(h=="spellchecker"){g=d.createSplitButton(h,{title:"spellchecker.desc",cmd:"mceSpellCheck",scope:f,offset_x:-150});g.onRenderMenu.add(function(j,i){i.add({title:"spellchecker.langs","class":"mceMenuItemTitle"}).setDisabled(1);c(f.languages,function(n,m){var p={icon:1},l;p.onclick=function(){l.setSelected(1);f.selectedItem.setSelected(0);f.selectedItem=l;f.selectedLang=n};p.title=m;l=i.add(p);l.setSelected(n==f.selectedLang);if(n==f.selectedLang){f.selectedItem=l}})});return g}},_walk:function(i,g){var h=this.editor.getDoc(),e;if(h.createTreeWalker){e=h.createTreeWalker(i,NodeFilter.SHOW_TEXT,null,false);while((i=e.nextNode())!=null){g.call(this,i)}}else{tinymce.walk(i,g,"childNodes")}},_getSeparators:function(){var e="",d,f=this.editor.getParam("spellchecker_word_separator_chars",' \\t\\r!"#$%&()*+,-./:;<=>?@[]^_{|}����������������\u201d\u201c');for(d=0;d<f.length;d++){e+="\\"+f.charAt(d)}return e},_cleanBody:function(){var e=this.editor,g=[],d="",f={},h=e.dom;this._walk(e.getBody(),function(i){while($def(i)&&i.nodeType==3&&i.nextSibling&&i.nextSibling.nodeType==3){i.nodeValue=i.nodeValue+i.nextSibling.nodeValue;i.nextSibling.parentNode.removeChild(i.nextSibling)}})},_getWords:function(){var e=this.editor,h=[],d="",f={},i=e.dom;var g=e.plugins.jivemacros;this._walk(e.getBody(),function(l){if(l.nodeType==3){var j=i.getParent(l,"span");var k=i.getParent(l,"pre");if(!(j!=null&&g.isMacro(j)||k!=null&&g.isMacro(k)&&g.getMacroFor(k).getName()!="quote")){d+=l.nodeValue+" "}}});d=d.replace(new RegExp("([0-9]|["+this._getSeparators()+"])","g")," ");d=tinymce.trim(d.replace(/(\s+)/g," "));c(d.split(" "),function(j){if(!f[j]){h.push(j);f[j]=1}});return h},_removeWords:function(e){var f=this.editor,h=f.dom,g=f.selection,d=g.getBookmark(BOOKMARKTYPE);c(h.select("span").reverse(),function(i){if(i&&(h.hasClass(i,"mceItemHiddenSpellWord")||h.hasClass(i,"mceItemHidden"))){if(!e||h.decode(i.innerHTML)==e){h.remove(i,1)}}});g.moveToBookmark(d)},_markWords:function(m){var g=this.editor,e=this._getSeparators(),f=g.dom,j=[];var i=g.selection,k=i.getBookmark(BOOKMARKTYPE);var l=g.plugins.jivemacros;var h=m.join("|");var d=new RegExp("(^|["+e+"])("+h+")(?=["+e+"]|$)","g");this._walk(this.editor.getBody(),function(o){if(o.nodeType==3){j.push(o)}});c(j,function(r){var p=f.getParent(r,"span");var q=f.getParent(r,"pre");if(!(p!=null&&l.isMacro(p)||q!=null&&l.isMacro(q)&&l.getMacroFor(q).getName()!="quote")){var o=r.nodeValue;d.lastIndex=0;if(d.test(o)){o=f.encode(o);o=o.replace(d,'$1<span class="mceItemHiddenSpellWord">$2</span>');f.replace(f.create("span",{"class":"mceItemHidden"},o),r)}}});i.moveToBookmark(k)},_showMenu:function(g,i){var h=this,g=h.editor,d=h._menu,k,j=g.dom;if(!d){k=b.getPos(g.getContentAreaContainer());d=g.controlManager.createDropMenu("spellcheckermenu",{offset_x:k.x,offset_y:k.y,"class":"mceNoIcons"});h._menu=d}if(j.hasClass(i.target,"mceItemHiddenSpellWord")){d.removeAll();d.add({title:"spellchecker.wait","class":"mceMenuItemTitle"}).setDisabled(1);h._sendRPC("getSuggestions",[h.selectedLang,j.decode(i.target.innerHTML)],function(e){d.removeAll();if(e.length>0){d.add({title:"spellchecker.sug","class":"mceMenuItemTitle"}).setDisabled(1);c(e,function(l){d.add({title:l,onclick:function(){j.replace(g.getDoc().createTextNode(l),i.target);g.undoManager.add();h._checkDone()}})});d.addSeparator()}else{d.add({title:"spellchecker.no_sug","class":"mceMenuItemTitle"}).setDisabled(1)}d.add({title:"spellchecker.ignore_word",onclick:function(){j.remove(i.target,1);h._checkDone()}});d.add({title:"spellchecker.ignore_words",onclick:function(){h._removeWords(j.decode(i.target.innerHTML));h._checkDone()}});d.update()});var f=j.getViewPort(g.getWin());g.selection.select(i.target);k=j.getPos(i.target);d.showMenu(k.x,k.y+i.target.offsetHeight-f.y);return tinymce.dom.Event.cancel(i)}else{d.hideMenu()}},_checkDone:function(){var e=this,d=e.editor,g=d.dom,f;c(g.select("span"),function(h){if(h&&g.hasClass(h,"mceItemHiddenSpellWord")){f=true;return false}});if(!f){e._done()}},_done:function(){var d=this,e=d.active;if(d.active){d.editor.onEndSpelling.dispatch();d.active=0;d._removeWords();if(d._menu){d._menu.hideMenu()}if(e){d.editor.nodeChanged()}}},_sendRPC:function(e,h,d){var g=this,f=g.editor.getParam("spellchecker_rpc_url","{backend}");if(f=="{backend}"){g.editor.setProgressState(0);alert("Please specify: spellchecker_rpc_url");return}a.sendRPC({url:f,method:e,params:h,success:d,error:function(j,i){g.editor.setProgressState(0);g.editor.windowManager.alert(j.errstr||("Error response: "+i.responseText))}})}});tinymce.PluginManager.add("spellchecker",tinymce.plugins.SpellcheckerPlugin)})();
;
(function(){tinymce.create("tinymce.plugins.StylePlugin",{init:function(a,b){a.addCommand("mceStyleProps",function(){a.windowManager.open({file:b+"/props.htm",width:480+parseInt(a.getLang("style.delta_width",0)),height:320+parseInt(a.getLang("style.delta_height",0)),inline:1},{plugin_url:b,style_text:a.selection.getNode().style.cssText,cs_resource_base_url:CS_RESOURCE_BASE_URL})});a.addCommand("mceSetElementStyle",function(d,c){if(e=a.selection.getNode()){a.dom.setAttrib(e,"style",c);a.execCommand("mceRepaint")}});a.onNodeChange.add(function(d,c,f){c.setDisabled("styleprops",f.nodeName==="BODY")});a.addButton("styleprops",{title:"style.desc",cmd:"mceStyleProps"})},getInfo:function(){return{longname:"Style",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/style",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("style",tinymce.plugins.StylePlugin)})();
;
(function(){var a=tinymce.each;tinymce.create("tinymce.plugins.TablePlugin",{putCursorInCell:function(b,f){var e=false;if(f.childNodes.length==0){if(f.childNodes.length==0){f.appendChild(b.plugins.jivemacros.createEmptyPara(b.getDoc()));e=true}}var d=f.childNodes[0];var c=f;while(d.nodeType==1&&d.childNodes.length){c=d;d=d.childNodes[0]}b.selection.select(tinymce.isIE?c:d);b.selection.collapse(true);if(e){f.removeChild(f.childNodes[0])}},tempTable:null,fixTable:function(){if(this.tempTable!=null&&$def(this.tempTable)&&this.tempTable.getAttribute("width")){var c=this.tempTable.getAttribute("width");if(c.indexOf("%")==-1){c+="px"}this.tempTable.style.width=c;this.tempTable.removeAttribute("width");this.tempTable.setAttribute("_mce_style",this.tempTable.getAttribute("style"))}if(this.tempTable.childNodes.length){var d=this.tempTable.childNodes[0];if(d.childNodes.length){var b=d.childNodes[0];if(b.childNodes.length){var e=b.childNodes[0];if(b.nodeName==e.nodeName&&b.nodeName.toLowerCase()=="tr"){while(b.childNodes.length){d.appendChild(b.childNodes[0])}d.removeChild(b)}}}}},fixInvisibleTableBorders:function(b,d){if(d.nodeType==1&&d.nodeName.toLowerCase()=="table"){if(d.style.borderCollapse=="collapse"){d.style.borderCollapse="separate";setTimeout(function(){d.style.borderCollapse="collapse"},330)}}else{if(d.nodeType==1){for(var c=0;c<d.childNodes.length;c++){this.fixInvisibleTableBorders(b,d.childNodes[c])}}}},init:function(b,c){var d=this;d.editor=b;d.url=c;a([["table","table.props_desc","mceInsertTable",true],["delete_table","table.del","mceTableDelete"],["delete_col","table.delete_col_desc","mceTableDeleteCol"],["delete_row","table.delete_row_desc","mceTableDeleteRow"],["col_after","table.col_after_desc","mceTableInsertColAfter"],["col_before","table.col_before_desc","mceTableInsertColBefore"],["row_after","table.row_after_desc","mceTableInsertRowAfter"],["row_before","table.row_before_desc","mceTableInsertRowBefore"],["row_props","table.row_desc","mceTableRowProps",true],["cell_props","table.cell_desc","mceTableCellProps",true],["split_cells","table.split_cells_desc","mceTableSplitCells",true],["merge_cells","table.merge_cells_desc","mceTableMergeCells",true],["row_up","table.row_up","mceTableRowUp",true],["row_down","table.row_down","mceTableRowDown",true],["col_left","table.col_left","mceTableColLeft",true],["col_right","table.col_right","mceTableColRight",true]],function(e){b.addButton(e[0],{title:e[1],cmd:e[2],ui:e[3]})});b.onInit.add(function(){if(tinymce.isGecko){b.plugins.table.fixInvisibleTableBorders(b,b.getBody())}if(b&&b.plugins.contextmenu){b.plugins.contextmenu.onContextMenu.add(function(h,f,j){var k,i=b.selection,g=i.getNode()||b.getBody();if(b.dom.getParent(j,"td")||b.dom.getParent(j,"th")){f.removeAll();if(g.nodeName=="A"&&!b.dom.getAttrib(g,"name")){f.add({title:"advanced.unlink_desc",icon:"unlink",cmd:"UnLink"});f.addSeparator()}if(g.nodeName=="IMG"&&g.className.indexOf("mceItem")==-1){f.add({title:"advanced.image_desc",icon:"image",cmd:b.plugins.advimage?"mceAdvImage":"mceImage",ui:true});f.addSeparator()}f.add({title:"table.props_desc",icon:"table_props",cmd:"mceInsertTable",ui:true});f.add({title:"table.del",icon:"delete_table",cmd:"mceTableDelete",ui:true});f.addSeparator();k=f.addMenu({title:"table.cell"});k.add({title:"table.cell_desc",icon:"cell_props",cmd:"mceTableCellProps",ui:true});k.add({title:"table.split_cells_desc",icon:"split_cells",cmd:"mceTableSplitCells",ui:true});k.add({title:"table.merge_cells_desc",icon:"merge_cells",cmd:"mceTableMergeCells",ui:true});k=f.addMenu({title:"table.row"});k.add({title:"table.row_desc",icon:"row_props",cmd:"mceTableRowProps",ui:true});k.add({title:"table.row_before_desc",icon:"row_before",cmd:"mceTableInsertRowBefore"});k.add({title:"table.row_after_desc",icon:"row_after",cmd:"mceTableInsertRowAfter"});k.add({title:"table.delete_row_desc",icon:"delete_row",cmd:"mceTableDeleteRow"});k.addSeparator();k.add({title:"table.cut_row_desc",icon:"cut",cmd:"mceTableCutRow"});k.add({title:"table.copy_row_desc",icon:"copy",cmd:"mceTableCopyRow"});if(b.tableRowClipboard){k.add({title:"table.paste_row_before_desc",icon:"paste",cmd:"mceTablePasteRowBefore"});k.add({title:"table.paste_row_after_desc",icon:"paste",cmd:"mceTablePasteRowAfter"})}k=f.addMenu({title:"table.col"});k.add({title:"table.col_before_desc",icon:"col_before",cmd:"mceTableInsertColBefore"});k.add({title:"table.col_after_desc",icon:"col_after",cmd:"mceTableInsertColAfter"});k.add({title:"table.delete_col_desc",icon:"delete_col",cmd:"mceTableDeleteCol"})}else{if(b.dom.getParent(j,"img")==null){f.add({title:"table.desc",icon:"table",cmd:"mceInsertTable",ui:true,value:{action:"insert"}})}}})}});b.onKeyUp.add(function(f,h){if(h.keyCode==9&&!h.ctrlKey&&!h.altKey){var g=f.dom.getParent(f.selection.getNode(),"li,td,th,caption");if(g!=null&&g.nodeName.toLowerCase()!="li"){if(h.shiftKey){if(g.previousSibling!=null){this.putCursorInCell(f,g.previousSibling)}else{var i=f.dom.getParent(g,"tr");if(i.previousSibling){this.putCursorInCell(f,i.previousSibling.cells[i.previousSibling.childNodes.length-1])}else{this.putCursorInCell(f,g)}}}else{if(g.nextSibling!=null){this.putCursorInCell(f,g.nextSibling)}else{var i=f.dom.getParent(g,"tr");if(i.nextSibling){this.putCursorInCell(f,i.nextSibling.cells[0])}else{f.execCommand("mceTableInsertRowAfter");this.putCursorInCell(f,i.nextSibling.cells[0])}}}f.nodeChanged();tinymce.dom.Event.cancel(h)}}},this);b.onKeyDown.add(function(f,h){if(h.keyCode==9&&!h.ctrlKey&&!h.altKey&&f.dom.getParent(f.selection.getNode(),"TABLE")){f.undoManager.add()}if(h.keyCode==9&&!h.ctrlKey&&!h.altKey){var g=f.dom.getParent(f.selection.getNode(),"td,th,caption");if(g!=null){tinymce.dom.Event.cancel(h)}}});b.onKeyPress.add(function(f,h){if(h.keyCode==9&&!h.ctrlKey&&!h.altKey){var g=f.dom.getParent(f.selection.getNode(),"td,th,caption");if(g!=null){tinymce.dom.Event.cancel(h)}}});if(!tinymce.isIE){if(b.getParam("table_selection",true)){b.onClick.add(function(f,g){g=g.target;if(g.nodeName==="TABLE"){f.selection.select(g)}})}}b.onMouseUp.add(function(f,h){var i=f.selection.getNode();var g=f.dom.getParent(i,"table");if(g){f.plugins.table.tempTable=g;if(h.target.nodeName.toLowerCase()=="tr"||h.target.nodeName.toLowerCase()=="table"){f.plugins.table._doExecCommand("fixMissingCells",g)}jive.ext.x.xTimer.set("timeout",f.plugins.table,"fixTable",33)}});b.onNodeChange.add(function(g,f,k){var i=g.dom.getParent(k,"td,th,caption");var e=g.dom.getParent(k,"td,th");if(e&&g.selection.isCollapsed()){var j=g.dom.getAttrib(e,"colspan");var h=g.dom.getAttrib(e,"rowspan");j=j==""?1:parseInt(j);h=h==""?1:parseInt(h);f.setDisabled("split_cells",j==1&&h==1);f.setDisabled("merge_cells",!(j==1&&h==1))}else{if(e){f.setDisabled("split_cells",false);f.setDisabled("merge_cells",false)}else{f.setDisabled("split_cells",true);f.setDisabled("merge_cells",true)}}if(i&&i.nodeName==="CAPTION"){i=null}f.setDisabled("delete_table",!i);f.setDisabled("delete_col",!i);f.setDisabled("delete_table",!i);f.setDisabled("delete_row",!i);f.setDisabled("col_after",!i);f.setDisabled("col_before",!i);f.setDisabled("row_after",!i);f.setDisabled("row_before",!i);f.setDisabled("row_props",!i);f.setDisabled("cell_props",!i)});if(!tinymce.isIE){b.onBeforeSetContent.add(function(e,f){if(f.initial){f.content=f.content.replace(/<(td|th)([^>]+|)>\s*<\/(td|th)>/g,tinymce.isOpera?"<$1$2>&nbsp;</$1>":'<$1$2><br mce_bogus="1" /></$1>')}})}b.onKeyDown.addToTop(function(h,j){var e=h.selection.getRng(true);if(e.collapsed){if(j.keyCode==39||j.keyCode==40){var o=h.dom.getParent(e.startContainer,"p");if(o&&h.plugins.jiveselection.isEffectivelyEmpty(o)&&this.isFirst(h.getBody(),o)){var g=o.nextSibling;while(g&&g.nodeType!=1){g=g.nextSibling}if(g&&g.nodeName.toLowerCase()=="p"){g=g.firstChild}if(g&&g.nodeName.toLowerCase()=="table"){setTimeout(function(){o.parentNode.removeChild(o)},0)}}}else{if(j.keyCode==38){var k=h.dom.getParent(e.startContainer,"td, th");if(k){var m=h.dom.getParent(k,"table");if(this.isFirst(h.getBody(),m)){var i=h.dom.getParent(k,"tr");if(this.isFirst(m,k)){var f=h.plugins.jivemacros.createEmptyPara(h.getDoc());var l=m;while(l.parentNode.nodeName.toLowerCase()!="body"){l=l.parentNode}l.parentNode.insertBefore(f,l)}}}}}}},this)},isFirst:function(b,c){if(b.childNodes.length==0){return false}return(b.childNodes[0]==c||this.isFirst(b.childNodes[0],c))},execCommand:function(g,f,h){var d=this.editor,c;switch(g){case"mceInsertTable":case"mceTableRowProps":case"mceTableCellProps":case"mceTableSplitCells":case"mceTableMergeCells":case"mceTableInsertRowBefore":case"mceTableInsertRowAfter":case"mceTableDeleteRow":case"mceTableInsertColBefore":case"mceTableInsertColAfter":case"mceTableDeleteCol":case"mceTableCutRow":case"mceTableCopyRow":case"mceTablePasteRowBefore":case"mceTablePasteRowAfter":case"mceTableDelete":case"JustifyLeft":case"JustifyCenter":case"JustifyRight":case"JustifyFull":case"mceTableRowUp":case"mceTableRowDown":case"mceTableColLeft":case"mceTableColRight":d.execCommand("mceBeginUndoLevel");var e=this._doExecCommand(g,f,h);if(e==-1){return false}if(e){d.execCommand("mceEndUndoLevel");d.undoManager.add(false,true)}return true}return false},getInfo:function(){return{longname:"Tables",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/table",version:tinymce.majorVersion+"."+tinymce.minorVersion}},_doExecCommand:function(ab,T,M){var b=this.editor,e=b,v=this.url;var aD=b.selection.getNode();var aA=b.dom.getParent(aD,"tr");var Z=b.dom.getParent(aD,"td,th");var m=b.dom.getParent(aD,"table");var D=b.contentWindow.document;var ar=m?m.getAttribute("border"):"";if(aA&&Z==null){Z=aA.cells[0]}function u(x,r){for(var y=0;y<x.length;y++){if(x[y].length>0&&u(x[y],r)){return true}if(x[y]==r){return true}}return false}function aG(r,i){var x;ae=Y(m);r=r||0;i=i||0;r=Math.max(V.cellindex+r,0);i=Math.max(V.rowindex+i,0);b.execCommand("mceRepaint");x=d(ae,i,r);if(x){b.selection.select(x.firstChild||x);b.selection.collapse(1)}}function H(){var i=D.createElement("td");if(!tinymce.isIE){i.innerHTML='<br mce_bogus="1"/>'}return i}function aJ(y){var x=1,r=1,i;if(i=y.getAttribute("colspan")){if(typeof(i.nodeValue)!="undefined"){x=i.nodeValue}else{x=i}}if(i=y.getAttribute("rowspan")){if(typeof(i.nodeValue)!="undefined"){r=i.nodeValue}else{r=i}}x=parseInt(x);r=parseInt(r);return{colspan:x,rowspan:r}}function k(r,aL){var i,aK;for(aK=0;aK<r.length;aK++){for(i=0;i<r[aK].length;i++){if(r[aK][i]==aL){return{cellindex:i,rowindex:aK}}}}return null}function d(r,x,i){if(r[x]&&r[x][i]){return r[x][i]}return null}function ac(x,y){if(x.nodeName.toLowerCase()=="br"){return y}if(x.childNodes.length==0){return x}for(var r=0;r<x.childNodes.length;r++){if(x.childNodes[r].nodeType==3){x.removeChild(x.childNodes[r]);r--}else{y=ac(x.childNodes[r],x)}}if(x.childNodes.length==0){return x}return y}function f(r,x){var i=ac(r,r);if(i.childNodes.length==0){i.appendChild(x)}else{i.insertBefore(x,i.childNodes[i.childNodes.length-1])}b.focus()}function Y(aQ){var i=[],aR=aQ.rows,aO,aN,aK,aL,aP,r,aM;for(aN=0;aN<aR.length;aN++){for(aO=0;aO<aR[aN].cells.length;aO++){aK=aR[aN].cells[aO];aL=aJ(aK);for(aP=aO;i[aN]&&i[aN][aP];aP++){}for(aM=aN;aM<aN+aL.rowspan;aM++){if(!i[aM]){i[aM]=[]}for(r=aP;r<aP+aL.colspan;r++){i[aM][r]=aK}}}}return i}function aI(aS,aP,aK,y){var r=Y(aS),aR=k(r,aK);var aT,aO;if(y.cells.length!=aP.childNodes.length){aT=aP.childNodes;aO=null;for(var aQ=0;aK=d(r,aR.rowindex,aQ);aQ++){var aM=true;var aN=aJ(aK);if(u(aT,aK)){y.childNodes[aQ]._delete=true}else{if((aO==null||aK!=aO)&&aN.colspan>1){for(var aL=aQ;aL<aQ+aK.colSpan;aL++){y.childNodes[aL]._delete=true}}}if((aO==null||aK!=aO)&&aN.rowspan>1){aK.rowSpan=aN.rowspan+1}if(aK.rowSpan==1){aK.removeAttribute("rowspan")}aO=aK}ay(m)}}function al(r,i){while((r=r.previousSibling)!=null){if(r.nodeName==i){return r}}return null}function C(y,aK){var r=aK.split(",");while((y=y.nextSibling)!=null){for(var x=0;x<r.length;x++){if(y.nodeName.toLowerCase()==r[x].toLowerCase()){return y}}}return null}function ay(aK){if(aK.rows==0){return}var y=aK.rows[0];for(var x=0;x<aK.rows.length;x++){var y=aK.rows[x];if(y._delete){y.parentNode.removeChild(y);x--;continue}var aL=y.cells[0];if(aL.cells>1){do{var r=C(aL,"TD,TH");if(aL._delete){aL.parentNode.removeChild(aL)}}while((aL=r)!=null)}}}function p(y,aM,aL){y.rowspan=1;y.setAttribute("rowSpan","1");y.removeAttribute("rowSpan");var r=C(aM,"TR");for(var aK=1;aK<aL&&r;aK++){var x=D.createElement("td");if(!tinymce.isIE){x.innerHTML='<br mce_bogus="1"/>'}if(tinymce.isIE){r.insertBefore(x,r.cells(y.cellIndex))}else{r.insertBefore(x,r.cells[y.cellIndex])}r=C(r,"TR")}}function X(aR,aT,aN){var r=Y(aT);var y=aN.cloneNode(false);var aS=k(r,aN.cells[0]);var aO=null;var aM=b.dom.getAttrib(aT,"border");var aL=null;for(var aQ=0;aL=d(r,aS.rowindex,aQ);aQ++){var aP=null;if(aO!=aL){for(var aK=0;aK<aN.cells.length;aK++){if(aL==aN.cells[aK]){aP=aL.cloneNode(true);break}}}if(aP==null){aP=aR.createElement("td");if(!tinymce.isIE){aP.innerHTML='<br mce_bogus="1"/>'}}aP.removeAttribute("colSpan");aP.removeAttribute("rowspan");y.appendChild(aP);aO=aL}return y}switch(ab){case"fixMissingCells":var ae=Y(T);var am=0;for(var O=0;O<ae.length;O++){if(ae[O].length>am){am=ae[O].length}}for(var O=0;O<ae.length;O++){if(ae[O].length<am){T.rows[O].appendChild(H())}}return false;case"mceTableRowUp":if(aA==null){return false}if(aA.previousSibling!=null){var P=b.selection.getNode();aA.parentNode.insertBefore(aA,aA.previousSibling);if(P.childNodes.length&&!tinymce.isIE){P=P.childNodes[0]}b.selection.select(P);b.selection.collapse(true);b.nodeChanged(false,true)}return true;case"mceTableRowDown":if(aA==null){return false}if(aA.nextSibling!=null){var P=b.selection.getNode();aA.parentNode.insertBefore(aA.nextSibling,aA);if(P.childNodes.length&&!tinymce.isIE){P=P.childNodes[0]}b.selection.select(P);b.selection.collapse(true);b.nodeChanged(false,true)}return true;case"mceTableColRight":if(!aA||!Z){return false}var ae=Y(m);var V=k(ae,Z);var q=null;var P=b.selection.getNode();for(var I=0;Z=d(ae,I,V.cellindex);I++){if(Z!=q){var an=$j(Z).next("td, th");if(an.length>0){Z.parentNode.insertBefore(an.get(0),Z)}q=Z}}if(P.childNodes.length&&!tinymce.isIE){P=P.childNodes[0]}b.selection.select(P);b.selection.collapse(true);b.nodeChanged(false,true);return true;case"mceTableColLeft":if(!aA||!Z){return false}var ae=Y(m);var V=k(ae,Z);var q=null;var P=b.selection.getNode();for(var I=0;Z=d(ae,I,V.cellindex);I++){if(Z!=q){var E=$j(Z).prev("td, th");if(E.length>0){Z.parentNode.insertBefore(Z,E.get(0))}q=Z}}if(P.childNodes.length&&!tinymce.isIE){P=P.childNodes[0]}b.selection.select(P);b.selection.collapse(true);b.nodeChanged(false,true);return true;case"mceTableRowProps":if(aA==null){return false}if(T){b.windowManager.open({url:CS_BASE_URL+"/resources/scripts/tiny_mce3/plugins/table/row.htm",width:400+parseInt(b.getLang("table.rowprops_delta_width",0)),height:245+parseInt(b.getLang("table.rowprops_delta_height",0)),inline:1},{plugin_url:v,cs_resource_base_url:CS_RESOURCE_BASE_URL})}return false;case"mceTableCellProps":if(Z==null){return false}if(T){b.windowManager.open({url:CS_BASE_URL+"/resources/scripts/tiny_mce3/plugins/table/cell.htm",width:400+parseInt(b.getLang("table.cellprops_delta_width",0)),height:275+parseInt(b.getLang("table.cellprops_delta_height",0)),inline:1},{plugin_url:v,cs_resource_base_url:CS_RESOURCE_BASE_URL})}return false;case"mceInsertTable":if(T){if(M&&M.action=="insert"){b.windowManager.open({url:CS_BASE_URL+"/resources/scripts/tiny_mce3/plugins/table/table.htm",width:420+parseInt(b.getLang("table.table_delta_width",0)),height:298+parseInt(b.getLang("table.table_delta_height",0)),inline:1},{plugin_url:v,action:M?M.action:0,cs_resource_base_url:CS_RESOURCE_BASE_URL})}else{b.windowManager.open({url:CS_BASE_URL+"/resources/scripts/tiny_mce3/plugins/table/table_edit.htm",width:420+parseInt(b.getLang("table.table_delta_width",0)),height:258+parseInt(b.getLang("table.table_delta_height",0)),inline:1},{plugin_url:v,action:M?M.action:0,cs_resource_base_url:CS_RESOURCE_BASE_URL})}}return false;case"mceTableDelete":var ad=b.dom.getParent(b.selection.getNode(),"table");if(ad){ad.parentNode.removeChild(ad);b.nodeChanged(false,true);b.execCommand("mceRepaint")}return true;case"mceTableSplitCells":case"mceTableMergeCells":case"mceTableInsertRowBefore":case"mceTableInsertRowAfter":case"mceTableDeleteRow":case"mceTableInsertColBefore":case"mceTableInsertColAfter":case"mceTableDeleteCol":case"mceTableCutRow":case"mceTableCopyRow":case"mceTablePasteRowBefore":case"mceTablePasteRowAfter":case"JustifyLeft":case"JustifyCenter":case"JustifyRight":case"JustifyFull":if(!m){switch(ab){case"JustifyLeft":case"JustifyCenter":case"JustifyRight":case"JustifyFull":return -1;default:return true}}if(aA&&m!=aA.parentNode){m=e.dom.getParent(aA,"table")}if(m&&(aA||tinymce.isIE||tinymce.isWebKit)){switch(ab){case"JustifyLeft":case"JustifyCenter":case"JustifyRight":case"JustifyFull":var ai=[];var P=b.selection.getSel();var ae=Y(m);if(tinymce.isIE||tinymce.isWebKit){var s=e.dom.getParent(b.selection.getStart(),"td,th");var S=e.dom.getParent(b.selection.getEnd(),"td,th");if(s&&S){b.plugins.jiveutil.walkDOMTree(s,S,function(r){if(r.nodeType==1&&(r.nodeName.toLowerCase()=="td"||r.nodeName.toLowerCase()=="th")){var i=r;if(ab=="JustifyLeft"){i.style.textAlign="left";i.setAttribute("_mce_style",i.getAttribute("style"))}else{if(ab=="JustifyRight"){i.style.textAlign="right";i.setAttribute("_mce_style",i.getAttribute("style"))}else{if(ab=="JustifyCenter"){i.style.textAlign="center";i.setAttribute("_mce_style",i.getAttribute("style"))}else{if(ab=="JustifyFull"){i.style.textAlign="justify";i.setAttribute("_mce_style",i.getAttribute("style"))}}}}}})}break}else{if(P.rangeCount==1){var V=k(ae,Z);var aE=m.rows;for(var I=V.rowindex;I<ae.length;I++){var N=[];for(var J=V.cellindex;J<ae[I].length;J++){var aq=d(ae,I,J);if(aq&&!u(ai,aq)&&!u(N,aq)){var F=k(ae,aq);if(F.cellindex<V.cellindex+1&&F.rowindex<V.rowindex+1){N[N.length]=aq}}}if(N.length>0){ai[ai.length]=N}}}else{var W=[];var P=b.selection.getSel();var aC=null;var l=null;var z=-1,h=-1,w,g;for(var R=0;R<P.rangeCount;R++){var c=P.getRangeAt(R);var Z=c.startContainer.childNodes[c.startOffset];if(!Z){break}if(Z.nodeName=="TD"||Z.nodeName=="TH"){W[W.length]=Z}}var aE=m.rows;for(var I=0;I<aE.length;I++){var N=[];for(var J=0;J<aE[I].cells.length;J++){var aq=aE[I].cells[J];for(var R=0;R<W.length;R++){if(aq==W[R]){N[N.length]=aq}}}if(N.length>0){ai[ai.length]=N}}}}for(var I=0;I<ai.length;I++){for(var J=0;J<ai[I].length;J++){var aq=ai[I][J];if(ab=="JustifyLeft"){aq.style.textAlign="left";aq.setAttribute("_mce_style",aq.getAttribute("style"))}else{if(ab=="JustifyRight"){aq.style.textAlign="right";aq.setAttribute("_mce_style",aq.getAttribute("style"))}else{if(ab=="JustifyCenter"){aq.style.textAlign="center";aq.setAttribute("_mce_style",aq.getAttribute("style"))}else{if(ab=="JustifyFull"){aq.style.textAlign="justify";aq.setAttribute("_mce_style",aq.getAttribute("style"))}}}}}}break;case"mceTableCutRow":if(!aA||!Z){return true}b.tableRowClipboard=X(D,m,aA);b.execCommand("mceTableDeleteRow");break;case"mceTableCopyRow":if(!aA||!Z){return true}b.tableRowClipboard=X(D,m,aA);break;case"mceTablePasteRowBefore":if(!aA||!Z){return true}var j=b.tableRowClipboard.cloneNode(true);var aB=al(aA,"TR");if(aB!=null){aI(m,aB,aB.cells[0],j)}aA.parentNode.insertBefore(j,aA);break;case"mceTablePasteRowAfter":if(!aA||!Z){return true}var af=C(aA,"TR");var j=b.tableRowClipboard.cloneNode(true);aI(m,aA,Z,j);if(af==null){aA.parentNode.appendChild(j)}else{af.parentNode.insertBefore(j,af)}break;case"mceTableInsertRowBefore":if(!aA||!Z){return true}var aa=e.selection.getBookmark();var ae=Y(m);var V=k(ae,Z);var j=D.createElement("tr");var q=null;V.rowindex--;if(V.rowindex<0){V.rowindex=0}for(var J=0;Z=d(ae,V.rowindex,J);J++){if(Z!=q){var ax=aJ(Z);if(ax.rowspan==1){var o=D.createElement("td");if(!tinymce.isIE){o.innerHTML='<br mce_bogus="1"/>'}o.colSpan=Z.colSpan;j.appendChild(o)}else{Z.rowSpan=ax.rowspan+1}if(Z.rowSpan==1){Z.removeAttribute("rowspan")}if(Z.colSpan==1){Z.removeAttribute("colSpan")}q=Z}}aA.parentNode.insertBefore(j,aA);e.selection.moveToBookmark(aa);break;case"mceTableInsertRowAfter":if(!aA||!Z){return true}var aa=e.selection.getBookmark();var ae=Y(m);var V=k(ae,Z);var j=D.createElement("tr");var q=null;for(var J=0;Z=d(ae,V.rowindex,J);J++){if(Z!=q){var ax=aJ(Z);if(ax.rowspan==1){var o=D.createElement("td");if(!tinymce.isIE){o.innerHTML='<br mce_bogus="1"/>'}o.colSpan=Z.colSpan;if(o.colSpan==1){o.removeAttribute("colSpan")}j.appendChild(o)}else{Z.rowSpan=ax.rowspan+1}if(Z.rowSpan==1){Z.removeAttribute("rowspan")}q=Z}}if(j.hasChildNodes()){var af=C(aA,"TR");if(af){af.parentNode.insertBefore(j,af)}else{var G;if(m.childNodes.length>0){G=m.childNodes[0]}else{G=m}if(G.nodeName.toLowerCase()=="tbody"){G.appendChild(j)}else{m.appendChild(j)}}}e.selection.moveToBookmark(aa);break;case"mceTableDeleteRow":if(!aA||!Z){return true}var ae=Y(m);var V=k(ae,Z);if(ae.length==1){b.dom.remove(b.dom.getParent(m,"table"));return true}var W=aA.cells;var af=C(aA,"TR");for(var J=0;J<W.length;J++){if(W[J].rowSpan>1){var o=W[J].cloneNode(true);var ax=aJ(W[J]);o.rowSpan=ax.rowspan-1;if(o.rowSpan==1){o.removeAttribute("rowspan")}var ap=af.cells[J];if(ap==null){af.appendChild(o)}else{af.insertBefore(o,ap)}}}var q=null;for(var J=0;Z=d(ae,V.rowindex,J);J++){if(Z!=q){var ax=aJ(Z);if(ax.rowspan>1){Z.rowSpan=ax.rowspan-1}else{aA=Z.parentNode;if(aA.parentNode){aA._delete=true}}if(aA.rowSpan==1){aA.removeAttribute("rowspan")}q=Z}}ay(m);aG(0,-1);break;case"mceTableInsertColBefore":if(!aA||!Z){return true}var aa=e.selection.getBookmark();var ae=Y(m);var V=k(ae,Z);var q=null;for(var I=0;Z=d(ae,I,V.cellindex);I++){if(Z!=q){var ax=aJ(Z);if(ax.colspan==1){var o=Z.cloneNode(true);if(o.nodeName.toLowerCase()=="th"){f(o,e.getDoc().createTextNode("Header "+(V.cellindex+I+1)))}else{if(!tinymce.isIE){o.innerHTML='<br mce_bogus="1"/>'}else{o.innerHTML=""}}o.rowSpan=Z.rowSpan;if(o.rowSpan==1){o.removeAttribute("rowspan")}Z.parentNode.insertBefore(o,Z)}else{Z.colSpan++}if(Z.colSpan==1){Z.removeAttribute("colSpan")}q=Z}}e.selection.moveToBookmark(aa);break;case"mceTableInsertColAfter":if(!aA||!Z){return true}var aa=e.selection.getBookmark();var ae=Y(m);var V=k(ae,Z);var q=null;for(var I=0;Z=d(ae,I,V.cellindex);I++){if(Z!=q){var ax=aJ(Z);if(ax.colspan==1){var o=Z.cloneNode(true);if(o.nodeName.toLowerCase()=="th"){f(o,e.getDoc().createTextNode("Header "+(V.cellindex+I+2)))}else{if(!tinymce.isIE){o.innerHTML='<br mce_bogus="1"/>'}else{o.innerHTML=""}}o.rowSpan=Z.rowSpan;if(o.rowSpan==1){o.removeAttribute("rowspan")}var ap=C(Z,"TD,TH");if(ap==null){Z.parentNode.appendChild(o)}else{ap.parentNode.insertBefore(o,ap)}}else{Z.colSpan++}if(Z.colSpan==1){Z.removeAttribute("colSpan")}q=Z}}e.selection.moveToBookmark(aa);break;case"mceTableDeleteCol":if(!aA||!Z){return true}var ae=Y(m);var V=k(ae,Z);var q=null;if(ae.length>1&&ae[0].length<=1){b.dom.remove(b.dom.getParent(m,"table"));return true}for(var I=0;Z=d(ae,I,V.cellindex);I++){if(Z!=q){var ax=aJ(Z);if(ax.colspan>1){Z.colSpan=ax.colspan-1}else{if(Z.parentNode){Z.parentNode.removeChild(Z)}}if(Z.colSpan==1){Z.removeAttribute("colSpan")}q=Z}}aG(-1);break;case"mceTableSplitCells":if(!aA||!Z){return true}var K=aJ(Z);var U=K.colspan;var at=K.rowspan;if(U>1||at>1){Z.colSpan=1;for(var R=1;R<U;R++){var o=D.createElement("td");if(!tinymce.isIE){o.innerHTML='<br mce_bogus="1"/>'}aA.insertBefore(o,C(Z,"TD,TH"));if(at>1){p(o,aA,at)}}if(Z.colSpan==1){Z.removeAttribute("colSpan")}p(Z,aA,at)}if(Z.childNodes.length==0){Z.innerHTML='<br mce_bogus="1"/>'}b.selection.select(Z.childNodes[0]);b.selection.collapse(true);m=b.dom.getParent(b.selection.getNode(),"table");break;case"mceTableMergeCells":var ai=[];var P=b.selection.getSel();var ae=Y(m);if(tinymce.isIE||P.rangeCount==1){if(T){var au=aJ(Z);var B=0;var aH=0;var aj=Z;while(aj&&aj.nextSibling){var aw=aJ(Z);B+=aw.colspan;aj=aj.nextSibling}var aj=aA;while(aj&&aj.nextSibling){aH+=1;aj=aj.nextSibling}b.windowManager.open({url:CS_BASE_URL+"/resources/scripts/tiny_mce3/plugins/table/merge_cells.htm",width:360+parseInt(b.getLang("table.merge_cells_delta_width",0)),height:140,inline:1},{action:"update",numcols:au.colspan,numrows:au.rowspan,maxcols:B,maxrows:aH,plugin_url:v,cs_resource_base_url:CS_RESOURCE_BASE_URL});return false}else{var av=parseInt(M.numrows);var n=parseInt(M.numcols);var V=k(ae,Z);if((""+av)=="NaN"){av=1}if((""+n)=="NaN"){n=1}var aE=m.rows;for(var I=V.rowindex;I<ae.length;I++){var N=[];for(var J=V.cellindex;J<ae[I].length;J++){var aq=d(ae,I,J);if(aq&&!u(ai,aq)&&!u(N,aq)){var F=k(ae,aq);if(F.cellindex<V.cellindex+n&&F.rowindex<V.rowindex+av){N[N.length]=aq}}}if(N.length>0){ai[ai.length]=N}var aq=d(ae,V.rowindex,V.cellindex);a(e.dom.select("br",aq),function(x,r){if(r>0&&e.dom.getAttrib("mce_bogus")){e.dom.remove(x)}})}}}else{var W=[];var P=b.selection.getSel();var aC=null;var l=null;var z=-1,h=-1,w,g;if(P.rangeCount<2){return true}for(var R=0;R<P.rangeCount;R++){var c=P.getRangeAt(R);var Z=c.startContainer.childNodes[c.startOffset];if(!Z){break}if(Z.nodeName=="TD"||Z.nodeName=="TH"){W[W.length]=Z}}var aE=m.rows;for(var I=0;I<aE.length;I++){var N=[];for(var J=0;J<aE[I].cells.length;J++){var aq=aE[I].cells[J];for(var R=0;R<W.length;R++){if(aq==W[R]){N[N.length]=aq}}}if(N.length>0){ai[ai.length]=N}}var l=[];var aC=null;for(var I=0;I<ae.length;I++){for(var J=0;J<ae[I].length;J++){ae[I][J]._selected=false;for(var R=0;R<W.length;R++){if(ae[I][J]==W[R]){if(z==-1){z=J;h=I}w=J;g=I;ae[I][J]._selected=true}}}}for(var I=h;I<=g;I++){for(var J=z;J<=w;J++){if(!ae[I][J]._selected){alert("Invalid selection for merge.");return true}}}}var aF=1,ak=1;var ag=-1;for(var I=0;I<ai.length;I++){var t=0;for(var J=0;J<ai[I].length;J++){var ax=aJ(ai[I][J]);t+=ax.colspan;if(ag!=-1&&ax.rowspan!=ag){alert("Invalid selection for merge.");return true}ag=ax.rowspan}if(t>ak){ak=t}ag=-1}var A=-1;for(var J=0;J<ai[0].length;J++){var L=0;for(var I=0;I<ai.length;I++){var ax=aJ(ai[I][J]);L+=ax.rowspan;if(A!=-1&&ax.colspan!=A){alert("Invalid selection for merge.");return true}A=ax.colspan}if(L>aF){aF=L}A=-1}Z=ai[0][0];Z.rowSpan=aF;Z.colSpan=ak;if(Z.rowSpan==1){Z.removeAttribute("rowspan")}if(Z.colSpan==1){Z.removeAttribute("colSpan")}for(var I=0;I<ai.length;I++){for(var J=0;J<ai[I].length;J++){var az=ai[I][J].innerHTML;var Q=az.replace(/[ \t\r\n]/g,"");if(Q!="<br/>"&&Q!="<br>"&&Q!='<br mce_bogus="1"/>'&&(J+I>0)){Z.innerHTML+=az}if(ai[I][J]!=Z&&!ai[I][J]._deleted){var V=k(ae,ai[I][J]);var ah=ai[I][J].parentNode;ah.removeChild(ai[I][J]);ai[I][J]._deleted=true;if(!ah.hasChildNodes()){ah.parentNode.removeChild(ah);var ao=null;for(var J=0;cellElm=d(ae,V.rowindex,J);J++){if(cellElm!=ao&&cellElm.rowSpan>1){cellElm.rowSpan--}ao=cellElm}if(Z.rowSpan>1){Z.rowSpan--}if(Z.rowSpan==1){Z.removeAttribute("rowspan")}}}}}a(e.dom.select("br",Z),function(x,r){if(r>0&&e.dom.getAttrib(x,"mce_bogus")){e.dom.remove(x)}});break}m=b.dom.getParent(b.selection.getNode(),"table");b.addVisual(m);b.nodeChanged(false,true)}return true}return false}});tinymce.PluginManager.add("table",tinymce.plugins.TablePlugin)})();
;
tinyMCE.addI18n("en.table_dlg",{general_tab:"General",advanced_tab:"Advanced",general_props:"General properties",advanced_props:"Advanced properties",rowtype:"Row in table part",title:"Insert/Modify table",width:"Width",height:"Height",cols:"Cols",rows:"Rows",cellspacing:"Cellspacing",cellpadding:"Cellpadding",border:"Border",align:"Alignment",align_default:"Default",align_left:"Left",align_right:"Right",align_middle:"Center",row_title:"Table row properties",cell_title:"Table cell properties",cell_type:"Cell type",valign:"Vertical alignment",align_top:"Top",align_bottom:"Bottom",bordercolor:"Border color",bgcolor:"Background color",merge_cells_title:"Merge table cells",id:"Id",style:"Style",langdir:"Language direction",langcode:"Language code",mime:"Target MIME type",ltr:"Left to right",rtl:"Right to left",bgimage:"Background image",summary:"Summary",td:"Data",th:"Header",cell_cell:"Update current cell",cell_row:"Update all cells in row",cell_all:"Update all cells in table",row_row:"Update current row",row_odd:"Update odd rows in table",row_even:"Update even rows in table",row_all:"Update all rows in table",thead:"Table Head",tbody:"Table Body",tfoot:"Table Foot",scope:"Scope",rowgroup:"Row Group",colgroup:"Col Group",col_limit:"You've exceeded the maximum number of columns of {$cols}.",row_limit:"You've exceeded the maximum number of rows of {$rows}.",cell_limit:"You've exceeded the maximum number of cells of {$cells}.",missing_scope:"Are you sure you want to continue without specifying a scope for this table header cell. Without it, it may be difficult for some users with disabilities to understand the content or data displayed of the table.",caption:"Table caption",frame:"Frame",frame_none:"none",frame_groups:"groups",frame_rows:"rows",frame_cols:"cols",frame_all:"all",rules:"Rules",rules_void:"void",rules_above:"above",rules_below:"below",rules_hsides:"hsides",rules_lhs:"lhs",rules_rhs:"rhs",rules_vsides:"vsides",rules_box:"box",rules_border:"border"});
;
tinyMCE.addI18n('en.table_dlg',{
    title_new:"Insert table",
    title_edit:"Modify table",
    merge_cells_description: "Choose the number of cells to the right and below the current cell that you would like to merge. Choose &apos;0&apos; if you do not want to merge any cells in the given direction."
});
;
(function(){tinymce.create("tinymce.plugins.HTML",{thunks:new Array(),registerToggleFunction:function(a){this.thunks.push(a)},toggleHTML:function(a){var c=a.plugins.html.thunks;for(var b=0;b<c.length;b++){c[b](a.id)}},prepForTab:false,prepForDel:false,prepForLargeDel:false,init:function(a,b){var c=this;function d(e){if(e.ctrlKey||e.metaKey){return false}if(e.keyCode>=65&&e.keyCode<=90||e.keyCode>=97&&e.keyCode<=122){return true}if(e.keyCode>=48&&e.keyCode<=57){return true}if(e.keyCode>=48&&e.keyCode<=57){return true}if(e.keyCode==13||e.keyCode==8||e.keyCode==46){return true}return false}c.editor=a;a.addCommand("mceToggleHTML",function(e,f){return function(){f.toggleHTML(e)}}(a,c));a.onBeforeSetContent.add(function(e,f){f.content=f.content.replace(/  /g,"&nbsp; ")});a.onGetContent.add(function(e,f){f.content=f.content.replace(/&nbsp;/g," ")});a.onKeyDown.add(function(f,e){this.prepForTab=false;this.prepForDel=false;this.prepForLargeDel=false;if(e.keyCode==9&&!e.ctrlKey&&!e.altKey&&!f.dom.getParent(f.selection.getNode(),"table")&&!f.dom.getParent(f.selection.getNode(),"ul,ol")){tinymce.dom.Event.cancel(e);this.prepForTab=true}if(tinymce.isGecko&&!f.selection.isCollapsed()){if(d(e)){this.prepForLargeDel=true;this.keyCode=e.keyCode;return false}}},this);a.onKeyPress.add(function(h,g){if(this.prepForDel){tinymce.dom.Event.cancel(g)}if(this.prepForLargeDel){var f=h.selection.getRng(true);var i=f.startContainer;var j=f.endContainer;f.deleteContents();function k(q){var m=q.parentNode;if(!m){return}var o=true;if(q.hasChildNodes()){for(var l=0;l<q.childNodes.length;++l){var p=q.childNodes[l];if(p.nodeType==1||(p.nodeType==3&&p.nodeValue.length>0)){o=false;break}}}else{if(q.nodeType==3&&q.nodeValue.length>0){o=false}else{if(q.nodeName.toLowerCase()=="body"||q.nodeName.toLowerCase()=="td"){o=false}}}if(o){m.removeChild(q);k(m)}}k(i);k(j);if(h.plugins.jiveselection.isEffectivelyEmpty(h.getBody())){h.setContent("<p><br /></p>");f=h.dom.createRng();f.setStart(h.getBody().firstChild,0);f.collapse(true);h.selection.setRng(f)}var e=h.dom.getParent(h.selection.getNode(),"li");if(e){if(!e.lastChild||e.lastChild.nodeName.toLowerCase()!="br"){e.appendChild(h.dom.create("br"))}}if(this.keyCode==8||this.keyCode==46){tinymce.dom.Event.cancel(g)}}else{if(g.keyCode==9&&!g.ctrlKey&&!g.altKey&&!h.dom.getParent(h.selection.getNode(),"table")&&!h.dom.getParent(h.selection.getNode(),"ul,ol")){tinymce.dom.Event.cancel(g)}}},this);a.onKeyUp.add(function(f,e){if(this.prepForDel){tinymce.dom.Event.cancel(e);var h=f.selection.getStart();var g=h.previousSibling;if(g){h.parentNode.removeChild(h);while(g.nodeName.toLowerCase()=="ol"||g.nodeName.toLowerCase()=="ul"){g=g.childNodes[g.childNodes.length-1]}if(g.childNodes.length>0){f.selection.select(g.childNodes[g.childNodes.length-1]);f.selection.collapse()}else{f.selection.select(g);f.selection.collapse()}}}else{if(this.prepForLargeDel){if(this.keyCode==8||this.keyCode==46){tinymce.dom.Event.cancel(e)}}}if(e.keyCode==9&&!e.ctrlKey&&!e.altKey&&this.prepForTab&&!f.dom.getParent(f.selection.getNode(),"table")&&!f.dom.getParent(f.selection.getNode(),"ul,ol")){tinymce.dom.Event.cancel(e);f.selection.setContent("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;")}},this);a.addButton("html",{title:"html.desc",cmd:"mceToggleHTML"})},getInfo:function(){return{longname:"HTML mode",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/fullpage",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("html",tinymce.plugins.HTML)})();
;
tinyMCE.addI18n('en.html',{
    desc:"Toggle HTML mode"
});
;
(function(){tinymce.create("tinymce.plugins.Save",{init:function(a,b){var c=this;c.editor=a;a.addCommand("mceSave",c._save,c);a.addCommand("mceCancel",c._cancel,c);a.addButton("save",{title:"save.save_desc",cmd:"mceSave"});a.addButton("cancel",{title:"save.cancel_desc",cmd:"mceCancel"});a.onNodeChange.add(c._nodeChange,c);a.addShortcut("ctrl+s",a.getLang("save.save_desc"),"mceSave")},getInfo:function(){return{longname:"Save",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/save",version:tinymce.majorVersion+"."+tinymce.minorVersion}},_nodeChange:function(b,a,c){var b=this.editor;if(b.getParam("save_enablewhendirty")){a.setDisabled("save",!b.isDirty());a.setDisabled("cancel",!b.isDirty())}},_save:function(){var c=this.editor,a,e,d,b;a=tinymce.DOM.get(c.id).form||tinymce.DOM.getParent(c.id,"form");if(c.getParam("save_enablewhendirty")&&!c.isDirty()){return}tinyMCE.triggerSave();if(e=c.getParam("save_onsavecallback")){if(c.execCallback("save_onsavecallback",c)){c.startContent=tinymce.trim(c.getContent({format:"raw"}));c.nodeChanged()}return}if(a){c.isNotDirty=true;$j(a).submit();c.nodeChanged()}else{c.windowManager.alert("Error: No form element found.")}},_cancel:function(){var a=this.editor,c,b=tinymce.trim(a.startContent);if(c=a.getParam("save_oncancelcallback")){a.execCallback("save_oncancelcallback",a);return}a.setContent(b);a.undoManager.clear();a.nodeChanged()}});tinymce.PluginManager.add("save",tinymce.plugins.Save)})();
;
(function(){tinymce.create("tinymce.plugins.AdvancedImagePlugin",{init:function(a,b){a.addCommand("mceAdvImage",function(){if(a.dom.getAttrib(a.selection.getNode(),"class").indexOf("mceItem")!=-1){return}a.windowManager.open({file:CS_BASE_URL+"/resources/scripts/tiny_mce3/plugins/advimage/image.htm",width:560+parseInt(a.getLang("advimage.delta_width",0)),height:455+parseInt(a.getLang("advimage.delta_height",0)),inline:1},{plugin_url:b,cs_resource_base_url:CS_RESOURCE_BASE_URL})});a.addButton("image",{title:"advimage.image_desc",cmd:"mceAdvImage"})},getInfo:function(){return{longname:"Advanced image",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/advimage",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("advimage",tinymce.plugins.AdvancedImagePlugin)})();
;
tinyMCE.addI18n("en.advimage_dlg",{tab_general:"General",tab_appearance:"Appearance",tab_advanced:"Advanced",general:"General",title:"Title",preview:"Preview",constrain_proportions:"Constrain proportions",langdir:"Language direction",langcode:"Language code",long_desc:"Long description link",style:"Style",classes:"Classes",ltr:"Left to right",rtl:"Right to left",id:"Id",map:"Image map",swap_image:"Swap image",alt_image:"Alternative image",mouseover:"for mouse over",mouseout:"for mouse out",misc:"Miscellaneous",example_img:"Appearance preview image",missing_alt:"Are you sure you want to continue without including an Image Description? Without it the image may not be accessible to some users with disabilities, or to those using a text browser, or browsing the Web with images turned off.",dialog_title:"Insert/edit image",src:"Image URL",alt:"Image description",list:"Image list",border:"Border",dimensions:"Dimensions",vspace:"Vertical space",hspace:"Horizontal space",align:"Alignment",align_baseline:"Baseline",align_top:"Top",align_middle:"Middle",align_bottom:"Bottom",align_texttop:"Text top",align_textbottom:"Text bottom",align_left:"Left",align_right:"Right",image_list:"Image list"});
;
tinyMCE.addI18n('en.advimage_dlg',{
    dialog_title:"Insert Image",
    src:"URL",
    align_inline:"Normal",
    align_nowrap:"No Wrap",
    insert_desc : "Use the form below to insert a remote image from a web page into your discussion, document, blog post or comment.",
    from_the_web: "From the Web",
    example : "example"
});
;
(function(){tinymce.create("tinymce.plugins.AdvancedLinkPlugin",{init:function(a,b){this.editor=a;a.addCommand("mceAdvLink",function(){var c=a.selection;if(c.isCollapsed()&&!a.dom.getParent(c.getNode(),"A")){return}a.windowManager.open({file:CS_BASE_URL+"/resources/scripts/tiny_mce3/plugins/advlink/link.htm",width:480+parseInt(a.getLang("advlink.delta_width",0)),height:400+parseInt(a.getLang("advlink.delta_height",0)),inline:1},{plugin_url:b,cs_resource_base_url:CS_RESOURCE_BASE_URL})});a.addButton("link",{title:"advlink.link_desc",cmd:"mceAdvLink"});a.addShortcut("ctrl+k","advlink.advlink_desc","mceAdvLink");a.onNodeChange.add(function(d,c,f,e){c.setDisabled("link",e&&f.nodeName!="A");c.setActive("link",f.nodeName=="A"&&!f.name)})},getInfo:function(){return{longname:"Advanced link",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/advlink",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("advlink",tinymce.plugins.AdvancedLinkPlugin)})();
;
tinyMCE.addI18n("en.advlink_dlg",{title:"Insert/edit link",url:"Link URL",target:"Target",titlefield:"Title",is_email:"The URL you entered seems to be an email address, do you want to add the required mailto: prefix?",is_external:"The URL you entered seems to external link, do you want to add the required http:// prefix?",list:"Link list",general_tab:"General",popup_tab:"Popup",events_tab:"Events",advanced_tab:"Advanced",general_props:"General properties",popup_props:"Popup properties",event_props:"Events",advanced_props:"Advanced properties",popup_opts:"Options",anchor_names:"Anchors",target_same:"Open in this window / frame",target_parent:"Open in parent window / frame",target_top:"Open in top frame (replaces all frames)",target_blank:"Open in new window",popup:"Javascript popup",popup_url:"Popup URL",popup_name:"Window name",popup_return:"Insert 'return false'",popup_scrollbars:"Show scrollbars",popup_statusbar:"Show status bar",popup_toolbar:"Show toolbars",popup_menubar:"Show menu bar",popup_location:"Show location bar",popup_resizable:"Make window resizable",popup_dependent:"Dependent (Mozilla/Firefox only)",popup_size:"Size",popup_position:"Position (X/Y)",id:"Id",style:"Style",classes:"Classes",target_name:"Target name",langdir:"Language direction",target_langcode:"Target language",langcode:"Language code",encoding:"Target character encoding",mime:"Target MIME type",rel:"Relationship page to target",rev:"Relationship target to page",tabindex:"Tabindex",accesskey:"Accesskey",ltr:"Left to right",rtl:"Right to left",link_list:"Link list"});
;
(function(){var e=tinymce.DOM,b=tinymce.dom.Element,a=tinymce.dom.Event,f=tinymce.each,c=tinymce.is;tinymce.create("tinymce.plugins.InlinePopups",{init:function(g,h){g.onBeforeRenderUI.add(function(){g.windowManager=new tinymce.InlineWindowManager(g);e.loadCSS(CS_RESOURCE_BASE_URL+"/styles/tiny_mce3/plugins/inlinepopups/skins/"+(g.settings.inlinepopups_skin||"clearlooks2")+"/window.css")})},getInfo:function(){return{longname:"InlinePopups",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/inlinepopups",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.create("tinymce.InlineWindowManager:tinymce.WindowManager",{InlineWindowManager:function(g){var h=this;h.parent(g);h.zIndex=300000;h.count=0},doc:null,open:function(C,s){var r=this,v,g="",i=r.editor,q=0,B=0,z,x,h,j,l,m,o;var k=0,A=0;var m=window;try{while(m.parent&&m!=m.parent&&typeof(m.parent.jive)!="undefined"){if(m.frameElement){k+=jive.ext.x.xPageX(m.frameElement);A+=jive.ext.x.xPageY(m.frameElement)}m=m.parent;m.editor=window.editor;m.jiveRTE=window.jiveRTE;m.tinymce=window.tinymce;m.tinyMCE=window.tinyMCE}}catch(D){}i.plugins.inlinepopups.doc=m.document;var F=i.plugins.inlinepopups.doc;var y=new tinymce.dom.DOMUtils(F);if(!$def(i.plugins.inlinepopups.overlay)){var E=F.createElement("DIV");E.className="overlay";E.setAttribute("class","overlay");F.body.appendChild(E);i.plugins.inlinepopups.overlay=E;jive.ext.x.xAddEventListener(E,"click",function(){var t=window.editor.toArray(function(u){return $def(u.closeAllDialogs)});for(var p=0;p<t.length;p++){t[p].closeAllDialogs()}})}C=C||{};s=s||{};if(!C.inline){return r.parent(C,s)}if(!C.type){r.bookmark=i.selection.getBookmark("simple")}v=y.uniqueId()+Math.round(Math.random()*10000000);z=y.getViewPort();C.width=parseInt(C.width||320);C.height=parseInt(C.height||240);C.min_width=parseInt(C.min_width||150);C.min_height=parseInt(C.min_height||100);C.max_width=parseInt(C.max_width||2000);C.max_height=parseInt(C.max_height||2000);C.left=C.left||Math.round(Math.max(z.x,z.x+(z.w/2)-(C.width/2)));C.top=C.top||Math.round(Math.max(z.y,z.y+(z.h/2)-(C.height/2)));C.left+=k;C.top+=A;C.movable=C.resizable=true;s.mce_width=C.width;s.mce_height=C.height;s.mce_inline=true;s.mce_window_id=v;s.mce_auto_focus=C.auto_focus;r.features=C;r.params=s;r.onOpen.dispatch(r,C,s);if(C.type){g+=" mceModal";if(C.type){g+=" mce"+C.type.substring(0,1).toUpperCase()+C.type.substring(1)}C.resizable=false}if(C.statusbar){g+=" mceStatusbar"}if(C.resizable){g+=" mceResizable"}if(C.minimizable){g+=" mceMinimizable"}if(C.maximizable){g+=" mceMaximizable"}if(C.movable){g+=" mceMovable"}r._addAll(F.body,["div",{id:v,"class":i.settings.inlinepopups_skin||"clearlooks2",style:"width:100px;height:100px"},["div",{id:v+"_wrapper","class":"mceWrapper"+g},["div",{id:v+"_top","class":"mceTop"},["div",{"class":"mceLeft"}],["div",{"class":"mceCenter"}],["div",{"class":"mceRight"}],["span",{id:v+"_title"},C.title||""]],["div",{id:v+"_middle","class":"mceMiddle"},["div",{id:v+"_left","class":"mceLeft"}],["span",{id:v+"_content"}],["div",{id:v+"_right","class":"mceRight"}]],["div",{id:v+"_bottom","class":"mceBottom"},["div",{"class":"mceLeft"}],["div",{"class":"mceCenter"}],["div",{"class":"mceRight"}],["span",{id:v+"_status"},"Content"]],["a",{"class":"mceMove",tabindex:"-1",href:"javascript:;"}],["a",{"class":"mceMin",tabindex:"-1",href:"javascript:;",onmousedown:"return false;"}],["a",{"class":"mceMax",tabindex:"-1",href:"javascript:;",onmousedown:"return false;"}],["a",{"class":"mceMed",tabindex:"-1",href:"javascript:;",onmousedown:"return false;"}],["a",{"class":"mceClose",tabindex:"-1",href:"javascript:;",onmousedown:"return false;"}],["a",{id:v+"_resize_n","class":"mceResize mceResizeN",tabindex:"-1",href:"javascript:;"}],["a",{id:v+"_resize_s","class":"mceResize mceResizeS",tabindex:"-1",href:"javascript:;"}],["a",{id:v+"_resize_w","class":"mceResize mceResizeW",tabindex:"-1",href:"javascript:;"}],["a",{id:v+"_resize_e","class":"mceResize mceResizeE",tabindex:"-1",href:"javascript:;"}],["a",{id:v+"_resize_nw","class":"mceResize mceResizeNW",tabindex:"-1",href:"javascript:;"}],["a",{id:v+"_resize_ne","class":"mceResize mceResizeNE",tabindex:"-1",href:"javascript:;"}],["a",{id:v+"_resize_sw","class":"mceResize mceResizeSW",tabindex:"-1",href:"javascript:;"}],["a",{id:v+"_resize_se","class":"mceResize mceResizeSE",tabindex:"-1",href:"javascript:;"}]]]);y.setStyles(v,{top:-10000,left:-10000});if(tinymce.isGecko){y.setStyle(v,"overflow","auto")}if(!C.type){q+=y.get(v+"_left").clientWidth;q+=y.get(v+"_right").clientWidth;B+=y.get(v+"_top").clientHeight;B+=y.get(v+"_bottom").clientHeight}y.setStyles(v,{top:C.top,left:C.left,width:C.width+q,height:C.height+B});o=C.url||C.file;if(o){if(tinymce.relaxedDomain){o+=(o.indexOf("?")==-1?"?":"&")+"mce_rdomain="+tinymce.relaxedDomain}o=tinymce._addVer(o)}if(!C.type){y.add(v+"_content","iframe",{id:v+"_ifr",src:'javascript:""',frameBorder:0,style:"border:0;width:10px;height:10px"});y.setStyles(v+"_ifr",{width:C.width,height:C.height});y.setAttrib(v+"_ifr","src",o)}else{var n=$j("#"+v+"_wrapper").get(0);r._addAll(n,["input",{id:v+"_ok","class":"mceOk",value:"Ok",type:"button"}]);if(C.type=="confirm"){y.add(v+"_wrapper","input",{"class":"mceCancel",value:"Cancel",type:"button"})}y.add(v+"_middle","div",{"class":"mceIcon"});y.setHTML(v+"_content",C.content.replace("\n","<br />"))}h=a.add(v,"mousedown",function(u){var G=u.target,p,t;p=r.windows[v];r.focus(v);if(G.nodeName.toLowerCase()=="a"||G.nodeName.toLowerCase()=="input"){if(G.className=="mceClose"){r.close(null,v);return a.cancel(u)}else{if(G.className=="mceOk"||G.className=="mceCancel"){C.button_func(G.className=="mceOk");return a.cancel(u)}else{if(G.className=="mceMax"){p.oldPos=p.element.getXY();p.oldSize=p.element.getSize();t=y.getViewPort();t.w-=2;t.h-=2;p.element.moveTo(t.x,t.y);p.element.resizeTo(t.w,t.h);y.setStyles(v+"_ifr",{width:t.w-p.deltaWidth,height:t.h-p.deltaHeight});y.addClass(v+"_wrapper","mceMaximized")}else{if(G.className=="mceMed"){p.element.moveTo(p.oldPos.x,p.oldPos.y);p.element.resizeTo(p.oldSize.w,p.oldSize.h);p.iframeElement.resizeTo(p.oldSize.w-p.deltaWidth,p.oldSize.h-p.deltaHeight);y.removeClass(v+"_wrapper","mceMaximized")}else{if(G.className=="mceMove"){return r._startDrag(v,u,G.className)}else{if(y.hasClass(G,"mceResize")){return r._startDrag(v,u,G.className.substring(13))}}}}}}}});j=function(u){var w=u.target||u.srcElement;if($def(w)&&w){r.focus(v);if(w.nodeName=="INPUT"||w.nodeName=="input"||w.nodeName=="A"||w.nodeName=="a"){switch(w.className){case"mceClose":var t=window.editor.toArray(function(G){return $def(G.closeAllDialogs)});for(var p=0;p<t.length;p++){t[p].closeAllDialogs()}return a.cancel(u);case"mceOk":case"mceCancel":C.button_func(w.className=="mceOk");return a.cancel(u)}}}};$j(F.body).find("#"+v).click(j);r.windows=r.windows||{};m=r.windows[v]={id:v,mousedown_func:h,click_func:j,element:new b(v,{blocker:1,container:i.getContainer()}),iframeElement:new b(v+"_ifr"),features:C,deltaWidth:q,deltaHeight:B};m.iframeElement.on("focus",function(){r.focus(v)});if(r.count==0&&r.editor.getParam("dialog_type")=="modal"){y.add(y.doc.body,"div",{id:"mceModalBlocker","class":(r.editor.settings.inlinepopups_skin||"clearlooks2")+"_modalBlocker",style:{left:z.x,top:z.y,zIndex:r.zIndex-1}});y.show("mceModalBlocker")}else{y.setStyle("mceModalBlocker","z-index",r.zIndex-1)}r.focus(v);r._fixIELayout(v,1);if(y.get(v+"_ok")){y.get(v+"_ok").focus()}r.count++;i.plugins.inlinepopups.overlay.style.height=jive.ext.x.xDocHeight(F)+"px";i.plugins.inlinepopups.overlay.style.display="block";return m},focus:function(l){var h=tinyMCE.activeEditor;if(h.plugins.inlinepopups.doc==null){var g=window;while(g.parent&&g!=g.parent){g=g.parent;if(!$def(g.tinymce)){g.tinymce=window.tinymce;g.tinyMCE=window.tinyMCE}}h.plugins.inlinepopups.doc=g.document}var i=this,g=i.windows[l],j=tinyMCE.activeEditor.plugins.inlinepopups.doc,k=new tinymce.dom.DOMUtils(j);if($def(g)&&g){g.zIndex=this.zIndex++;g.element.setStyle("zIndex",g.zIndex);g.element.update()}l=l+"_wrapper";k.removeClass(i.lastId,"mceFocus");k.addClass(l,"mceFocus");i.lastId=l},_addAll:function(m,k){var h,o,g=this,j=tinyMCE.activeEditor.plugins.inlinepopups.doc,l=new tinymce.dom.DOMUtils(j);if(c(k,"string")){m.appendChild(l.doc.createTextNode(k))}else{if(k.length){m=m.appendChild(l.create(k[0],k[1]));for(h=2;h<k.length;h++){g._addAll(m,k[h])}}}},_startDrag:function(x,I,F){var q=this,v,B,H=tinyMCE.activeEditor.plugins.inlinepopups.doc,A=new tinymce.dom.DOMUtils(H);var g,m=q.windows[x],i=m.element,z=i.getXY(),y,r,G,h,C,u,s,k,j,n,l,o,D;h={x:0,y:0};C=A.getViewPort();C.w-=2;C.h-=2;k=I.screenX;j=I.screenY;n=l=o=D=0;v=a.add(H,"mouseup",function(p){a.remove(H,"mouseup",v);a.remove(H,"mousemove",B);if(g){g.remove()}i.moveBy(n,l);i.resizeBy(o,D);r=i.getSize();A.setStyles(x+"_ifr",{width:r.w-m.deltaWidth,height:r.h-m.deltaHeight});q._fixIELayout(x,1);return a.cancel(p)});if(F!="Move"){E()}function E(){var p=tinyMCE.activeEditor.plugins.inlinepopups.doc,t=new tinymce.dom.DOMUtils(p);if(g){return}q._fixIELayout(x,0);t.add(d.body,"div",{id:"mceEventBlocker","class":"mceEventBlocker "+(q.editor.settings.inlinepopups_skin||"clearlooks2"),style:{left:C.x,top:C.y,zIndex:q.zIndex+1}});g=new b("mceEventBlocker");g.update();y=i.getXY();r=i.getSize();u=h.x+y.x-C.x;s=h.y+y.y-C.y;t.add(g.get(),"div",{id:"mcePlaceHolder","class":"mcePlaceHolder",style:{left:u,top:s,width:r.w,height:r.h}});G=new b("mcePlaceHolder")}B=a.add(d,"mousemove",function(w){var p,J,t;E();p=w.screenX-k;J=w.screenY-j;switch(F){case"ResizeW":n=p;o=0-p;break;case"ResizeE":o=p;break;case"ResizeN":case"ResizeNW":case"ResizeNE":if(F=="ResizeNW"){n=p;o=0-p}else{if(F=="ResizeNE"){o=p}}l=J;D=0-J;break;case"ResizeS":case"ResizeSW":case"ResizeSE":if(F=="ResizeSW"){n=p;o=0-p}else{if(F=="ResizeSE"){o=p}}D=J;break;case"mceMove":n=p;l=J;break}if(o<(t=m.features.min_width-r.w)){if(n!==0){n+=o-t}o=t}if(D<(t=m.features.min_height-r.h)){if(l!==0){l+=D-t}D=t}o=Math.min(o,m.features.max_width-r.w);D=Math.min(D,m.features.max_height-r.h);n=Math.max(n,C.x-(u+C.x));l=Math.max(l,C.y-(s+C.y));n=Math.min(n,(C.w+C.x)-(u+r.w+C.x));l=Math.min(l,(C.h+C.y)-(s+r.h+C.y));if(n+l!==0){if(u+n<0){n=0}if(s+l<0){l=0}G.moveTo(u+n,s+l)}if(o+D!==0){G.resizeTo(r.w+o,r.h+D)}return a.cancel(w)});return a.cancel(I)},resizeBy:function(h,i,j){var g=this.windows[j];if(g){g.element.resizeBy(h,i);g.iframeElement.resizeBy(h,i)}},close:function(g,h){setTimeout(function(j,k,i){return function(){var q=tinyMCE.activeEditor.plugins.inlinepopups.doc,r=new tinymce.dom.DOMUtils(q);var m,l=0,o;i.count--;if(i.count==0){r.remove("mceModalBlocker")}if(!k&&j){i.parent(j);return}if(m=i.windows[k]){tinyMCE.activeEditor.plugins.inlinepopups.overlay.style.display="none";i.onClose.dispatch(i);a.remove(q,"mousedown",m.mousedownFunc);a.remove(q,"click",m.clickFunc);a.clear(k);a.clear(k+"_ifr");r.setAttrib(k+"_ifr","src",'javascript:""');var n=q.getElementById(m.id);try{m.element.remove();n.parentNode.removeChild(n)}catch(p){}delete i.windows[k]}else{}tinyMCE.activeEditor.focus();tinyMCE.activeEditor.undoManager.add()}}(g,h,this),33)},setTitle:function(g,k){var i=tinyMCE.activeEditor.plugins.inlinepopups.doc,j=new tinymce.dom.DOMUtils(i);var h;if(h=j.get(k+"_title")){h.innerHTML=j.encode(g)}},alert:function(h,g,l){var j=tinyMCE.activeEditor;if(j.plugins.inlinepopups.doc==null){var i=window;while(i.parent&&i!=i.parent){i=i.parent;if(!$def(i.tinymce)){i.tinymce=window.tinymce;i.tinyMCE=window.tinyMCE}}j.plugins.inlinepopups.doc=i.document}var m=tinyMCE.activeEditor.plugins.inlinepopups.doc,n=new tinymce.dom.DOMUtils(m);var k=this,i;i=k.open({title:k,type:"alert",button_func:function(o){if(g){g.call(o||k,o)}k.close(null,i.id)},content:n.encode(k.editor.getLang(h,h)),inline:1,width:400,height:130})},confirm:function(h,g,l){var j=tinyMCE.activeEditor;if(j.plugins.inlinepopups.doc==null){var i=window;while(i.parent&&i!=i.parent){i=i.parent;if(!$def(i.tinymce)){i.tinymce=window.tinymce;i.tinyMCE=window.tinyMCE}}j.plugins.inlinepopups.doc=i.document}var m=tinyMCE.activeEditor.plugins.inlinepopups.doc,n=new tinymce.dom.DOMUtils(m);var k=this,i;i=k.open({title:k,type:"confirm",button_func:function(o){if(g){g.call(o||k,o)}k.close(null,i.id)},content:n.encode(k.editor.getLang(h,h)),inline:1,width:400,height:130})},_fixIELayout:function(l,i){var j=tinyMCE.activeEditor.plugins.inlinepopups.doc,k=new tinymce.dom.DOMUtils(j);var g,h;if(!tinymce.isIE6){return}f(["n","s","w","e","nw","ne","sw","se"],function(m){var n=k.get(l+"_resize_"+m);k.setStyles(n,{width:i?n.clientWidth:"",height:i?n.clientHeight:"",cursor:k.getStyle(n,"cursor",1)});k.setStyle(l+"_bottom","bottom","-1px");n=0});if(g=this.windows[l]){g.element.hide();g.element.show();f(k.select("div,a",l),function(n,m){if(n.currentStyle.backgroundImage!="none"){h=new Image();h.src=n.currentStyle.backgroundImage.replace(/url\(\"(.+)\"\)/,"$1")}});k.get(l).style.filter=""}}});tinymce.PluginManager.add("inlinepopups",tinymce.plugins.InlinePopups)})();
;
(function(){var a=tinymce.dom.Event,c=tinymce.each,b=tinymce.DOM;tinymce.create("tinymce.plugins.ContextMenu",{init:function(d){var f=this,g;f.editor=d;f.onContextMenu=new tinymce.util.Dispatcher(this);d.onContextMenu.add(function(h,i){if(!i.ctrlKey){if(g){h.selection.setRng(g)}f._getMenu(h).showMenu(i.clientX,i.clientY);a.add(h.getDoc(),"click",function(j){e(h,j)});a.cancel(i)}});d.onRemove.add(function(){if(f._menu){f._menu.removeAll()}});function e(h,i){g=null;if(i&&i.button==2){g=h.selection.getRng();return}if(f._menu){f._menu.removeAll();f._menu.destroy();a.remove(h.getDoc(),"click",e)}}d.onMouseDown.add(e);d.onKeyDown.add(e)},getInfo:function(){return{longname:"Contextmenu",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/contextmenu",version:tinymce.majorVersion+"."+tinymce.minorVersion}},_getMenu:function(h){var l=this,f=l._menu,i=h.selection,e=i.isCollapsed(),d=i.getNode()||h.getBody(),g,k,j;if(f){f.removeAll();f.destroy()}k=b.getPos(h.getContentAreaContainer());j=b.getPos(h.getContainer());f=h.controlManager.createDropMenu("contextmenu",{offset_x:k.x+h.getParam("contextmenu_offset_x",0),offset_y:k.y+h.getParam("contextmenu_offset_y",0),constrain:1});l._menu=f;if(d.nodeName!="A"){f.add({title:"jivelink.link_desc",icon:"link",cmd:"mceJiveLink",ui:true});f.addSeparator()}if(d.nodeName=="A"&&!h.dom.getAttrib(d,"name")){f.add({title:"advanced.unlink_desc",icon:"unlink",cmd:"UnLink"});f.addSeparator()}if(h.dom.getParent(d,"img")){g=f.addMenu({title:"contextmenu.align",icon:"align"});g.add({title:"advimage_dlg.align_inline",cmd:"mceNoFloatImage"});g.add({title:"advimage_dlg.align_left",icon:"justifyleft",cmd:"JustifyLeft"});g.add({title:"advimage_dlg.align_right",icon:"justifyright",cmd:"JustifyRight"})}else{if(h.settings.images_enabled){f.add({title:"advanced.insert_image_desc",icon:"image",cmd:h.plugins.jiveimage?"mceJiveImage":"mceImage",ui:true});f.addSeparator()}g=f.addMenu({title:"contextmenu.align",icon:"align"});g.add({title:"contextmenu.left",icon:"justifyleft",cmd:"JustifyLeft"});g.add({title:"contextmenu.center",icon:"justifycenter",cmd:"JustifyCenter"});g.add({title:"contextmenu.right",icon:"justifyright",cmd:"JustifyRight"});g.add({title:"contextmenu.full",icon:"justifyfull",cmd:"JustifyFull"})}l.onContextMenu.dispatch(l,f,d,e);return f}});tinymce.PluginManager.add("contextmenu",tinymce.plugins.ContextMenu)})();
;
(function(){var d=tinymce.each,e=null,a={paste_auto_cleanup_on_paste:true,paste_block_drop:false,paste_retain_style_properties:"none",paste_strip_class_attributes:"mso",paste_remove_spans:false,paste_remove_styles:false,paste_remove_styles_if_webkit:false,paste_convert_middot_lists:true,paste_convert_headers_to_strong:false,paste_dialog_width:"450",paste_dialog_height:"400",paste_text_use_dialog:false,paste_text_sticky:false,paste_text_notifyalways:false,paste_text_linebreaktype:"p",paste_text_replacements:[[/\u2026/g,"..."],[/[\x93\x94\u201c\u201d]/g,'"'],[/[\x60\x91\x92\u2018\u2019]/g,"'"]]};function b(f,g){return f.getParam(g,a[g])}function c(h){var j=0;var g=16;var f=[];function i(p,r,n){var m="00000000"+r.toString(16);m=m.substring(m.length-8);var k=[];n=Math.min(n,p.length-r);for(var l=0;l<n;++l){var q="00"+p.charCodeAt(r+l).toString(16);k.push(q.substring(q.length-2));if(l>0&&l%8==0){k.push("")}}var o=p.substr(r,n).replace(/[\x00-\x1f]/g,".");return m+"  "+k.join(" ")+"  |"+o+"|"}while(j<h.length){f.push(i(h,j,g));j+=g}return f.join("\n")}tinymce.create("tinymce.plugins.PastePlugin",{init:function(f,g){var h=this;h.editor=f;h.url=g;h.onPreProcess=new tinymce.util.Dispatcher(h);h.onPostProcess=new tinymce.util.Dispatcher(h);h.onPreProcess.add(h._preProcess);h.onPostProcess.add(h._postProcess);h.onPreProcess.add(function(k,l){f.execCallback("paste_preprocess",k,l)});h.onPostProcess.add(function(k,l){f.execCallback("paste_postprocess",k,l)});f.pasteAsPlainText=false;function j(m,k){var l=f.dom;f.undoManager.add();h.onPreProcess.dispatch(h,m);m.node=l.create("div",0,m.content);h.onPostProcess.dispatch(h,m);m.content=f.serializer.serialize(m.node,{getInner:1});m.content=m.content.replace(/\n/gi,"").replace(/\r/gi,"");if((!k)&&(f.pasteAsPlainText)){h._insertPlainText(f,l,m.content);if(!b(f,"paste_text_sticky")){f.pasteAsPlainText=false;f.controlManager.setActive("pastetext",false)}}else{if(/<(p|h[1-6]|ul|ol)/.test(m.content)){h._insertBlockContent(f,l,m.content)}else{h._insert(m.content,1)}}f.undoManager.add()}f.addCommand("mceInsertClipboardContent",function(k,l){j(l,true)});if(!b(f,"paste_text_use_dialog")){f.addCommand("mcePasteText",function(l,k){var m=tinymce.util.Cookie;f.pasteAsPlainText=!f.pasteAsPlainText;f.controlManager.setActive("pastetext",f.pasteAsPlainText);if((f.pasteAsPlainText)&&(!m.get("tinymcePasteText"))){if(b(f,"paste_text_sticky")){f.windowManager.alert(f.translate("paste.plaintext_mode_sticky"))}else{f.windowManager.alert(f.translate("paste.plaintext_mode_sticky"))}if(!b(f,"paste_text_notifyalways")){m.set("tinymcePasteText","1",new Date(new Date().getFullYear()+1,12,31))}}})}f.addButton("pastetext",{title:"paste.paste_text_desc",cmd:"mcePasteText"});f.addButton("selectall",{title:"paste.selectall_desc",cmd:"selectall"});function i(t){var o,r,l,m=f.selection,q=f.dom,s=f.getBody(),k;if(f.pasteAsPlainText&&(t.clipboardData||q.doc.dataTransfer)){t.preventDefault();j({content:(t.clipboardData||q.doc.dataTransfer).getData("Text")},true);return}if(q.get("_mcePaste")){return}o=q.add(s,"div",{id:"_mcePaste","class":"mcePaste"},'\uFEFF<br _mce_bogus="1">');k=f.plugins.jivescroll.lastScrollY;var u={position:"absolute",left:0,top:k,width:f.plugins.jiveresize.rte.getContentAreaWidth()-40,height:f.plugins.jiveresize.rte.getContentAreaHeight(),overflow:"hidden",opacity:0};if(tinymce.isGecko){u.visibility="hidden"}q.setStyles(o,u);if(tinymce.isIE){l=q.doc.body.createTextRange();l.moveToElementText(o);l.execCommand("Paste");q.remove(o);if(o.innerHTML==="\uFEFF"){f.execCommand("mcePasteWord");t.preventDefault();return}j({content:o.innerHTML});return tinymce.dom.Event.cancel(t)}else{function p(n){n.preventDefault()}q.bind(f.getDoc(),"mousedown",p);q.bind(f.getDoc(),"keydown",p);r=f.selection.getRng();o=o.firstChild;l=f.getDoc().createRange();l.setStart(o,0);l.setEnd(o,1);m.setRng(l);window.setTimeout(function(){var v="",n=q.select("div.mcePaste");if(n.length>1){n=q.select("div.mcePaste:not(:first)")}d(n,function(x){var w=x.firstChild;if(w&&w.nodeName=="DIV"&&w.style.marginTop&&w.style.backgroundColor){q.remove(w,1)}d(q.select("div.mcePaste",x),function(y){q.remove(y,1)});d(q.select("span.Apple-style-span",x),function(y){q.remove(y,1)});d(q.select("span.Apple-tab-span",x),function(z){var y=z.innerHTML;while(y!=y.replace("\t","     ")){y=y.replace("\t","     ")}z.parentNode.insertBefore(z.ownerDocument.createTextNode(y),z);q.remove(z,1)});d(q.select("br[_mce_bogus]",x),function(y){q.remove(y)});v+=x.innerHTML+"<br/>"});d(n,function(w){q.remove(w)});d(q.select("div.mcePaste"),function(w){q.remove(w)});if(r){m.setRng(r)}j({content:v});q.unbind(f.getDoc(),"mousedown",p);q.unbind(f.getDoc(),"keydown",p)},0)}}if(b(f,"paste_auto_cleanup_on_paste")){if(tinymce.isOpera||/Firefox\/2/.test(navigator.userAgent)){f.onKeyDown.add(function(k,l){if(((tinymce.isMac?l.metaKey:l.ctrlKey)&&l.keyCode==86)||(l.shiftKey&&l.keyCode==45)){i(l)}})}else{f.onPaste.addToTop(function(k,l){return i(l)})}}if(b(f,"paste_block_drop")){f.onInit.add(function(){f.dom.bind(f.getBody(),["dragend","dragover","draggesture","dragdrop","drop","drag"],function(k){k.preventDefault();k.stopPropagation();return false})})}h._legacySupport()},getInfo:function(){return{longname:"Paste text/word",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/paste",version:tinymce.majorVersion+"."+tinymce.minorVersion}},_preProcess:function(z,s){var j=this.editor,y=s.content,m=tinymce.grep,t=tinymce.explode,v=tinymce.trim,x,n;function r(h){d(h,function(o){if(o.constructor==RegExp){y=y.replace(o,"")}else{y=y.replace(o[0],o[1])}})}function A(o,h){h.push("<tr>");d(o,function(B){h.push("<td>");h.push(B);h.push("</td>")});h.push("</tr>")}(function(){var C=/\x0a\x20((?:\x0a\x20\x20[^<\x0a]*)+)\x0a\x20/g;var o=C.exec(y);if(o){var h=[y.substring(0,o.index),"<table><tbody>"];C.lastIndex=0;var B=o.index;y.replace(C,function(G,H,F,E){if(F>B){h.push("</tbody></table>");h.push(E.substring(B,F));h.push("<table><tbody>")}B=F+G.length;var D=H.split(/\x0a\x20\x20/).slice(1);A(D,h);return G});h.push(y.substring(B));y=h.join("")}})();(function(){var B="\t";if(tinymce.isGecko){B="(?:(?:&nbsp;){3} )"}else{if(tinymce.isWebKit){B="(?: *\t)"}else{if(tinymce.isIE){return}}}var o=new RegExp("^(?:[^<>]*?"+B+")+[^<>]*<br */?>","i");var h=new RegExp("(?:[^<>]*?"+B+")+[^<>]*","i");var E=new RegExp(B,"i");if(o.test(y)){function D(F,H){H.push("<table><tbody>");h.lastIndex=0;while(F.length&&h.test(F[0])){var G=F.shift().split(E);A(G,H)}H.push("</tbody></table>")}function C(H){var F=H.split(/<br *\/?>/ig);var G=[];while(F.length){h.lastIndex=0;if(h.test(F[0])){D(F,G)}else{G.push(F.shift());G.push("<br />")}}return G.join("")}y=C(y)}})();y=y.replace(/<style([^>]*)>([^<]*?)<\/style>/gi,"");r([[/^([^<]+)<br\s*\/?>$/gi,"$1"]]);r([[/(<[a-z][^>]*)\sid="?_mcePaste"?/gi,"$1"]]);if(/class="?Mso|style="[^"]*\bmso-|w:WordDocument/i.test(y)||s.wordContent){s.wordContent=true;r([/^\s*(?:&nbsp;)+/gi,/(?:&nbsp;|<br[^>]*>)+\s*$/gi]);if(b(j,"paste_convert_headers_to_strong")){y=y.replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>")}if(b(j,"paste_convert_middot_lists")){r([[/<!--\[if !supportLists\]-->/gi,"$&__MCE_ITEM__"],[/(<span[^>]+(?:mso-list:|:\s*symbol)[^>]+>)/gi,"$1__MCE_ITEM__"]]);do{var w=y;r([[/<span[^>]*>([&nbsp;|\s|\u00a0]+)<\/span>/gi,"$1"],[/(<span[^>]+(?:mso-list:|:\s*symbol)[^>]+>)(__MCE_ITEM__)([^<]*?)(<\/span>)/gi,"$2$3"]])}while(w!=y)}r([/<!--[\s\S]+?-->/gi,/<(?:!|script[^>]*>.*?<\/script(?=[>\s])|\/?(?:\?xml(?::\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi,"\u00a0"]]);do{x=y.length;y=y.replace(/(<[a-z][^>]*\s)(?:id|name|language|type|on\w+|\w+:\w+)=(?:"[^"]*"|\w+)\s?/gi,"$1")}while(x!=y.length);y=y.replace(/<strong><span([^>]*)font-weight:([^<;"]*)normal[;]?([^>]*)>([^<]*?)<\/span><\/strong>/gi,"<span$1$3>$4</span>");y=y.replace(/<strong><span([^>]*)font-weight:([^<;"]*)bold[er]?[;]?([^>]*)>([^<]*?)<\/span><\/strong>/gi,"<strong><span$1$3>$4</span></strong>");if(b(j,"paste_retain_style_properties").replace(/^none$/i,"").length==0){y=y.replace(/<\/?span[^>]*>/gi,"")}else{r([[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(o,h){return(h.length>0)?h.replace(/./," ").slice(Math.floor(h.length/2)).split("").join("\u00a0"):""}]])}}r([[/(<[a-z][^>]*)\sstyle="([^"]*)"/gi,function k(E,I,h){var B=[],D=0,H=t(v(h).replace(/&quot;/gi,"'"),";");var o=false;var G=false;var F=false;d(H,function C(Q){var J,M,L=t(Q,":");function N(S){return S+(((S!=="0")&&(/\d$/.test(S)))?"px":"")}if(L.length==2){J=L[0].toLowerCase();M=L[1].toLowerCase();var R=I.toLowerCase();switch(J){case"text-decoration":if(M!="none"){B[D++]=J+":"+M}return;case"font-style":if((R.indexOf("<em")===0||R.indexOf("<i")===0)&&$j.trim(M)=="normal"){F=true}else{if((R.indexOf("<em")===0||R.indexOf("<i")===0)&&$j.trim(M)=="oblique"){}else{B[D++]=J+":"+M}}return;case"font-weight":if((R.indexOf("<strong")===0||R.indexOf("<b")===0)&&$j.trim(M)=="normal"){F=true}else{if((R.indexOf("<strong")===0||R.indexOf("<b")===0)&&$j.trim(M).indexOf("bold")>=0){}else{B[D++]=J+":"+M}}return;case"list-style":case"list-style-type":case"list-style-image":case"list-style-position":if(R.indexOf("<ul")===0||R.indexOf("<ol")===0||R.indexOf("<li")===0){B[D++]=J+":"+M}return;case"border-collapse":return;case"border":case"border-width":case"border-style":case"border-color":if(R.indexOf("<table")===0||R.indexOf("<tr")===0||R.indexOf("<td")===0||R.indexOf("<th")===0||R.indexOf("<img")===0){if(M!="inherit"&&M!="initial"){M=M.replace(/(?:^|\s*)-moz[-\w]+\b/g,"");B[D++]=J+":"+M}}return;case"margin":case"margin-left":case"margin-right":case"margin-top":case"margin-bottom":case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-table-layout-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":M=M.replace(/^0(?:[\w]+)/gi,"0").replace(/(?:\s)0(?:[\w]+)/gi," 0").replace(/(?:\s)0\.00(?:[\d|\w]+)/gi," 0");M=M.replace(/^[0\s]*$/gi,"0");if(M!="0"){J=J.replace(/^mso-|-alt$/g,"").toLowerCase();if(J=="margin-left"&&$j.trim(R)=="<p"){var K=parseFloat(M);var O=M.replace(/[\d\.]*([^\d]*)$/g,"$1").toLowerCase();if(O=="in"){K=K*90;B[D++]="padding-left:"+K+"px";return}}else{if(L[1]!="0"&&L[1]!="initial"){if(R.indexOf("<table")===0||R.indexOf("<tr")===0||R.indexOf("<td")===0||R.indexOf("<th")===0||R.indexOf("<img")===0){if(M.indexOf("-")!==0){B[D++]=J+":"+M}}else{B[D++]=J+":"+M}}}}return;case"mso-list":o=M.replace(/.*level(\d*).*/gi,"$1");return;case"mso-bidi-theme-font":G=true;return;case"horiz-align":case"text-align":B[D++]="text-align:"+M;return;case"text-indent":B[D++]="text-indent:"+M;return;case"vert-align":B[D++]="vertical-align:"+M;return;case"font-color":case"mso-foreground":B[D++]="color:"+M;return;case"mso-background":case"mso-highlight":B[D++]="background:"+M;return;case"background-color":if(M!="transparent"){B[D++]="background-color:"+M}return;case"background-position":case"background-repeat":if(M!="initial initial"){B[D++]="background-position:"+M}return;case"background-image":return;case"font-size":if(M!="1em"){B[D++]="font-size:"+M}return;case"mso-default-height":if(M!="0px"){B[D++]="min-height:"+N(M)}return;case"mso-default-width":if(M!="0px"){B[D++]="min-width:"+N(M)}return;case"mso-padding-between-alt":B[D++]="border-collapse:separate;border-spacing:"+N(M);return;case"text-line-through":if((M=="single")||(M=="double")){B[D++]="text-decoration:line-through"}return;case"mso-zero-height":if(M=="yes"){B[D++]="display:none"}return}if(/^(?:mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?!decor|trans)|top-bar|version|vnd|word-break)/.test(J)){return}if(R.indexOf("<p")===0&&(J=="min-height"||J=="height")){return}L[1]=L[1].replace(/^0(?:[\w]+)/gi,"0").replace(/(?:\s)0(?:[\w]+)/gi," 0").replace(/(?:\s)0.00(?:[\d|\w]+)/gi," 0");L[1]=L[1].replace(/^[0\s]*$/gi,"0");var P=b(j,"paste_retain_style_properties");if((tinymce.is(P,"string"))&&(P!=="all")&&(P!=="*")){P=tinymce.explode(P.replace(/^none$/i,""))}else{P=[]}if((!P.length||$j.inArray(J,P))>=0&&L[1]!="0"&&L[1]!="initial"){B[D++]=J+":"+L[1]}}});I=I+(G?" jive-list-ol='1'":"")+(o?" jive-list-info='"+o+"'":"")+(F?" jive-remove-tag='1'":"");if(D>0){return I+' style="'+B.join(";")+'"'}else{return I}}]]);if(b(j,"paste_convert_headers_to_strong")){r([[/<h[1-6][^>]*>/gi,"<p><strong>"],[/<\/h[1-6][^>]*>/gi,"</strong></p>"]])}n=b(j,"paste_strip_class_attributes");if(n!=="none"){function q(B,o){if(n==="all"){return""}var h=m(t(o.replace(/^(["'])(.*)\1$/,"$2")," "),function(C){return(/^(?!mso)/i.test(C))});return h.length?' class="'+h.join(" ")+'"':""}y=y.replace(/ class="([^"]+)"/gi,q);y=y.replace(/ class=([\w-]+)/gi,q)}if(b(j,"paste_remove_spans")){y=y.replace(/<\/?span[^>]*>/gi,"")}r([[/<li[^>]*>(.*)<\/li>/gi,function(C,o){var D=C.substr(0,C.indexOf(">")+1);var h=C.substr(D.length+o.length);o=o.replace(/<p([^>]*)>(.*?)<\/p>/gi,"<span$1>$2</span>");o=o.replace(/<div([^>]*)>(.*?)<\/div>/gi,"<span$1>$2</span>");o=o.replace(/<br><\/span>/gi,"</span>");do{var B=o;o=o.replace(/<span[^>]*><\/span>/gi,"")}while(B!=o);return D+o+h}]]);y=y.replace(/<meta[^>]*>/gi,"");y=y.replace(/<\/meta>/gi,"");y=y.replace(/<br[^>]*>$/i,"");var g=/^<pre[^>]*>([\s\S]*)<\/pre[^>]*>$/i;var l=g.exec(y);if(l!=null){y=l[1].replace(/\n/g,"<br />")}else{y=y.replace(/\r/gi,"\n");var f=y.split("\n");var u=[];$j.each(f,function(h,o){u.push($j.trim(o))});y=u.join(" ")}y=y.replace(/<title([^>]*)>([^<]*?)<\/title>/gi,"");y=y.replace(/\n/gi,"").replace(/\r/gi,"");var i=y;do{y=i;i=y.replace(/<span>(.*?)<\/span>/gi,"$1")}while(i!=y);y=y.replace(/<pre>/gi,"<pre class='jive-pre'>");y=y.replace(/<div><br><\/div>/gi,"");y=y.replace(/<div([^>]*)>(\s?)<\/div>/gi,"");y=y.replace(/<li[^>]*>(.*?)<\/li>/gi,"<li>$1</li>");y=y.replace(/<ul[^>]*>(.*?)<\/ul>/gi,"<ul>$1</ul>");y=y.replace(/<li[^>]*>(.*?)<p[^>]*>(.*?)<\/li>/gi,"<li>$1$2</li>");y=y.replace(/<li[^>]*>(.*?)<\/p>(.*?)<\/li>/gi,"<li>$1$2</li>");y=y.replace(/<li><p>(.*?)<\/p><\/li>/gi,"<li>$1</li>");y=y.replace(/<ul><\/ul>/gi,"");y=y.replace(/<ol><\/ol>/gi,"");y=y.replace(/>([\s|^\u00a0]*)<td/gi,"><td");y=y.replace(/<\/td>([\s|^\u00a0]*)</gi,"</td><");y=y.replace(/<\/li>([\s&&[^\u00a0]]*)<\/ul>/gi,"</li></ul>");y=y.replace(/<\/li>([\s&&[^\u00a0]]*)<\/ol>/gi,"</li></ol>");y=y.replace(/<ul>([\s&&[^\u00a0]]*)<li>/gi,"<ul><li>");y=y.replace(/<ol>([\s&&[^\u00a0]]*)<li>/gi,"<ol><li>");y=y.replace(/<\/li>([\s&&[^\u00a0]]*)<li>/gi,"<li><li>");var p="(?:H[1-6R]|P|DIV|ADDRESS|PRE|FORM|TABLE|TBODY|THEAD|TFOOT|TH|TR|TD|LI|OL|UL|CAPTION|BLOCKQUOTE|CENTER|DL|DT|DD|DIR|FIELDSET|NOSCRIPT|MENU|ISINDEX|SAMP)";y=y.replace(new RegExp("(</?"+p+"[^>]*>)\\s+(?=<"+p+")","gi"),"$1");y=y.replace(new RegExp("(</"+p+"[^>]*>)\\s+(?=</"+p+")","gi"),"$1");y=y.replace(/> /gi,">&nbsp;");y=y.replace(/ </gi,"&nbsp;<");r([[/<div([^>]*)>((.(?!<div))*?)<\/div>/gi,function(B,C,h){var o=h.toLowerCase();if(o.indexOf("<ul")>=0||o.indexOf("<ol")>=0||o.indexOf("<blockquote")>=0||o.indexOf("<p")>=0){return h}return B}]]);y=y.replace(/<div([^>]*)>(.*?)<\/div>/gi,"<p$1>$2</p>");y=y.replace(/<\/strong><strong(?:\s*)>/gi,"");y=y.replace(/<\/b><b(?:\s*)>/gi,"");y=y.replace(/<\/u><u(?:\s*)>/gi,"");y=y.replace(/<\/em><em(?:\s*)>/gi,"");y=y.replace(/<\/i><i(?:\s*)>/gi,"");s.content=y},_postProcess:function(n,k){var x=this,u=x.editor,q=u.dom,w;x._removeNodes(n,k);x._fixOrphanLIs(n,k);if(k.wordContent){d(q.select("a",k.node),function(i){if(!i.href||i.href.indexOf("#_Toc")!=-1){q.remove(i,1)}});if(b(u,"paste_convert_middot_lists")){x._convertLists(n,k)}d(q.select("*",k.node),function(i){if(i.nodeName=="SPAN"&&!i.className&&!$j(i).attr("style")){q.remove(i,true)}})}if(b(u,"paste_remove_styles")||(b(u,"paste_remove_styles_if_webkit")&&tinymce.isWebKit)){d(q.select("*[style]",k.node),function(i){i.removeAttribute("style");i.removeAttribute("_mce_style")})}else{if(tinymce.isWebKit){d(q.select("*",k.node),function(i){if($j(i).attr("_mce_style")){$j(i).attr("style",$j(i).attr("_mce_style"))}i.removeAttribute("_mce_style")})}}for(var s=0;s<k.node.childNodes.length;s++){var r=k.node.childNodes[s];var f=r.nodeType==3;var v=/^[\s\u00a0]*$/gi.test(r.nodeValue);if(f&&v){r.parentNode.removeChild(r);s--}else{break}}for(var s=k.node.childNodes.length-1;s>=0;s--){var r=k.node.childNodes[s];var f=r.nodeType==3;var v=/^[\s\u00a0]*$/gi.test(r.nodeValue);if(f&&v){r.parentNode.removeChild(r)}else{break}}if(k.node.childNodes.length>1){var j=false;var h=new Array();for(var s=0;s<k.node.childNodes.length;s++){var r=k.node.childNodes[s];var l=r.nextSibling;if(r.nodeType==3||!q.isBlock(r)&&r.nodeName.toLowerCase()!="br"){if(l&&l.nodeType==1&&l.nodeName.toLowerCase()=="p"){if(l.innerHTML.length==0){l.parentNode.removeChild(l)}}else{if(l&&l.nodeType==1&&l.nodeName.toLowerCase()=="br"){l.parentNode.removeChild(l);j=true}}h.push(r)}else{if(r.nodeType==1&&r.nodeName.toLowerCase()=="br"){var g=r.ownerDocument.createElement("p");r.parentNode.insertBefore(g,r);g.appendChild(r);r=g}}if(l&&l.nodeType==1&&q.isBlock(l)||j){if(h.length){s=s-h.length+1;var g=h[0].ownerDocument.createElement("p");k.node.insertBefore(g,h[0]);do{var m=h.splice(0,1);g.appendChild(m[0])}while(h.length)}h=new Array()}j=false}if(h.length){s=s-h.length+1;var g=h[0].ownerDocument.createElement("p");k.node.insertBefore(g,h[0]);do{var m=h.splice(0,1);g.appendChild(m[0])}while(h.length)}}d(q.select("table",k.node),function(o){var y=o.firstChild;while(y){var p=y;y=y.nextSibling;if(p.nodeType!=1){o.removeChild(p)}else{var i=p.nodeName.toLowerCase();if(i!="tbody"&&i!="tr"){o.removeChild(p)}}}});$j(k.node).find("p").each(function(){var i=$j(this);$j(this).find("p").each(function(){var o=$j(this);u.dom.split(o.parents("p").get(0),o.get(0))})});$j(k.node).find("a.jive_macro").each(function(){var i=$j(this);if(!i.attr("href")){i.attr("href","javascript:;")}if(!i.attr("jivemacro")){var o=i.attr("class").split(/\s+/);$j.each(o,function(p,t){if(t.indexOf("jive_macro_")===0){var y=t.substr("jive_macro_".length);i.attr("jivemacro",y)}})}});u.addVisual(k.node)},_fixOrphanLIs:function(i,g){var k=i.editor.dom,j,n,f=-1,h,p=[],m,l;if(i.editor.selection.getNode().nodeName.toLowerCase()!=="li"){d(k.select("li",g.node),function(o){if(o.parentNode.nodeName.toLowerCase()!="ul"&&o.parentNode.nodeName.toLowerCase()!="ol"){var q=o.ownerDocument.createElement("ul");o.parentNode.insertBefore(q,o);q.appendChild(o)}})}},_removeNodes:function(i,g){var k=i.editor.dom,j,n,f=-1,h,p=[],m,l;d(k.select("[jive-remove-tag=1]",g.node),function(o){if(o.nodeType==1){while(o.childNodes.length){o.parentNode.insertBefore(o.childNodes[0],o)}o.parentNode.removeChild(o)}})},_convertLists:function(k,h){var m=k.editor.dom,l,r,f=-1,j,s=[],p,n;function i(u){var t=m.create(u.listType),o="list-style-type: "+u.subType;if(tinymce.isIE){t.style.setAttribute("cssText",o)}else{t.setAttribute("style",o)}return t}function q(u){var v=u.innerHTML.replace(/<\/?\w+[^>]*>/gi,"").replace(/&nbsp;/g,"\u00a0"),o={isListItem:/__MCE_ITEM__+/.test(v)||/^(\d)+\./.test(v)||/^v\s+/.test(v)||/^[a-z]+\./i.test(v)};if(o.isListItem){var t=v.match(/^([^\s]+)/)[0].replace(/^(__MCE_ITEM__)*/,""),w=(/^(\d|[a-z])+/i.test(t)&&!/^(o|v)/i.test(t))||!!m.select("[jive-list-ol]",u).length;o.listType=w?"ol":"ul";o.subType="disc";if(w){o.subType=(function(){switch(true){case /^[a-z]+\./.test(v):return"lower-alpha";case /^[A-Z]+\./.test(v):return"upper-alpha";default:return"decimal"}})()}}return o}d(m.select("p",h.node),function(y){var u,v,o,t,x=q(y);if(x.isListItem){var w=parseFloat(y.getAttribute("jive-list-info")||0);if(w>f){s.push(w)}if(!l||(x.listType!=p&&w==f)){l=i(x);m.insertAfter(l,y)}else{if(w>f){var z=l;l=i(x);z.appendChild(l)}else{if(w<f){o=tinymce.inArray(s,w);t=m.getParents(l.parentNode,x.listType);l=t[t.length-1-o]||l}}}d(m.select("span",y),function(B){var A=B.innerHTML.replace(/<\/?\w+[^>]*>/gi,"");if(x.listType=="ul"&&/^.?\s*(&nbsp;|\u00a0)+\s*/.test(A)){m.remove(B)}else{if(/^__MCE_ITEM__[\s\S]*\w+[\.|\)|:]?(&nbsp;|\u00a0)+\s*/.test(A)){m.remove(B)}}});if(/alpha$/.test(x.subType)){y.innerHTML=y.innerHTML.replace(/^[a-z]+\.(\s|\u00a0|&nbsp;)+/i,"")}v=y.innerHTML;if(x.listType=="ul"){v=v.replace(/(__MCE_ITEM__)+.?\s*(&nbsp;|\u00a0|\u00b7)+\s*/,"")}else{v=v.replace(/(__MCE_ITEM__)+\s*\w+[\.|\)|:]?(&nbsp;|\u00a0)+\s*/,"").replace(/^\d+\.(\s|\u00a0|&nbsp;)+/,"");v=v.replace(/__MCE(\w|\.)+\s?/,"")}r=l.appendChild(m.create("li",0,v));m.remove(y);f=w;p=x.listType}else{l=f=0}});n=h.node.innerHTML;n=n.replace(/__MCE_ITEM__/g,"");do{var g=n;n=n.replace(/<(\w+)[^>]*?>\s*<\/[^>]*>/gi,"")}while(g!=n);h.node.innerHTML=n},_insertBlockContent:function(m,i,n){var g,k,h=m.selection,r,o,f,p,j,l="mce_marker";function q(v){var s;if(tinymce.isIE){s=m.getDoc().body.createTextRange();try{s.moveToElementText(v)}catch(u){try{s.moveToElementText(v.parentNode)}catch(t){}}s.collapse(false);s.select()}else{h.select(v,1);h.collapse(false)}}this._insert('<span id="'+l+'"></span>',1);k=i.get(l);g=i.getParent(k,"p,h1,h2,h3,h4,h5,h6,ul,ol,th,td");if(g&&!/TD|TH/.test(g.nodeName)){k=i.split(g,k);d(i.create("div",0,n).childNodes,function(s){r=s.cloneNode(true);k.parentNode.insertBefore(r,k)});q(r)}else{i.setOuterHTML(k,n);h.select(m.getBody(),1);h.collapse(0)}while(o=i.get(l)){i.remove(o)}o=h.getStart();f=i.getViewPort(m.getWin());p=m.dom.getPos(o).y;j=o.clientHeight;if(p<f.y||p+j>f.y+f.h){m.getWin().scrollTo(0,p<f.y?p:p-f.h+j)}},_insert:function(i,f){var g=this.editor,j=g.selection.getRng();if(!g.selection.isCollapsed()&&j.startContainer!=j.endContainer){g.getDoc().execCommand("Delete",false,null)}g.execCommand(tinymce.isGecko?"insertHTML":"mceInsertContent",false,i,{skip_undo:f})},_insertPlainText:function(k,y,x){var u,v,m,l,s,f,q,g,o=k.getWin(),A=k.getDoc(),t=k.selection,n=tinymce.is,z=tinymce.inArray,j=b(k,"paste_text_linebreaktype"),p=b(k,"paste_text_replacements");function r(h){d(h,function(i){if(i.constructor==RegExp){x=x.replace(i,"")}else{x=x.replace(i[0],i[1])}})}if((typeof(x)==="string")&&(x.length>0)){if(!e){e=("34,quot,38,amp,39,apos,60,lt,62,gt,"+k.serializer.settings.entities).split(",")}if(/<(?:p|br|h[1-6]|ul|ol|dl|table|t[rdh]|div|blockquote|fieldset|pre|address|center)[^>]*>/i.test(x)){r([/[\n\r]+/g])}else{r([/\r+/g])}r([[/<\/(?:p|h[1-6]|ul|ol|dl|table|div|blockquote|fieldset|pre|address|center)>/gi,"\n\n"],[/<br[^>]*>|<\/tr>/gi,"\n"],[/<\/t[dh]>\s*<t[dh][^>]*>/gi,"\t"],/<[a-z!\/?][^>]*>/gi,[/&nbsp;/gi," "],[/&(#\d+|[a-z0-9]{1,10});/gi,function(i,h){if(h.charAt(0)==="#"){return String.fromCharCode(h.slice(1))}else{return((i=z(e,h))>0)?String.fromCharCode(e[i-1]):" "}}],[/(?:(?!\n)\s)*(\n+)(?:(?!\n)\s)*/gi,"$1"],[/\n{3,}/g,"\n\n"],/^\s+|\s+$/g]);x=y.encode(x);if(!t.isCollapsed()){A.execCommand("Delete",false,null)}if(n(p,"array")||(n(p,"array"))){r(p)}else{if(n(p,"string")){r(new RegExp(p,"gi"))}}if(j=="none"){r([[/\n+/g," "]])}else{if(j=="br"){r([[/\n/g,"<br />"]])}else{r([/^\s+|\s+$/g,[/\n\n/g,"</p><p>"],[/\n/g,"<br />"]])}}if((m=x.indexOf("</p><p>"))!=-1){l=x.lastIndexOf("</p><p>");s=t.getNode();f=[];do{if(s.nodeType==1){if(s.nodeName=="TD"||s.nodeName=="BODY"){break}f[f.length]=s}}while(s=s.parentNode);if(f.length>0){q=x.substring(0,m);g="";for(u=0,v=f.length;u<v;u++){q+="</"+f[u].nodeName.toLowerCase()+">";g+="<"+f[f.length-u-1].nodeName.toLowerCase()+">"}if(m==l){x=q+g+x.substring(m+7)}else{x=q+x.substring(m+4,l+4)+g+x.substring(l+7)}}}k.execCommand("mceInsertRawHTML",false,x+'<span id="_plain_text_marker">&nbsp;</span>');window.setTimeout(function(){var h=y.get("_plain_text_marker"),C,i,B,w;t.select(h,false);A.execCommand("Delete",false,null);h=null;C=t.getStart();i=y.getViewPort(o);B=y.getPos(C).y;w=C.clientHeight;if((B<i.y)||(B+w>i.y+i.h)){A.body.scrollTop=B<i.y?B:B-i.h+25}},0)}},_legacySupport:function(){var g=this,f=g.editor;f.addCommand("mcePasteWord",function(){f.windowManager.open({file:g.url+"/pasteword.htm",width:parseInt(b(f,"paste_dialog_width")),height:parseInt(b(f,"paste_dialog_height")),inline:1})});if(b(f,"paste_text_use_dialog")){f.addCommand("mcePasteText",function(){f.windowManager.open({file:g.url+"/pastetext.htm",width:parseInt(b(f,"paste_dialog_width")),height:parseInt(b(f,"paste_dialog_height")),inline:1})})}f.addButton("pasteword",{title:"paste.paste_word_desc",cmd:"mcePasteWord"})}});tinymce.PluginManager.add("paste",tinymce.plugins.PastePlugin)})();
;
(function(){tinymce.create("tinymce.plugins.JiveScrollPlugin",{lastScrollY:0,lastScrollX:0,body:null,win:null,init:function(a){a.onScroll=new tinymce.util.Dispatcher(this);var b=this;a.onInit.add(function(){this.intervalId=setInterval(function(){b.resetScroll(a)},300);$j(a.getWin()).bind("scroll",function(){if(!b.timeoutId){b.timeoutId=setTimeout(function(){b.timeoutId=null;b.resetScroll(a)},10)}if(b.intervalId){clearInterval(b.intervalId);b.intervalId=null}})},this);a.theme.onResize.add(function(){b.resetScroll(a)},this)},resetScroll:function(b){try{if(this.intervalId&&(b.destroyed||!b.getWin())){clearInterval(this.intervalId);return}if(!this.body){this.body=$j(b.getBody()).parents("html").andSelf();this.win=$j(b.getWin())}var d=this.body.scrollTop();if(!d){d=this.win.scrollTop()}var a=this.body.scrollLeft();if(!a){a=this.win.scrollLeft()}if(this.lastScrollY!=d||this.lastScrollX!=a){this.lastScrollY=d;this.lastScrollX=a;b.onScroll.dispatch(a,d)}}catch(c){console.log("error in jivescroll.resetScroll");console.log(c)}},getInfo:function(){return{longname:"Jive Scroll",author:"Jive Software",authorurl:"http://jivesoftware.com",infourl:"http://jivesoftware.com",version:tinyMCE.majorVersion+"."+tinyMCE.minorVersion}}});tinymce.PluginManager.add("jivescroll",tinymce.plugins.JiveScrollPlugin)})();
;
(function(){tinymce.create("tinymce.plugins.JiveBlackoutPlugin",{rte:null,$left:$j("<div class='blackout l'></div>"),$right:$j("<div class='blackout r'></div>"),$top:$j("<div class='blackout t'></div>"),$bottom:$j("<div class='blackout b'></div>"),minY:null,minX:null,nodeL:null,nodeR:null,ed:null,resetMinMaxY:function(a){this.minY=$j(a.getWin()).scrollTop();this.minX=$j(a.getWin()).scrollLeft()},init:function(a){var d=this;this.ed=a;a.onHideBlackout=new tinymce.util.Dispatcher(this);var c=(function(f,e){return function(){f.resetMinMaxY(e)}})(this,a);var b=(function(f,e){return function(){if(f.nodeL||f.nodeR){f.showBlackout(e,f.nodeL,f.nodeR)}}})(this,a);a.onNodeChange.add(b,this);a.onScroll.add(function(){c();b()},this);a.theme.onResize.add(function(){c();b()},this);$j(window).resize(function(){c();b()});$j(window.document.body).click(function(){d.hideBlackout()});a.onInit.add(c,this);setTimeout(c,300);setTimeout(c,500);setTimeout(c,800)},hideBlackout:function(){if(this.nodeL||this.nodeR){this.nodeL=null;this.nodeR=null;this.$left.remove();this.$right.remove();this.$top.remove();this.$bottom.remove();this.ed.onHideBlackout.dispatch()}},showBlackout:function(h,n,i){var j=this;if(!n){return}if(!i){i=n}this.resetMinMaxY(h);this.nodeL=n;this.nodeR=i;var m=$j(n);var g=$j(i);var c=m.offset();var p=g.offset();var b=this.rte.getPopOverContainer();var o=this.rte.getContentAreaHeight();var d=this.rte.getContentAreaWidth();function f(q,r){q.bottom=q.top+q.height;q.right=q.left+q.width;if(q.left<j.minX){q.width-=j.minX-q.left;q.left=j.minX}if(q.top<j.minY){q.height-=j.minY-q.top;q.top=j.minY}if(q.bottom>j.minY+o){q.height-=q.top+q.height-j.minY-o}if(q.left+q.width>j.minX+d){q.width-=q.left+q.width-j.minX-d}if(q.left>=j.minX+d){r.remove()}else{if(q.top>=j.minY+o){r.remove()}else{if(q.top>=q.bottom||q.left>=q.right){r.remove()}else{b.append(r)}}}delete q.bottom;delete q.right;r.css(q);r.click(function(){j.hideBlackout()})}var a=g.outerHeight();var e=g.outerWidth();var k=$j(h.getBody()).outerHeight();var l={top:p.top+a,left:c.left,width:p.left+e-c.left,height:Math.max(o,k)-p.top-a};f(l,this.$bottom);l={top:0,left:0,width:c.left,height:Math.max(o,k)};f(l,this.$left);l={top:0,left:c.left,width:p.left+e-c.left,height:c.top};f(l,this.$top);l={top:0,left:p.left+e,width:Math.max(d,$j(h.getDoc()).width())-e-p.left,height:Math.max(o,k)};f(l,this.$right)},getInfo:function(){return{longname:"Jive Blackout",author:"Jive Software",authorurl:"http://jivesoftware.com",infourl:"http://jivesoftware.com",version:tinyMCE.majorVersion+"."+tinyMCE.minorVersion}}});tinymce.PluginManager.add("jiveblackout",tinymce.plugins.JiveBlackoutPlugin)})();
;
(function(){tinymce.create("tinymce.plugins.JiveResizePlugin",{rte:null,$tl:$j("<div class='handle tl'></div>"),$tr:$j("<div class='handle tr'></div>"),$bl:$j("<div class='handle bl'></div>"),$br:$j("<div class='handle br'></div>"),minY:0,minX:0,$node:null,preserveRatio:false,dragging:false,resetMinMaxY:function(a){this.minY=a.plugins.jivescroll.lastScrollY;this.minX=a.plugins.jivescroll.lastScrollX},setRTE:function(a){this.rte=a;this.completeInit()},completeInit:function(){if(this.ed&&this.rte&&!this.initialized){this.initialized=true;var a=this.ed;var b=this.rte;var c=this;if(tinymce.isWebKit){a.onNodeChange.add(function(e){var d=$j($j(e.selection.getNode()).closest("img, table").andSelf().toArray().reverse()).filter("img, table");if(d.is("img, table")){this.showCorners(e,d,d.is("img"))}else{this.hideCorners()}},this);a.onMouseDown.add(function(d){c.hideCorners()},this);a.onClick.add(function(e){var d=$j($j(e.selection.getNode()).closest("img, table").andSelf().toArray().reverse()).filter("img, table");if(d.is("img, table")){this.showCorners(e,d,d.is("img"))}else{this.hideCorners()}},this);c.resetMinMaxY(a);c.setupHandlers(a)}}},init:function(a){this.ed=a;a.onResizingNode=new tinymce.util.Dispatcher(this);a.onResizedNode=new tinymce.util.Dispatcher(this);if(tinymce.isWebKit){var c=this;var b=(function(e,d){return function(g,f){e.minY=f;e.minX=g;if(e.$node){if(!e.dragging){e.showCorners(d,e.$node,e.preserveRatio)}}}})(this,a);a.onInit.add(this.completeInit,this);a.onScroll.add(b,this);a.theme.onResize.add(function(){c.resetMinMaxY(a);c.showCorners(a,c.$node,c.preserveRatio)},this);$j(window).resize(function(){c.resetMinMaxY(a);c.showCorners(a,c.$node,c.preserveRatio)})}},hideCorners:function(){this.$node=null;this.$tl.remove();this.$tr.remove();this.$br.remove();this.$bl.remove()},showCorners:function(b,a,c){var d=this;if(!a||!a.length){return}if(a.hasClass("jive_emote")){return}this.resetMinMaxY(b);this.$node=a;this.preserveRatio=c;this.showCornersHelper();function e(){d.dragging=$j(this);b.plugins.jivemouse.showMouseCatch()}this.$br.mousedown(e);this.$bl.mousedown(e);this.$tr.mousedown(e);this.$tl.mousedown(e)},setupHandlers:function(e){var g=this;this.resetMinMaxY(e);var a=this.rte.getPopOverContainer();var k=this.rte.getContentAreaHeight();var c=this.rte.getContentAreaWidth();function d(n,o){if(n.top<e.plugins.jivescroll.lastScrollY-3){o.remove()}else{if(n.top>e.plugins.jivescroll.lastScrollY+k){o.remove()}else{if(n.left<e.plugins.jivescroll.lastScrollX){o.remove()}else{if(n.left>e.plugins.jivescroll.lastScrollX+c){o.remove()}else{a.append(o)}}}}o.css("top",n.top);o.css("left",n.left);o.css("cursor",n.cursor)}var b=-3;var h=-3;function i(){var n=g.$node.offset();o={top:n.top+g.$node.outerHeight()+h,left:n.left+g.$node.outerWidth()+b,cursor:"se-resize"};d(o,g.$br);var o={top:n.top+g.$node.outerHeight()+h,left:n.left+b,cursor:"sw-resize"};d(o,g.$bl);o={top:n.top+h,left:n.left+b,cursor:"nw-resize"};d(o,g.$tl);o={top:n.top+h,left:n.left+g.$node.outerWidth()+b,cursor:"ne-resize"};d(o,g.$tr)}g.showCornersHelper=function(){k=g.rte.getContentAreaHeight();c=g.rte.getContentAreaWidth();i()};var l=0;var j=0;var m=0;var f=0;g.dragging=false;$j(e.getContainer()).find(".mceIframeContainer").mousedown(function(n){if(g.dragging&&g.$node){l=n.pageX;j=n.pageY;m=g.$node.width();f=g.$node.height();e.onResizingNode.dispatch(g.$node,m,f);return false}});$j(e.getContainer()).parents("body").mousemove(function(p){if(g.dragging&&g.$node){var n=(p.pageX-l);var o=(p.pageY-j);if(g.dragging.get(0)==g.$br.get(0)){if(n<o){g.$node.width(m+n);g.$node.height(f+(g.preserveRatio?(f/m*n):o))}else{g.$node.height(f+o);g.$node.width(m+(g.preserveRatio?(m/f*o):n))}}else{if(g.dragging.get(0)==g.$tr.get(0)){g.$node.width(m+n);g.$node.height(f+(g.preserveRatio?(f/m*n):-o))}else{if(g.dragging.get(0)==g.$tl.get(0)){g.$node.width(m-n);g.$node.height(f-(g.preserveRatio?(f/m*n):o))}else{if(g.dragging.get(0)==g.$bl.get(0)){if(Math.abs(n)<Math.abs(o)){if(n<0){g.$node.width(m-n);g.$node.height(f-(g.preserveRatio?(f/m*n):o))}else{g.$node.width(m+n);g.$node.height(f+(g.preserveRatio?(f/m*n):o))}}else{g.$node.height(f+o);g.$node.width(m+(g.preserveRatio?(m/f*o):n))}}}}}g.$node.removeAttr("_mce_style");g.$node.attr("width",g.$node.width());g.$node.attr("height",g.$node.height());e.onResizingNode.dispatch(g.$node,g.$node.width(),g.$node.height());i();return false}});$j(e.getContainer()).parents("body").mouseup(function(){if(g.dragging){g.dragging=false;e.plugins.jivemouse.hideMouseCatch();if(g.$node){e.onResizedNode.dispatch(g.$node,g.$node.width(),g.$node.height())}e.nodeChanged()}})},getInfo:function(){return{longname:"Jive Resize",author:"Jive Software",authorurl:"http://jivesoftware.com",infourl:"http://jivesoftware.com",version:tinyMCE.majorVersion+"."+tinyMCE.minorVersion}}});tinymce.PluginManager.add("jiveresize",tinymce.plugins.JiveResizePlugin)})();
;
var foo=(function(){var d=tinymce.DOM,b=tinymce.dom.Event,g=tinymce.extend,e=tinymce.each,a=tinymce.util.Cookie,f,c=tinymce.explode;tinymce.ThemeManager.requireLangPack("advanced");tinymce.create("tinymce.themes.AdvancedTheme",{controls:{bold:["bold_desc","Bold"],italic:["italic_desc","Italic"],underline:["underline_desc","Underline"],strikethrough:["striketrough_desc","Strikethrough"],justifyleft:["justifyleft_desc","JustifyLeft"],justifycenter:["justifycenter_desc","JustifyCenter"],justifyright:["justifyright_desc","JustifyRight"],justifyfull:["justifyfull_desc","JustifyFull"],bullist:["bullist_desc","jiveInsertUnorderedList"],numlist:["numlist_desc","jiveInsertOrderedList"],outdent:["outdent_desc","mceOutdent"],indent:["indent_desc","mceIndent"],cut:["cut_desc","Cut"],copy:["copy_desc","Copy"],paste:["paste_desc","Paste"],link:["link_desc","mceLink"],unlink:["unlink_desc","unlink"],image:["image_desc","mceImage"],undo:["undo_desc","Undo"],redo:["redo_desc","Redo"],sub:["sub_desc","subscript"],sup:["sup_desc","superscript"],code:["code_desc","mceCodeEditor"],hr:["hr_desc","InsertHorizontalRule"],removeformat:["removeformat_desc","mceRemoveFullFormat"],forecolor:["forecolor_desc","ForeColor"],forecolorpicker:["forecolor_desc","mceForeColor"],backcolor:["backcolor_desc","HiliteColor"],backcolorpicker:["backcolor_desc","mceBackColor"],blockquote:["blockquote_desc","mceBlockQuote"]},stateControls:["bold","italic","underline","strikethrough","bullist","numlist","justifyleft","justifycenter","justifyright","justifyfull","blockquote"],removeListsFromHelper:function(i,n,h,l){var j=false;if(h==null){return true}if(h==l){j=true}var m=i.getDoc();if(h.nodeType==3||h.nodeName.toLowerCase()!="ol"&&h.nodeName.toLowerCase()!="ul"){n.appendChild(h);return false}while(h.childNodes.length>0){var k=h.childNodes[0];if(this.removeListsFromHelper(i,n,k,l)){if(h.nodeName.toLowerCase()=="ol"||h.nodeName.toLowerCase()=="ul"){h.removeChild(k)}return true}if(h.nodeName.toLowerCase()=="ol"||h.nodeName.toLowerCase()=="ul"){h.removeChild(k)}}if(this.shouldEndLine(h)){n.appendChild(m.createTextNode("\n"))}if(j){return j}if(h.nextSibling!=null){if(this.removeListsFromHelper(i,n,h.nextSibling,l)){return true}}return false},getParentNode:function(h,i){return(new tinymce.dom.DOMUtils(h.getDoc())).getParent(i,function(j){return j==h.getBody()||j!=i})},removeListsFrom:function(m,j,k,h){var n=false;if(k==null){return true}if(k==h){n=true}var p=m.getDoc();if(k.nodeType==3||k.nodeName.toLowerCase()!="ol"&&k.nodeName.toLowerCase()!="ul"){j.appendChild(k);return false}while(k.childNodes.length>0){var i=k.childNodes[0];if(this.removeListsFromHelper(m,j,i,h)){if(k.nodeName.toLowerCase()=="ol"||k.nodeName.toLowerCase()=="ul"){k.removeChild(i)}return true}if(k.nodeName.toLowerCase()=="ol"||k.nodeName.toLowerCase()=="ul"){k.removeChild(i)}}if(this.shouldEndLine(k)){j.appendChild(p.createTextNode("\n"))}if(n){if(k.nodeName.toLowerCase()=="ol"||k.nodeName.toLowerCase()=="ul"){var o=this.getParentNode(m,k);o.removeChild(k)}return n}if(k.nextSibling!=null){var l=k.nextSibling;if(k.nodeName.toLowerCase()=="ol"||k.nodeName.toLowerCase()=="ul"){var o=this.getParentNode(m,k);o.removeChild(k)}if(this.removeListsFromHelper(m,j,l,h)){return true}}var l=this.getNextSibling(m,k);if(k.nodeName.toLowerCase()=="ol"||k.nodeName.toLowerCase()=="ul"){var o=this.getParentNode(m,k);o.removeChild(k)}if(this.removeListsFrom(m,j,l,h)){return true}return false},init:function(i,j){var k=this,l,h;i.addCommand("mceRemoveFullFormat",function(){if(!i.selection.isCollapsed()){i.execCommand("RemoveFormat");var o=i.selection.getNode();var m=i.dom.getParent(o,"table");if(m==null){i.execCommand("FormatBlock",false,"<p>")}}});k.editor=i;k.url=j;k.onResolveName=new tinymce.util.Dispatcher(this);k.onResize=new tinymce.util.Dispatcher(this);k.settings=l=g({theme_advanced_path:true,theme_advanced_toolbar_location:"bottom",theme_advanced_blockformats:"p,address,pre,h1,h2,h3,h4,h5,h6",theme_advanced_toolbar_align:"center",theme_advanced_fonts:"Andale Mono=andale mono,times;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier;Georgia=georgia,palatino;Helvetica=helvetica;Impact=impact,chicago;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco;Times New Roman=times new roman,times;Trebuchet MS=trebuchet ms,geneva;Verdana=verdana,geneva;Webdings=webdings;Wingdings=wingdings,zapf dingbats",theme_advanced_font_sizes:"1,2,3,4,5,6,7",theme_advanced_more_colors:1,theme_advanced_row_height:23,theme_advanced_resize_horizontal:1,theme_advanced_resizing_use_cookie:1},i.settings);if((h=l.theme_advanced_path_location)&&h!="none"){l.theme_advanced_statusbar_location=l.theme_advanced_path_location}if(l.theme_advanced_statusbar_location=="none"){l.theme_advanced_statusbar_location=0}i.onInit.add(function(){i.onNodeChange.add(k._nodeChanged,k);i.onKeyDown.add(k._keyDown,k);jive.ext.x.xTimer.set("timeout",k,"_refreshFont",33);jive.ext.x.xTimer.set("timeout",k,"_refreshFont",500);jive.ext.x.xTimer.set("timeout",k,"_refreshFontColor",33);jive.ext.x.xTimer.set("timeout",k,"_refreshFontColor",500);jive.ext.x.xTimer.set("timeout",k,"_refreshFontSize",33);jive.ext.x.xTimer.set("timeout",k,"_refreshFontSize",500);i.addCommand("jiveInsertUnorderedList",function(){i.execCommand("mceInsertUnorderedList");window.focus();i.focus()});i.addCommand("jiveInsertOrderedList",function(){i.execCommand("mceInsertOrderedList");window.focus();i.focus()});var p=i.controlManager.get("fontsizeselect");if(p){var o=document.createElement("DIV");var n=["8 pt","10 pt","12 pt","14 pt","18 pt","24 pt","36 pt"],m=[8,10,12,14,18,24,36];p.computed=new Array();document.body.appendChild(o);e(c(k.settings.theme_advanced_font_sizes),function(q){o.style.fontSize=m[q-1]+"pt";var r=jive.ext.x.xGetCS(o,"font-size");p.computed.push(r);p.add(n[parseInt(q)-1],q,{style:"font-size:"+m[q-1]+"pt","class":"mceFontSize"+q})});document.body.removeChild(o);i.onKeyUp.add(function(r){var q=r.controlManager;q.setActive("bold",r.queryCommandState("Bold"));q.setActive("italic",r.queryCommandState("Italic"));q.setActive("underline",r.queryCommandState("Underline"));q.setActive("strikethrough",r.queryCommandState("Strikethrough"))});i.onBeforeExecCommand.add(function(s,v,u,w){var r=s.controlManager;if(v=="Bold"){r.get("bold").setActive(s.queryCommandState("Bold"))}if(v=="Italic"){r.get("italic").setActive(s.queryCommandState("Italic"))}if(v=="Underline"){r.get("underline").setActive(s.queryCommandState("Underline"))}if(v=="Strikethrough"){r.get("strikethrough").setActive(s.queryCommandState("Strikethrough"))}if(v=="mceOutdentComplete"||v=="mceIndentComplete"){r.setDisabled("outdent",!s.queryCommandState("Outdent"))}if(v=="FontSize"){if(!s.selection.isCollapsed()){var q=s.selection.getStart();var t=s.selection.getEnd();q=s.plugins.jiveutil.getNodeAt(q,s.selection.getRng().startOffset);s.plugins.jiveutil.walkDOMTree(q,t,function(x){if(!tinymce.isWebKit&&x.style){x.style.fontSize=""}if(x.nodeType==1&&x.nodeName.toLowerCase()=="font"&&x.getAttribute("size")!=w){x.setAttribute("size",w)}})}}})}});i.onSetProgressState.add(function(o,m,p){var q,r=o.id,n;if(m){k.progressTimer=setTimeout(function(){q=o.getContainer();q=q.insertBefore(d.create("DIV",{style:"position:relative"}),q.firstChild);n=d.get(o.id+"_tbl");d.add(q,"div",{id:r+"_blocker","class":"mceBlocker",style:{width:n.clientWidth+2,height:n.clientHeight+2}});d.add(q,"div",{id:r+"_progress","class":"mceProgress",style:{left:n.clientWidth/2,top:n.clientHeight/2}})},p||0)}else{d.remove(r+"_blocker");d.remove(r+"_progress");clearTimeout(k.progressTimer)}});d.loadCSS(window.CS_RESOURCE_BASE_URL+"/"+(l.editor_css||"styles/tiny_mce3/themes/advanced/skins/"+i.settings.skin+"/ui.css"));if(l.ui_css){d.loadCSS(l.ui_css)}d.loadCSS(window.CS_RESOURCE_BASE_URL+"/"+(l.editor_css||"styles/tiny_mce3/themes/advanced/skins/"+i.settings.skin+"/content.css"));if(l.skin_variant){d.loadCSS(i.baseURI.toAbsolute(l.editor_css||"themes/advanced/skins/"+i.settings.skin+"/ui_"+l.skin_variant+".css"))}},createControl:function(k,h){var i,j;if(j=h.createControl(k)){return j}switch(k){case"styleselect":return this._createStyleSelect();case"formatselect":return this._createBlockFormats();case"fontselect":return this._createFontSelect();case"fontsizeselect":return this._createFontSizeSelect();case"forecolor":return this._createForeColorMenu();case"backcolor":return this._createBackColorMenu()}if((i=this.controls[k])){return h.createButton(k,{title:"advanced."+i[0],cmd:i[1],ui:i[2],value:i[3]})}},execCommand:function(j,i,k){var h=this["_"+j];if(h){h.call(this,i,k);return true}return false},_importClasses:function(){var h=this.editor,i=h.controlManager.get("styleselect");if(i.getLength()==0){e(h.dom.getClasses(),function(j){i.add(j["class"],j["class"])})}},_createStyleSelect:function(l){var i=this,h=i.editor,j=h.controlManager,k=j.createListBox("styleselect",{title:"advanced.style_select",onselect:function(m){if(k.selectedValue===m){h.execCommand("mceSetStyleInfo",0,{command:"mceRemoveFullFormat"});k.select();return false}else{h.execCommand("mceSetCSSClass",0,m)}}});if(k){e(h.getParam("theme_advanced_styles","","hash"),function(n,m){if(n){k.add(i.editor.translate(m),n)}});k.onPostRender.add(function(m,o){b.add(o,"focus",i._importClasses,i);b.add(o,"mousedown",i._importClasses,i)})}return k},_createFontSelect:function(){var j,i=this,h=i.editor;j=h.controlManager.createListBox("fontselect",{title:"advanced.fontdefault",cmd:"FontName"});if(j){e(h.getParam("theme_advanced_fonts",i.settings.theme_advanced_fonts,"hash"),function(m,l){j.add(h.translate(l),m.toLowerCase(),{style:m.indexOf("dings")==-1?"font-family:"+m:""})})}return j},_createFontSizeSelect:function(){var i=this,h=i.editor;var j=h.controlManager.createListBox("fontsizeselect",{title:"advanced.font_size",cmd:"FontSize"});return j},_createBlockFormats:function(){var j,h={p:"advanced.paragraph",address:"advanced.address",pre:"advanced.pre",h1:"advanced.h1",h2:"advanced.h2",h3:"advanced.h3",h4:"advanced.h4",h5:"advanced.h5",h6:"advanced.h6",div:"advanced.div",blockquote:"advanced.blockquote",code:"advanced.code",dt:"advanced.dt",dd:"advanced.dd",samp:"advanced.samp"},i=this;j=i.editor.controlManager.createListBox("formatselect",{title:"advanced.block",cmd:"FormatBlock"});if(j){e(i.editor.getParam("theme_advanced_blockformats",i.settings.theme_advanced_blockformats,"hash"),function(m,l){j.add(i.editor.translate(l!=m?l:h[m]),m,{"class":"mce_formatPreview mce_"+m})})}return j},_createForeColorMenu:function(){var l,i=this,j=i.settings,k={},h;if(j.theme_advanced_more_colors){k.more_colors_func=function(){i._mceColorPicker(0,{color:l.value,func:function(m){l.setColor(m)}})}}if(h=j.theme_advanced_text_colors){k.colors=h}k.title="advanced.forecolor_desc";k.cmd="ForeColor";k.scope=this;l=i.editor.controlManager.createColorSplitButton("forecolor",k);l.oldSetColor=l.setColor;l.setColor=function(m){i.ignoreRefreshCommand=true;this.oldSetColor(m);i.ignoreRefreshCommand=false};return l},_createBackColorMenu:function(){var l,i=this,j=i.settings,k={},h;if(j.theme_advanced_more_colors){k.more_colors_func=function(){i._mceColorPicker(0,{color:l.value,func:function(m){l.setColor(m)}})}}if(h=j.theme_advanced_background_colors){k.colors=h}k.title="advanced.backcolor_desc";k.cmd="HiliteColor";k.scope=this;l=i.editor.controlManager.createColorSplitButton("backcolor",k);l.oldSetColor=l.setColor;l.setColor=function(m){i.ignoreRefreshCommand=true;this.oldSetColor(m);i.ignoreRefreshCommand=false};return l},renderUI:function(j){var l,k,m,u=this,q=u.editor,v=u.settings,r,i,h;l=i=d.create("span",{id:q.id+"_parent","class":"mceEditor "+q.settings.skin+"Skin"+(v.skin_variant?" "+q.settings.skin+"Skin"+u._ufirst(v.skin_variant):"")});if(!d.boxModel){l=d.add(l,"div",{"class":"mceOldBoxModel"})}l=r=d.add(l,"table",{id:q.id+"_tbl","class":"mceLayout",cellSpacing:0,cellPadding:0});l=m=d.add(l,"tbody");switch((v.theme_advanced_layout_manager||"").toLowerCase()){case"rowlayout":k=u._rowLayout(v,m,j);break;case"customlayout":k=q.execCallback("theme_advanced_custom_layout",v,m,j,i);break;default:k=u._simpleLayout(v,m,j,i)}l=j.targetNode;h=d.stdMode?r.getElementsByTagName("tr"):r.rows;d.addClass(h[0],"mceFirst");d.addClass(h[1],"mceIframeRow");d.addClass(h[h.length-1],"mceLast");e(d.select("tr",m),function(o){d.addClass(o.firstChild,"mceFirst");d.addClass(o.childNodes[o.childNodes.length-1],"mceLast")});if(d.get(v.theme_advanced_toolbar_container)){d.get(v.theme_advanced_toolbar_container).appendChild(i)}else{d.insertAfter(i,l)}b.add(q.id+"_path_row","click",function(n){n=n.target;if(n.nodeName=="A"){u._sel(n.className.replace(/^.*mcePath_([0-9]+).*$/,"$1"));return b.cancel(n)}});if(!q.getParam("accessibility_focus")||q.getParam("tab_focus")){b.add(d.add(i,"a",{href:"#"},"<!-- IE -->"),"focus",function(){tinyMCE.get(q.id).focus()})}if(v.theme_advanced_toolbar_location=="external"){j.deltaHeight=0}u.deltaHeight=j.deltaHeight;j.targetNode=null;return{iframeContainer:k,editorContainer:q.id+"_parent",sizeContainer:r,deltaHeight:j.deltaHeight}},getInfo:function(){return{longname:"Advanced theme",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}},resizeBy:function(h,i){var j=d.get(this.editor.id+"_tbl");this.resizeTo(j.clientWidth+h,j.clientHeight+i)},resizeTo:function(i,l){var j=this.editor,k=j.settings,n=d.get(j.id+"_tbl"),o=d.get(j.id+"_ifr"),m;i=Math.max(k.theme_advanced_resizing_min_width||100,i);l=Math.max(k.theme_advanced_resizing_min_height||100,l);i=Math.min(k.theme_advanced_resizing_max_width||65535,i);l=Math.min(k.theme_advanced_resizing_max_height||65535,l);m=n.clientHeight-o.clientHeight;d.setStyle(o,"height",l-m);d.setStyles(n,{width:i,height:l})},destroy:function(){var h=this.editor.id;b.clear(h+"_resize");b.clear(h+"_path_row");b.clear(h+"_external_close")},_simpleLayout:function(x,q,j,h){var w=this,r=w.editor,u=x.theme_advanced_toolbar_location,l=x.theme_advanced_statusbar_location,k,i,m,v;if(u=="top"){w._addToolbars(q,j)}if(u=="external"){k=v=d.create("div",{style:"position:relative"});k=d.add(k,"div",{id:r.id+"_external","class":"mceExternalToolbar"});d.add(k,"a",{id:r.id+"_external_close",href:"javascript:;","class":"mceExternalClose"});k=d.add(k,"table",{id:r.id+"_tblext",cellSpacing:0,cellPadding:0});m=d.add(k,"tbody");if(h.firstChild.className=="mceOldBoxModel"){h.firstChild.appendChild(v)}else{h.insertBefore(v,h.firstChild)}w._addToolbars(m,j);r.onMouseUp.add(function(){var o=d.get(r.id+"_external");d.show(o);d.hide(f);var n=b.add(r.id+"_external_close","click",function(){d.hide(r.id+"_external");b.remove(r.id+"_external_close","click",n)});d.show(o);d.setStyle(o,"top",0-d.getRect(r.id+"_tblext").h-1);d.hide(o);d.show(o);o.style.filter="";f=r.id+"_external";o=null})}if(l=="top"){w._addStatusBar(q,j)}if(!x.theme_advanced_toolbar_container){k=d.add(q,"tr");k=i=d.add(k,"td",{"class":"mceIframeContainer"})}if(u=="bottom"){w._addToolbars(q,j)}if(l=="bottom"){w._addStatusBar(q,j)}return i},_rowLayout:function(v,l,j){var u=this,m=u.editor,r,w,h=m.controlManager,k,i,q,p;r=v.theme_advanced_containers_default_class||"";w=v.theme_advanced_containers_default_align||"center";e(c(v.theme_advanced_containers||""),function(s,o){var n=v["theme_advanced_container_"+s]||"";switch(s.toLowerCase()){case"mceeditor":k=d.add(l,"tr");k=i=d.add(k,"td",{"class":"mceIframeContainer"});break;case"mceelementpath":u._addStatusBar(l,j);break;default:p=v["theme_advanced_container_"+s+"_align"].toLowerCase();p="mce"+u._ufirst(p);k=d.add(d.add(l,"tr"),"td",{"class":"mceToolbar "+(v["theme_advanced_container_"+s+"_class"]||r)+" "+p||w});q=h.createToolbar("toolbar"+o);u._addControls(n,q);d.setHTML(k,q.renderHTML());j.deltaHeight-=v.theme_advanced_row_height}});return i},_addControls:function(i,h){var j=this,k=j.settings,l,m=j.editor.controlManager;if(k.theme_advanced_disable&&!j._disabled){l={};e(c(k.theme_advanced_disable),function(n){l[n]=1});j._disabled=l}else{l=j._disabled}e(c(i),function(p){var o;if(l&&l[p]){return}if(p=="tablecontrols"){e(["table","delete_table","|","row_props","cell_props","|","row_before","row_after","delete_row","|","col_before","col_after","delete_col","|","row_up","row_down","col_left","col_right","|","split_cells","merge_cells"],function(q){q=j.createControl(q,m);if(q){h.add(q)}});return}o=j.createControl(p,m);if(o){h.add(o)}})},_addToolbars:function(w,k){var z=this,p,m,r=z.editor,A=z.settings,y,j=r.controlManager,u,l,q=[],x;x=A.theme_advanced_toolbar_align.toLowerCase();x="mce"+z._ufirst(x);l=d.add(d.add(w,"tr"),"td",{"class":"mceToolbar "+x});if(!r.getParam("accessibility_focus")||r.getParam("tab_focus")){q.push(d.createHTML("a",{href:"#",onfocus:"tinyMCE.get('"+r.id+"').focus();"},"<!-- IE -->"))}q.push(d.createHTML("a",{href:"#",accesskey:"q",title:r.getLang("advanced.toolbar_focus")},"<!-- IE -->"));for(p=1;(y=A["theme_advanced_buttons"+p]);p++){m=j.createToolbar("toolbar"+p,{"class":"mceToolbarRow"+p});if(A["theme_advanced_buttons"+p+"_add"]){y+=","+A["theme_advanced_buttons"+p+"_add"]}if(A["theme_advanced_buttons"+p+"_add_before"]){y=A["theme_advanced_buttons"+p+"_add_before"]+","+y}z._addControls(y,m);q.push(m.renderHTML());k.deltaHeight-=A.theme_advanced_row_height}q.push(d.createHTML("a",{href:"#",accesskey:"z",title:r.getLang("advanced.toolbar_focus"),onfocus:"tinyMCE.getInstanceById('"+r.id+"').focus();"},"<!-- IE -->"));l.innerHTML=q.join("")},_addStatusBar:function(l,i){var j,u=this,m=u.editor,v=u.settings,h,p,q,k;j=d.add(l,"tr");j=k=d.add(j,"td",{"class":"mceStatusbar"});j=d.add(j,"div",{id:m.id+"_path_row"});d.add(j,"a",{href:"#",accesskey:"x"});if(v.theme_advanced_resizing&&!tinymce.isOldWebKit){d.add(k,"a",{id:m.id+"_resize",href:"javascript:;",onclick:"return false;","class":"mceResize"});if(v.theme_advanced_resizing_use_cookie){m.onPostRender.add(function(){var n=a.getHash("TinyMCE_"+m.id+"_size"),r=d.get(m.id+"_tbl");if(!n){return}if(v.theme_advanced_resize_horizontal){r.style.width=Math.max(10,n.cw)+"px"}r.style.height=Math.max(10,n.ch)+"px";d.get(m.id+"_ifr").style.height=Math.max(10,parseInt(n.ch)+u.deltaHeight)+"px"})}m.onPostRender.add(function(){b.add(m.id+"_resize","mousedown",function(x){var z,t,o,s,y,r;z=d.get(m.id+"_tbl");o=z.clientWidth;s=z.clientHeight;miw=v.theme_advanced_resizing_min_width||100;mih=v.theme_advanced_resizing_min_height||100;maw=v.theme_advanced_resizing_max_width||65535;mah=v.theme_advanced_resizing_max_height||65535;t=d.add(d.get(m.id+"_parent"),"div",{"class":"mcePlaceHolder"});d.setStyles(t,{width:o,height:s});d.hide(z);d.show(t);h={x:x.screenX,y:x.screenY,w:o,h:s,dx:null,dy:null};p=b.add(d.doc,"mousemove",function(B){var n,A;h.dx=B.screenX-h.x;h.dy=B.screenY-h.y;n=Math.max(miw,h.w+h.dx);A=Math.max(mih,h.h+h.dy);n=Math.min(maw,n);A=Math.min(mah,A);if(v.theme_advanced_resize_horizontal){t.style.width=n+"px"}t.style.height=A+"px";return b.cancel(B)});q=b.add(d.doc,"mouseup",function(n){var w;b.remove(d.doc,"mousemove",p);b.remove(d.doc,"mouseup",q);z.style.display="";d.remove(t);if(h.dx===null){return}w=d.get(m.id+"_ifr");if(v.theme_advanced_resize_horizontal){z.style.width=Math.max(10,h.w+h.dx)+"px"}z.style.height=Math.max(10,h.h+h.dy)+"px";w.style.height=Math.max(10,w.clientHeight+h.dy)+"px";if(v.theme_advanced_resizing_use_cookie){a.setHash("TinyMCE_"+m.id+"_size",{cw:h.w+h.dx,ch:h.h+h.dy})}m.theme.onResize.dispatch(m.theme)});return b.cancel(x)})})}i.deltaHeight-=21;j=l=null},_getCurrentNode:function(h){var i=h.selection.getNode();if(i==null||i==h.getDoc()){if(h.getBody().childNodes.length>0){return h.getBody().childNodes[0]}else{return null}}return i},ignoreRefreshCommand:false,_refreshFontColor:function(k){if(!this.ignoreRefreshCommand){var j=tinyMCE.activeEditor;var m=$j('[id="'+j.id+'_forecolor_preview"]');var i;if(m.length>0){if(typeof(k)!="function"){var l=this._getCurrentNode(j);i=jive.ext.x.xGetCS(l,"color")}else{i=k("color")}m.css("background-color",i);var h=j.controlManager;h.get("forecolor").value=i}}},_refreshFont:function(l){var k=tinyMCE.activeEditor;var h=k.controlManager;var n=h.get("fontselect");var j;if(n){if(typeof(l)!="function"){var m=this._getCurrentNode(k);j=jive.ext.x.xGetCS(m,"font-family")}else{j=l("font-family")}if(j.indexOf(",")>=0){n.select(j.toLowerCase())}else{var i=false;e(k.getParam("theme_advanced_fonts",this.settings.theme_advanced_fonts,"hash"),function(q,p){if(!i){var o=q.split(",");if($j.inArray(j,o)==0){i=true;n.select(q.toLowerCase())}}});if(i){return}e(k.getParam("theme_advanced_fonts",this.settings.theme_advanced_fonts,"hash"),function(q,p){if(!i){var o=q.split(",");if($j.inArray(j,o)>=0){i=true;n.select(q.toLowerCase())}}})}}},_refreshFontSize:function(j){var i=tinyMCE.activeEditor;var h=i.controlManager;var n=h.get("fontsizeselect");var l;if(n){if(typeof(j)!="function"){var m=this._getCurrentNode(i);l=jive.ext.x.xGetCS(m,"font-size")}else{l=j("font-size")}var k=tinyMCE.inArray(n.computed,l);n.select(k+1)}},_keyDown:function(i,h){if(h.keyCode==13){}},_nodeChanged:function(k,r,i,o){var w=this,h,q=0,u,m,x=w.settings;tinymce.each(w.stateControls,function(n){r.setActive(n,k.queryCommandState(w.controls[n][1]))});r.setActive("visualaid",k.hasVisual);r.setDisabled("undo",!k.undoManager.hasUndo()&&!k.typing);r.setDisabled("redo",!k.undoManager.hasRedo());r.setDisabled("outdent",!k.queryCommandState("Outdent"));h=d.getParent(i,"A");if(m=r.get("link")){if(!h||!h.name){m.setDisabled(!h&&o);m.setActive(!!h)}}if(m=r.get("unlink")){m.setDisabled(!h&&o);m.setActive(!!h&&!h.name)}if(m=r.get("anchor")){m.setActive(!!h&&h.name);if(tinymce.isWebKit){h=d.getParent(i,"IMG");m.setActive(!!h&&d.getAttrib(h,"_mce_name")=="a")}}h=d.getParent(i,"IMG");if(m=r.get("image")){m.setActive(!!h&&i.className.indexOf("mceItem")==-1)}if(m=r.get("styleselect")){if(i.className){w._importClasses();m.select(i.className)}else{m.select()}}if(m=r.get("formatselect")){h=d.getParent(i,d.isBlock);if(h){m.select(h.nodeName.toLowerCase())}}var j=this._getCurrentNode(k);var l=jive.ext.x.xGetCSFunc(j);if(m=r.get("fontselect")){m.select(k.queryCommandValue("FontName"));this._refreshFont(l)}if(m=r.get("forecolor")){this._refreshFontColor(l)}if(m=r.get("fontsizeselect")){this._refreshFontSize(l)}if(x.theme_advanced_path&&x.theme_advanced_statusbar_location){h=d.get(k.id+"_path")||d.add(k.id+"_path_row","span",{id:k.id+"_path"});d.setHTML(h,"");k.dom.getParent(i,function(y){var p=y.nodeName.toLowerCase(),s,v,t="";if(y.nodeType!=1||(d.hasClass(y,"mceItemHidden")||d.hasClass(y,"mceItemRemoved"))){return}if(u=d.getAttrib(y,"_mce_name")){p=u}if(tinymce.isIE&&y.scopeName!=="HTML"){p=y.scopeName+":"+p}p=p.replace(/mce\:/g,"");switch(p){case"b":p="strong";break;case"i":p="em";break;case"img":if(u=d.getAttrib(y,"src")){t+="src: "+u+" "}break;case"a":if(u=d.getAttrib(y,"name")){t+="name: "+u+" ";p+="#"+u}if(u=d.getAttrib(y,"href")){t+="href: "+u+" "}break;case"font":if(x.convert_fonts_to_spans){p="span"}if(u=d.getAttrib(y,"face")){t+="font: "+u+" "}if(u=d.getAttrib(y,"size")){t+="size: "+u+" "}if(u=d.getAttrib(y,"color")){t+="color: "+u+" "}break;case"span":if(u=d.getAttrib(y,"style")){t+="style: "+u+" "}break}if(u=d.getAttrib(y,"id")){t+="id: "+u+" "}if(u=y.className){u=u.replace(/(webkit-[\w\-]+|Apple-[\w\-]+|mceItem\w+|mceVisualAid)/g,"");if(u&&u.indexOf("mceItem")==-1){t+="class: "+u+" ";if(d.isBlock(y)||p=="img"||p=="span"){p+="."+u}}}p=p.replace(/(html:)/g,"");p={name:p,node:y,title:t};w.onResolveName.dispatch(w,p);t=p.title;p=p.name;v=d.create("a",{href:"javascript:;",onmousedown:"return false;",title:t,"class":"mcePath_"+(q++)},p);if(h.hasChildNodes()){h.insertBefore(d.doc.createTextNode(" \u00bb "),h.firstChild);h.insertBefore(v,h.firstChild)}else{h.appendChild(v)}},k.getBody())}this.prepForReturn=false},_sel:function(h){this.editor.execCommand("mceSelectNodeDepth",false,h)},_mceInsertAnchor:function(j,i){var h=this.editor;h.windowManager.open({url:tinymce.baseURL+"/themes/advanced/anchor.htm",width:320+parseInt(h.getLang("advanced.anchor_delta_width",0)),height:90+parseInt(h.getLang("advanced.anchor_delta_height",0)),inline:true},{theme_url:this.url})},_mceCharMap:function(){var h=this.editor;h.windowManager.open({url:tinymce.baseURL+"/themes/advanced/charmap.htm",width:550+parseInt(h.getLang("advanced.charmap_delta_width",0)),height:250+parseInt(h.getLang("advanced.charmap_delta_height",0)),inline:true},{theme_url:this.url})},_mceHelp:function(){var h=this.editor;h.windowManager.open({url:tinymce.baseURL+"/themes/advanced/about.htm",width:480,height:380,inline:true},{theme_url:this.url})},_mceColorPicker:function(j,i){var h=this.editor;i=i||{};h.windowManager.open({url:tinymce.baseURL+"/themes/advanced/color_picker.htm",width:385+parseInt(h.getLang("advanced.colorpicker_delta_width",0)),height:260+parseInt(h.getLang("advanced.colorpicker_delta_height",0)),close_previous:false,inline:true},{input_color:i.color,func:i.func,theme_url:this.url,cs_resource_base_url:CS_RESOURCE_BASE_URL})},_mceCodeEditor:function(i,j){var h=this.editor;h.windowManager.open({url:tinymce.baseURL+"/themes/advanced/source_editor.htm",width:parseInt(h.getParam("theme_advanced_source_editor_width",720)),height:parseInt(h.getParam("theme_advanced_source_editor_height",580)),inline:true,resizable:true,maximizable:true},{theme_url:this.url})},_mceImage:function(i,j){var h=this.editor;if(h.dom.getAttrib(h.selection.getNode(),"class").indexOf("mceItem")!=-1){return}h.windowManager.open({url:tinymce.baseURL+"/themes/advanced/image.htm",width:355+parseInt(h.getLang("advanced.image_delta_width",0)),height:275+parseInt(h.getLang("advanced.image_delta_height",0)),inline:true},{theme_url:this.url})},_mceLink:function(i,j){var h=this.editor;h.windowManager.open({url:tinymce.baseURL+"/themes/advanced/link.htm",width:310+parseInt(h.getLang("advanced.link_delta_width",0)),height:200+parseInt(h.getLang("advanced.link_delta_height",0)),inline:true},{theme_url:this.url})},_mceNewDocument:function(){var h=this.editor;h.windowManager.confirm("advanced.newdocument",function(i){if(i){h.execCommand("mceSetContent",false,"")}})},_mceForeColor:function(){var h=this;this._mceColorPicker(0,{color:h.fgColor,func:function(i){h.fgColor=i;h.editor.execCommand("ForeColor",false,i)}})},_mceBackColor:function(){var h=this;this._mceColorPicker(0,{color:h.bgColor,func:function(i){h.bgColor=i;h.editor.execCommand("HiliteColor",false,i)}})},_ufirst:function(h){return h.substring(0,1).toUpperCase()+h.substring(1)}});tinymce.ThemeManager.add("advanced",tinymce.themes.AdvancedTheme)}());
;
tinyMCE.addI18n("en.advanced",{style_select:"Styles",font_size:"Font size",fontdefault:"Font family",block:"Format",paragraph:"Paragraph",div:"Div",address:"Address",pre:"Preformatted",h1:"Heading 1",h2:"Heading 2",h3:"Heading 3",h4:"Heading 4",h5:"Heading 5",h6:"Heading 6",blockquote:"Blockquote",code:"Code",samp:"Code sample",dt:"Definition term ",dd:"Definition description",bold_desc:"Bold (Ctrl+B)",italic_desc:"Italic (Ctrl+I)",underline_desc:"Underline (Ctrl+U)",striketrough_desc:"Strikethrough",justifyleft_desc:"Align left",justifycenter_desc:"Align center",justifyright_desc:"Align right",justifyfull_desc:"Align full",bullist_desc:"Unordered list",numlist_desc:"Ordered list",outdent_desc:"Outdent",indent_desc:"Indent",undo_desc:"Undo (Ctrl+Z)",redo_desc:"Redo (Ctrl+Y)",link_desc:"Insert/edit link",unlink_desc:"Unlink",image_desc:"Insert/edit image",cleanup_desc:"Cleanup messy code",code_desc:"Edit HTML Source",sub_desc:"Subscript",sup_desc:"Superscript",hr_desc:"Insert horizontal ruler",removeformat_desc:"Remove formatting",custom1_desc:"Your custom description here",forecolor_desc:"Select text color",backcolor_desc:"Select background color",charmap_desc:"Insert custom character",visualaid_desc:"Toggle guidelines/invisible elements",anchor_desc:"Insert/edit anchor",cut_desc:"Cut",copy_desc:"Copy",paste_desc:"Paste",image_props_desc:"Image properties",newdocument_desc:"New document",help_desc:"Help",blockquote_desc:"Blockquote",clipboard_msg:"Copy/Cut/Paste is not available in Mozilla and Firefox.\r\nDo you want more information about this issue?",path:"Path",newdocument:"Are you sure you want clear all contents?",toolbar_focus:"Jump to tool buttons - Alt+Q, Jump to editor - Alt-Z, Jump to element path - Alt-X",more_colors:"More colors"});
;
tinyMCE.addI18n('en.advanced',{
    font_size:"Size",
    insert_image_desc:"Insert image",
    edit_image_desc:"Edit image"
});
;
tinyMCE.addI18n("en.advanced_dlg",{about_title:"About TinyMCE",about_general:"About",about_help:"Help",about_license:"License",about_plugins:"Plugins",about_plugin:"Plugin",about_author:"Author",about_version:"Version",about_loaded:"Loaded plugins",anchor_title:"Insert/edit anchor",anchor_name:"Anchor name",code_title:"HTML Source Editor",code_wordwrap:"Word wrap",colorpicker_title:"Select a color",colorpicker_picker_tab:"Picker",colorpicker_picker_title:"Color picker",colorpicker_palette_tab:"Palette",colorpicker_palette_title:"Palette colors",colorpicker_named_tab:"Named",colorpicker_named_title:"Named colors",colorpicker_color:"Color:",colorpicker_name:"Name:",charmap_title:"Select custom character",image_title:"Insert/edit image",image_src:"Image URL",image_alt:"Image description",image_list:"Image list",image_border:"Border",image_dimensions:"Dimensions",image_vspace:"Vertical space",image_hspace:"Horizontal space",image_align:"Alignment",image_align_baseline:"Baseline",image_align_top:"Top",image_align_middle:"Middle",image_align_bottom:"Bottom",image_align_texttop:"Text top",image_align_textbottom:"Text bottom",image_align_left:"Left",image_align_right:"Right",link_title:"Insert/edit link",link_url:"Link URL",link_target:"Target",link_target_same:"Open link in the same window",link_target_blank:"Open link in a new window",link_titlefield:"Title",link_is_email:"The URL you entered seems to be an email address, do you want to add the required mailto: prefix?",link_is_external:"The URL you entered seems to external link, do you want to add the required http:// prefix?",link_list:"Link list"});
;
jive.namespace("Gadgets");jive.Gadgets.GadgetSource=$Class.extend({init:function(a){a=a||{};this.id=a.id;this.GADGET_ENDPOINT=jive.rest.url("/gadget");this.options=function(e,c,d,b){if(d){c=c+"?"+$j.param(d)}return{type:e,url:this.GADGET_ENDPOINT+c,dataType:"json",contentType:"application/json; charset=utf-8",success:b}}},getGadgets:function(a){$j.ajax(this.options("GET","/",null,function(b){a(b.category)}))},setPref:function(a,b,d){var c={n:a,v:b};$j.ajax(this.options("PUT","/setpref/"+this.id,c,function(e){if(d&&e.gadget){d(e.gadget)}}))},getPreferences:function(a){$j.ajax(this.options("GET","/prefs/"+this.id,null,function(b){a(b.pref)}))},setPreferences:function(a,b){a.ajaxSubmit({url:this.GADGET_ENDPOINT+"/setprefs/",type:"POST",dataType:"json",success:function(c){b(c.gadget)}})},cancelEdit:function(a){$j.ajax(this.options("GET","/"+this.id,null,function(b){a(b.gadget)}))}});
;
(function(){var c="mceJiveGadget";var e;var b=e="jiveGadget";var f=new jive.Gadgets.GadgetSource();var a;var d=function(l,m){if(!a){m.add({title:"Loading gadgets..."});f.getGadgets(function(g){a=g;m.removeAll();d(l,m);m.hideMenu();l.showMenu()})}else{for(var n=0;n<a.length;n++){var j=a[n];if(a.length==1){h=m}else{var h=m.addMenu({title:j.name,"class":"mceDropDown defaultSkin mceMacroMenu mceListBoxMenu"})}for(var i=0;i<j.gadgets.length;i++){var k=j.gadgets[i];h.add({title:k.name,cmd:"openASubMenuCommand"})}}}};tinymce.create("tinymce.plugins.JiveGadgetPlugin",{init:function(h,g){},createControl:function(i,g){if(b!=i){return null}var h=g.createSplitButton(b,{title:"jiveGadget.desc",cmd:c});h.onRenderMenu.add(d);return h},execCommand:function(i){if(i!=c){return false}var g=tinyMCE.activeEditor.controlManager;var h=g.get(b);h.showMenu();return true},getInfo:function(){return{longname:"Jive OpenSocial Gadgets",author:"Jive Software",authorurl:"http://jivesoftware.com",infourl:"http://jivesoftware.com",version:tinyMCE.majorVersion+"."+tinyMCE.minorVersion}}});tinymce.PluginManager.add(e,tinymce.plugins.JiveGadgetPlugin)})();
;
tinyMCE.addI18n('en.jiveGadget',{
    title : 'Gadgets',
    desc : 'Add an OpenSocial Gadget'
});
;
function addEvent(c,a,b){if(c.attachEvent){c.attachEvent("on"+a,b)}else{c.addEventListener(a,b,true)}}function setCookie(c,e,a,g,d,f){var b=c+"="+encodeURIComponent(e)+((a)?"; expires="+a.toGMTString():"")+((g)?"; path="+encodeURIComponent(g):"")+((d)?"; domain="+d:"")+((f)?"; secure":"");document.cookie=b}function getCookie(c){var b=document.cookie;var e=c+"=";var d=b.indexOf("; "+e);if(d==-1){d=b.indexOf(e);if(d!==0){return null}}else{d+=2}var a=document.cookie.indexOf(";",d);if(a==-1){a=b.length}return decodeURIComponent(b.substring(d+e.length,a))}function addImageElement(a,c,b){if($j("#"+c).length>0){return}createImageElement(a,c,b);if(typeof(autoSave)!="undefined"){autoSave.addImage(c)}}function createImageElement(a,d,c){var b=document.createElement("INPUT");b.setAttribute("type","hidden");b.setAttribute("name",a);b.setAttribute("id",d);b.setAttribute("value",c);$j("#postform").append(b)}function removeImageElement(a){$j("#"+a).remove();if(typeof(autoSave)!="undefined"){autoSave.deleteImage(a)}};
;
JiveAutoSave=$Class.extend({init:function(h,c,g,a,b,f,j,k,i,l,d,e){this.enabled=h;this.interval=c;this.needSave=false;this.continuing=false;this.draftType=g;this.objectType=a;this.objectID=b;this.subject=j;this.body=f;this.images=k;this.properties=i;this.confirmation=false;this.confirmationMessage=l;this.saveMessage=d;this.savedMessage=e;this.spellcheck=false;if(h){this.autoSaveInit(c)}window.onbeforeunload=this.navigateAway.bind(this);$j(window).unload(this.doDiscard.bind(this));this.listeners=[]},addListener:function(a){this.listeners.push(a)},autoSaveInit:function(a){if(this._intervalId==null){this._intervalId=setInterval(this.saveDraft.bind(this),a*1000)}},stop:function(){if(this._intervalId!=null){clearInterval(this._intervalId);this._intervalId=null}this.confirmation=false},start:function(){this.enabled=true;this.autoSaveInit(this.interval)},saveDraft:function(b){this.spellcheck=window.editor.get(this.body).isSpellChecking();if(this.spellcheck){return}if(this.needSave){var a={};a.ID=$j("#draftid").val();a.draftObjectType=this.draftType;a.draftContainerObjectType=this.objectType;a.draftContainerObjectID=this.objectID;a.subject=$j("#"+this.subject).val();if(this.draftType!=18){a.body=window.editor.get(this.body).getHTML()}else{a.body=$j("#"+this.body).val()}a.properties={};this.properties.map(function(c){var d=$j("#"+c);if(d.length>0){if(d.is(":checkbox, :radio")&&d.is(":checked")){a.properties[c]="checked"}else{if(d.is("select")){a.properties[c]=d.val()}else{if(d.is(":text")||d.is("input[type=hidden]")){if(d.val().length>0){a.properties[c]=d.val()}}}}}else{var e=window["get"+c];if(typeof e=="function"){a.properties[c]=e()}}});a.imageIDs=[];if(this.images){this.images.map(function(c){var d=$j("#"+c);if(d.attr("type")=="text"||d.attr("type")=="hidden"){if(d.val().length>0){a.imageIDs.push(d.val())}}})}Draft.saveDraft(a,this.postSave.bind(this))}else{Draft.keepAlive()}},postSave:function(a){this.needSave=false;$j("#draftid").val(a.ID);if(this.spellcheck){window.editor.get(this.body).toggleSpellChecker()}},messageChangeHandler:function(){this.needSave=true;this.confirmation=true},useDraft:function(b){this.enabled=true;this.autoSaveInit(this.interval);var a=this;if(typeof b=="string"){b=window[b]}if(typeof b!="function"){Draft.getDraft(this.draftType,this.objectType,this.objectID,{errorHandler:function(c){},callback:this.displayDraft.bind(this)})}else{Draft.getDraft(this.draftType,this.objectType,this.objectID,{errorHandler:function(c){},callback:function(c){a.displayDraft(c);b(c)}})}},displayDraft:function(b){if(!b){$j("#autosave-prompt").fadeOut();return}var a=b.properties;if(b.draftObjectType==18){for(var d in a){if(d.indexOf("jive-option-table-option-")>-1&&d!="jive-option-table-option-1"&&d!="jive-option-table-option-2"){addOption("jive-option-table","jive-option-table-row")}}}if(b.draftObjectType==18){$j("#"+this.body).val(b.body)}else{window.editor.get(this.body).setHTML(b.body)}$j("#"+this.subject).val(b.subject);this.properties.map(function(e){var f=$j("#"+e);if(f.length>0){if(f.is(":checkbox, :radio")){if(a[e]=="checked"){f.attr("checked",true)}}else{if(f.is("select")){if(a[e]!==undefined&&a[e]!==""){f.find("option").map(function(h,g){if($j(g).val()==a[e]){$j(g).attr("selected",true)}})}}else{if(f.is(":text")){if(a[e]!==undefined&&a[e]!==""){f.val(a[e])}else{f.val("")}}}}}else{f=window["set"+e];if(typeof f=="function"){f(a[e])}}});var c=b.imageIDs;if(c!=undefined&&c!=""&&c.length>0){if(!$j.isArray(c)){c=[c]}$j.each(c,function(f,e){var h="imageFile"+e,i=e,g=$j("#"+h);if(!this.images){this.images=[]}if($j.inArray(this.images,""+h)<0){this.images.push(h)}if(g.length<1){createImageElement("imageFile",h,i)}else{if(g.is(":text, input[type=hidden]")){if(c.indexOf(g.val())>-1){g.val(i)}else{g.val("")}}}})}$j("#autosave-prompt").fadeOut()},deleteDraft:function(){Draft.deleteDraft(this.draftType,this.objectType,this.objectID,false);this.enabled=true;this.autoSaveInit(this.interval);$j("#autosave-prompt").fadeOut()},navigateAway:function(a){if(this.confirmation){return this.confirmationMessage+"\n"}this.listeners.map(function(b){b.navigateAway(a)})},confirmDiscard:function(a){if(confirm(a)){cancelPost=true;window.onbeforeunload=null;return true}else{return false}},doDiscard:function(){cancelPost=true;Draft.deleteDraft(this.draftType,this.objectType,this.objectID,!this.continuing);this.continuing=false;window.onbeforeunload=null;$j(window).unbind("unload");return true},getProperties:function(){return this.properties},addProperty:function(a){this.properties.push(a);this.messageChangeHandler()},deleteProperty:function(a){this.properties=this.properties.filter(function(b){return b!=a});this.messageChangeHandler()},getImages:function(){return this.images},addImage:function(a){this.images.push(a);this.messageChangeHandler()},deleteImage:function(a){this.images=this.images.filter(function(b){return b!=a});this.messageChangeHandler()}});DummyAutoSave=$Class.extend({init:function(b,a){if(a!=null){this.interval=a}else{this.interval=90}if(b){this.autoSaveInit(this.interval)}},autoSaveInit:function(a){if(this._intervalId==null){this._intervalId=setInterval(this.saveDraft.bind(this),a*1000)}},stop:function(){if(this._intervalId!=null){clearInterval(this._intervalId);this._intervalId=null}},start:function(){this.enabled=true;this.autoSaveInit(this.interval)},addListener:function(){},saveDraft:function(a){if(Draft&&Draft.keepAlive){Draft.keepAlive()}},postSave:function(a){},messageChangeHandler:function(){},useDraft:function(a){},displayDraft:function(a){},deleteDraft:function(){},navigateAway:function(){},confirmDiscard:function(a){return false},getProperties:function(){},addProperty:function(a){},deleteProperty:function(a){},doDiscard:function(){},getImages:function(){},addImage:function(a){},deleteImage:function(a){}});
;
var DWRTimeout=20000;var objectLookupSessionKey;var errorHandlerMessage="An error occurred:";var __postSubmitted=false;var cancelPost=false;function pause(d){if(window.showModalDialog){var c="window.setTimeout( function () { window.close(); }, "+d+");";var a=window.showModalDialog('javascript:document.writeln("<script>'+c+'<\/script>")')}else{var b=new Date();var e=b.getTime()+d;while(true){b=new Date();if(b.getTime()>e){return}}}}function getEditorMode(){return currentMode}function editorErrorHandler(b,a){if(b.indexOf("Timeout")==-1){$j("#dwr-error-text").text(errorHandlerMessage+" Error Code: "+b);$j("#dwr-error-table").fadeIn();setTimeout(function(){$j("#dwr-error-table").fadeOut()},10000)}}function trimString(a){a.replace(/^\s*|\s*$/g,"");return a}function validatePost(e,c,d){if(cancelPost){return true}if(typeof(d)=="undefined"){d="wysiwygtext"}var g=false;var b=window.editor.get(d);var a=document.getElementById("subject01");if(typeof(a)!="undefined"&&trimString(a.value)==""){var h=document.getElementById("post-error-table");if(h){h.style.display="block";scroll(0,0);h=document.getElementById("post-error-subject");if(h){h.style.display="block";scroll(0,0)}}g=true}else{var h=document.getElementById("post-error-subject");if(h){h.style.display="none"}}var f;if(!b.isMobileOnly()){f=b.getHTML();if(b.isTextOnly()){b.getTextArea().style.display="inline";b.innerHTML="";b.appendChild(document.createTextNode(f));b.style.display="none"}}else{f=b.getHTML()}b.getOriginalTextBox().val(f);if(!c&&(f==null||trimString(f)=="")){var h=document.getElementById("post-error-table");if(h){h.style.display="block";scroll(0,0);h=document.getElementById("post-error-body");if(h){h.style.display="block";scroll(0,0)}}g=true}else{var i=document.getElementById("textEditor");if(i){i.value=f}document.getElementById("postTypeFlag").value="true";var h=document.getElementById("post-error-body");if(h){h.style.display="none"}}if(g){return false}var h=document.getElementById("post-error-table");if(h){h.style.display="none"}if(arguments.length>0){window.onbeforeunload=null}if(autoSave&&e){$j(window).unbind("unload",window.autoSave.doDiscard)}if(!__postSubmitted&&e){__postSubmitted=true;return true}else{if(!e){return true}}return false};
;
function jiveConvertWord(a,b){switch(a){case"before":if(tinyMCE.isGecko){b=b.replace(new RegExp("\n\t+","gi")," ")}break;case"after":break}return b}var guieditorplugins="";var guieditorvalidelements="";var guieditorbuttons="";if(typeof(_jive_plain_quote_text)!="undefined"&&_jive_tables_enabled){guieditorplugins="jivequote,jiveemoticons,jivespell,paste,table,jivelink,jiveimage";guieditorvalidelements="+code[class],+a[style|name|href|target|title|class],-strong/-b[class|style],-em/-i[class|style],-strike[class|style],-u[class|style],+p[style|dir|class|align],-ol[class|style],-ul[class|style],-li[class|style],br[clear],img[style|class|src|border|alt=|title|hspace|vspace|width|height|align|id],-sub[style|class],-sup[style|class],-blockquote[style],-div[class|align|style],-span[style|class|align],-pre[class|align|style],address[class|align|style],-h1[style|class|align],-h2[style|class|align],-h3[style|class|align],-h4[style|class|align],-h5[style|class|align],-h6[style|class|align],hr[class|style],-font[face|size|style|class|color],dd[class|title|style|lang],dl[class|title|style|lang],dt[class|title|style|lang],-table[border:1|class:jive-wiki-table],-tr,tbody,thead,tfoot,#td,#th";guieditorbuttons="tablecontrols,separator"}else{if(typeof(_jive_tables_enabled)!="undefined"){guieditorplugins="jiveemoticons,jivespell,paste,table,jivelink,jiveimage";guieditorvalidelements="+code[class],+a[style|name|href|target|title|class],-strong/-b[class|style],-em/-i[class|style],-strike[class|style],-u[class|style],+p[style|dir|class|align],-ol[class|style],-ul[class|style],-li[class|style],br[clear],img[style|class|src|border|alt=|title|hspace|vspace|width|height|align|id],-sub[style|class],-sup[style|class],-blockquote[style],-div[class|align|style],-span[style|class|align],-pre[class|align|style],address[class|align|style],-h1[style|class|align],-h2[style|class|align],-h3[style|class|align],-h4[style|class|align],-h5[style|class|align],-h6[style|class|align],hr[class|style],-font[face|size|style|class|color],dd[class|title|style|lang],dl[class|title|style|lang],dt[class|title|style|lang],-table[border:1|class:jive-wiki-table],-tr,tbody,thead,tfoot,#td,#th";guieditorbuttons="tablecontrols,separator"}else{if(typeof(_jive_plain_quote_text)!="undefined"){guieditorplugins="jivequote,jiveemoticons,jivespell,paste,jivelink,jiveimage";guieditorvalid_elements:"+code[class],+a[style|name|href|target|title|class],-strong/-b[class|style],-em/-i[class|style],-strike[class|style],-u[class|style],+p[style|dir|class|align],-ol[class|style],-ul[class|style],-li[class|style],br[clear],img[style|class|src|border|alt=|title|hspace|vspace|width|height|align|id],-sub[style|class],-sup[style|class],-blockquote[style],-div[class|align|style],-span[style|class|align],-pre[class|align|style],address[class|align|style],-h1[style|class|align],-h2[style|class|align],-h3[style|class|align],-h4[style|class|align],-h5[style|class|align],-h6[style|class|align],hr[class|style],-font[face|size|style|class|color],dd[class|title|style|lang],dl[class|title|style|lang],dt[class|title|style|lang]"}}};
;
